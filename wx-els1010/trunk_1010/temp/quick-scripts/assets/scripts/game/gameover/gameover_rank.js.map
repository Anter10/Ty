{"version":3,"sources":["gameover_rank.js"],"names":["friend_path","self","gameover_rank","cc","Class","extends","Component","properties","phbSprite","Sprite","onLoad","tex","Texture2D","window","sharedCanvas","width","height","updatetime","score","tywx","tt","Utils","sendWXMsg","method","Timer","setTimer","wx","postMessage","updateFriendCanvas","openDataContext","getOpenDataContext","canvas","initWithElement","handleLoadedTexture","spriteFrame","SpriteFrame","node","active","setScoreFlush","start","update","dt","statics","gamoverranknode","gameover_rank_script","addIcon","loader","loadRes","err","prefab","instantiate","getComponent","addChild","module","exports"],"mappings":";;;;;;AAAC,IAAIA,cAAc,uBAAlB;AACA,IAAIC,OAAO,IAAX;;AAEA,IAAMC,gBAAgBC,GAAGC,KAAH,CAAS;AAC3BC,aAASF,GAAGG,SADe;;AAG3BC,gBAAY;AACRC,mBAAWL,GAAGM;AADN,KAHe;;AAO3B;;AAEAC,UAT2B,oBASlB;AACL,aAAKC,GAAL,GAAW,IAAIR,GAAGS,SAAP,EAAX;AACAC,eAAOC,YAAP,CAAoBC,KAApB,GAA4B,GAA5B;AACAF,eAAOC,YAAP,CAAoBE,MAApB,GAA6B,GAA7B;AACA,aAAKC,UAAL,GAAkB,CAAlB;AACA,aAAKC,KAAL,GAAa,CAAb;AACAjB,eAAO,IAAP;AACAkB,aAAKC,EAAL,CAAQC,KAAR,CAAcC,SAAd,CAAwB;AACpBC,oBAAQ;AADY,SAAxB;AAGAJ,aAAKC,EAAL,CAAQC,KAAR,CAAcC,SAAd,CAAwB;AACpBC,oBAAQ;AADY,SAAxB;AAGAJ,aAAKK,KAAL,CAAWC,QAAX,CAAoBxB,IAApB,EAA0B,YAAY;AAC9ByB,eAAGC,WAAH,CAAe;AACXJ,wBAAQ;AADG,aAAf;AAGN,SAJF,EAII,CAJJ,EAIO,CAJP,EAIU,CAJV;AAKH,KA3B0B;;;AA6B3B;;;AAGAK,wBAAoB,8BAAY;AAC5B;AACA,YAAI,CAAC,KAAKjB,GAAN,IAAa,CAACe,EAAlB,EAAsB;AAClB;AACH;;AAED,YAAIG,kBAAkBH,GAAGI,kBAAH,EAAtB;AACA,YAAIhB,eAAee,gBAAgBE,MAAnC;AACA,aAAKpB,GAAL,CAASqB,eAAT,CAAyBlB,YAAzB;AACA,aAAKH,GAAL,CAASsB,mBAAT;AACA,aAAKzB,SAAL,CAAe0B,WAAf,GAA6B,IAAI/B,GAAGgC,WAAP,CAAmB,KAAKxB,GAAxB,CAA7B;AACA,aAAKH,SAAL,CAAe4B,IAAf,CAAoBC,MAApB,GAA6B,IAA7B;AACH,KA5C0B;;AA8C3B;;;;AAIAC,mBAAe,uBAAUpB,KAAV,EAAiB;AAC5B,aAAKA,KAAL,GAAaA,SAAS,CAAtB;AACA,aAAKU,kBAAL;AACH,KArD0B;;AAwD3BW,SAxD2B,mBAwDnB,CAEP,CA1D0B;AA4D3BC,UA5D2B,kBA4DpBC,EA5DoB,EA4DhB;AACP,aAAKxB,UAAL,GAAkB,KAAKA,UAAL,GAAkBwB,EAApC;AACA,YAAI,KAAKxB,UAAL,GAAkB,CAAtB,EAAyB;AACrB,iBAAKW,kBAAL;AACH;AACJ,KAjE0B;;;AAmE3Bc,aAAS;AACLC,yBAAiB,IADZ;AAELC,8BAAsB,IAFjB;AAGLC,iBAAS,iBAAUT,IAAV,EAAgB;AACrBjC,eAAG2C,MAAH,CAAUC,OAAV,CAAkB/C,WAAlB,EAA+B,UAACgD,GAAD,EAAMC,MAAN,EAAiB;AAC5C,oBAAI,CAACD,GAAL,EAAU;AACN,wBAAIL,kBAAkBxC,GAAG+C,WAAH,CAAeD,MAAf,CAAtB;AACA,wBAAIL,uBAAuBD,gBAAgBQ,YAAhB,CAA6B,eAA7B,CAA3B;AACAjD,kCAAc0C,oBAAd,GAAqCA,oBAArC;AACA1C,kCAAcyC,eAAd,GAAgCA,eAAhC;AACAP,yBAAKgB,QAAL,CAAcT,eAAd;AACH;AACJ,aARD;AASH;AAbI;AAnEkB,CAAT,CAAtB;;AAoFAU,OAAOC,OAAP,GAAiBpD,aAAjB","file":"gameover_rank.js","sourceRoot":"../../../../../../assets/scripts/game/gameover","sourcesContent":[" let friend_path = \"prefabs/gameover_rank\";\n var self = null;\n\n const gameover_rank = cc.Class({\n     extends: cc.Component,\n\n     properties: {\n         phbSprite: cc.Sprite,\n     },\n\n     // LIFE-CYCLE CALLBACKS:\n\n     onLoad() {\n         this.tex = new cc.Texture2D();\n         window.sharedCanvas.width = 640;\n         window.sharedCanvas.height = 200;\n         this.updatetime = 5;\n         this.score = 0;\n         self = this;\n         tywx.tt.Utils.sendWXMsg({\n             method: 7,\n         });\n         tywx.tt.Utils.sendWXMsg({\n             method: 9,\n         });\n         tywx.Timer.setTimer(self, function () {\n                 wx.postMessage({\n                     method: 8,\n                 });\n          }, 1, 1, 1);\n     },\n\n     /**\n      * @description: 刷新子域即将超越的玩家Canvas\n      */\n     updateFriendCanvas: function () {\n         //return;\n         if (!this.tex || !wx) {\n             return;\n         }\n\n         var openDataContext = wx.getOpenDataContext();\n         var sharedCanvas = openDataContext.canvas;\n         this.tex.initWithElement(sharedCanvas);\n         this.tex.handleLoadedTexture();\n         this.phbSprite.spriteFrame = new cc.SpriteFrame(this.tex);\n         this.phbSprite.node.active = true;\n     },\n\n     /**\n      * 设置当前玩家的分数 \n      * @param {Number} score 设置当前玩家的分数刷新当前显示的好友分数\n      */\n     setScoreFlush: function (score) {\n         this.score = score || 0;\n         this.updateFriendCanvas();\n     },\n\n\n     start() {\n\n     },\n\n     update(dt) {\n         this.updatetime = this.updatetime - dt;\n         if (this.updatetime > 0) {\n             this.updateFriendCanvas();\n         }\n     },\n\n     statics: {\n         gamoverranknode: null,\n         gameover_rank_script: null,\n         addIcon: function (node) {\n             cc.loader.loadRes(friend_path, (err, prefab) => {\n                 if (!err) {\n                     let gamoverranknode = cc.instantiate(prefab);\n                     let gameover_rank_script = gamoverranknode.getComponent('gameover_rank');\n                     gameover_rank.gameover_rank_script = gameover_rank_script;\n                     gameover_rank.gamoverranknode = gamoverranknode;\n                     node.addChild(gamoverranknode);\n                 }\n             });\n         }\n     }\n });\n\n module.exports = gameover_rank;"]}