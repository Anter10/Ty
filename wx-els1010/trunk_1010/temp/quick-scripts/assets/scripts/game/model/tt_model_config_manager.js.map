{"version":3,"sources":["tt_model_config_manager.js"],"names":["TAG","_instance","Symbol","_configUrl","ConfigManager","att","tywx","tt","Configs","default","log","ads","listenCDNData","lottery","listenCDNConfigData","listenADManagerData","self","xhr","cc","loader","getXMLHttpRequest","onreadystatechange","readyState","status","response","JSON","parse","responseText","constants","WXAdConfig","bannerId","WXAd","banner","vedioId","video","isCanWatchVideo","stringify","NotificationCenter","trigger","events","TT_GET_CONFIG_SUCCESS","TT_GET_CONFIG_FAIL","open","send","module","exports"],"mappings":";;;;;;;;;;AAAA,IAAIA,MAAM,0BAAV;AACA,IAAIC,YAAYC,OAAOF,GAAP,CAAhB;AACA,IAAIG,aAAa,qDAAjB;;IAEMC;AACF,6BAAc;AAAA;;AACT,aAAK,IAAIC,GAAT,IAAgBC,KAAKC,EAAL,CAAQC,OAAR,CAAgBC,OAAhC,EAAyC;AACrC,iBAAKJ,GAAL,IAAYC,KAAKC,EAAL,CAAQC,OAAR,CAAgBC,OAAhB,CAAwBJ,GAAxB,CAAZ;AACH;AACL;;;;wCAKe;AACZC,iBAAKC,EAAL,CAAQG,GAAR,CAAYV,GAAZ,EAAiB,eAAjB;AACA;AACAM,iBAAKC,EAAL,CAAQI,GAAR,CAAYC,aAAZ;AACAN,iBAAKC,EAAL,CAAQM,OAAR,CAAgBC,mBAAhB;AACAR,iBAAKC,EAAL,CAAQI,GAAR,CAAYI,mBAAZ;AACA,gBAAIC,OAAO,IAAX;AACA,gBAAIC,MAAMC,GAAGC,MAAH,CAAUC,iBAAV,EAAV;AACA;AACAH,gBAAII,kBAAJ,GAAyB,YAAM;AAC3B,oBAAIJ,IAAIK,UAAJ,KAAmB,CAAnB,IAAyBL,IAAIM,MAAJ,IAAc,GAAd,IAAqBN,IAAIM,MAAJ,GAAa,GAA/D,EAAqE;AACjE,wBAAIC,WAAWC,KAAKC,KAAL,CAAWT,IAAIU,YAAf,CAAf;AACA,yBAAK,IAAItB,GAAT,IAAgBmB,SAASf,OAAzB,EAAkC;AAC9BO,6BAAKX,GAAL,IAAYmB,SAASf,OAAT,CAAiBJ,GAAjB,CAAZ;AACH;AACDC,yBAAKC,EAAL,CAAQqB,SAAR,CAAkBC,UAAlB,CAA6BC,QAA7B,GAAwCd,KAAKe,IAAL,CAAUC,MAAlD;AACA1B,yBAAKC,EAAL,CAAQqB,SAAR,CAAkBC,UAAlB,CAA6BI,OAA7B,GAAuCjB,KAAKe,IAAL,CAAUG,KAAjD;AACA,wBAAI5B,KAAKC,EAAL,CAAQqB,SAAR,CAAkBC,UAAlB,CAA6BI,OAA7B,KAAyC,EAA7C,EAAiD;AAC7C3B,6BAAKC,EAAL,CAAQ4B,eAAR,GAA0B,KAA1B;AACH,qBAFD,MAEO;AACH7B,6BAAKC,EAAL,CAAQ4B,eAAR,GAA0B,IAA1B;AACH;;AAED7B,yBAAKC,EAAL,CAAQG,GAAR,CAAYV,GAAZ,EAAiB,2BAA2ByB,KAAKW,SAAL,CAAeZ,QAAf,CAA5C;AACAlB,yBAAK+B,kBAAL,CAAwBC,OAAxB,CAAgChC,KAAKC,EAAL,CAAQgC,MAAR,CAAeC,qBAA/C,EAAsEhB,QAAtE;AACH,iBAfD,MAeK;AACDlB,yBAAK+B,kBAAL,CAAwBC,OAAxB,CAAgChC,KAAKC,EAAL,CAAQgC,MAAR,CAAeE,kBAA/C,EAAmE,IAAnE;AACH;AACJ,aAnBD;AAoBAxB,gBAAIyB,IAAJ,CAAS,KAAT,EAAgBvC,UAAhB,EAA4B,IAA5B;AACAc,gBAAI0B,IAAJ;AACH;;;sCAnCoB;AACjB,gBAAI,CAACvC,cAAcH,SAAd,CAAL,EAA+BG,cAAcH,SAAd,IAA2B,IAAIG,aAAJ,EAA3B;AAC/B,mBAAOA,cAAcH,SAAd,CAAP;AACH;;;;;;AAkCLG,cAAcH,SAAd,IAA2B,IAA3B;AACA2C,OAAOC,OAAP,GAAiBzC,aAAjB","file":"tt_model_config_manager.js","sourceRoot":"../../../../../../assets/scripts/game/model","sourcesContent":["let TAG = '[tt.model.ConfigManager]';\nlet _instance = Symbol(TAG);\nlet _configUrl = 'https://elsfkws.nalrer.cn/teris/config/els1010.json';\n\nclass ConfigManager {\n    constructor() {\n         for (let att in tywx.tt.Configs.default) {\n             this[att] = tywx.tt.Configs.default[att];\n         }\n    }\n    static getInstance() {\n        if (!ConfigManager[_instance]) ConfigManager[_instance] = new ConfigManager();\n        return ConfigManager[_instance];\n    }\n    requestConfig() {\n        tywx.tt.log(TAG, 'requestConfig');\n        // * 成功通知\n        tywx.tt.ads.listenCDNData();\n        tywx.tt.lottery.listenCDNConfigData();\n        tywx.tt.ads.listenADManagerData();\n        let self = this;\n        let xhr = cc.loader.getXMLHttpRequest();\n        //TODO: 添加审核判断\n        xhr.onreadystatechange = () => {\n            if (xhr.readyState === 4 && (xhr.status >= 200 && xhr.status < 400)) {\n                let response = JSON.parse(xhr.responseText);\n                for (let att in response.default) {\n                    self[att] = response.default[att];\n                }\n                tywx.tt.constants.WXAdConfig.bannerId = self.WXAd.banner;\n                tywx.tt.constants.WXAdConfig.vedioId = self.WXAd.video;\n                if (tywx.tt.constants.WXAdConfig.vedioId === '') {\n                    tywx.tt.isCanWatchVideo = false;\n                } else {\n                    tywx.tt.isCanWatchVideo = true;\n                }\n\n                tywx.tt.log(TAG, 'request config success' + JSON.stringify(response));\n                tywx.NotificationCenter.trigger(tywx.tt.events.TT_GET_CONFIG_SUCCESS, response);\n            }else{\n                tywx.NotificationCenter.trigger(tywx.tt.events.TT_GET_CONFIG_FAIL, null);\n            }\n        };\n        xhr.open(\"GET\", _configUrl, true);\n        xhr.send();\n    }\n}\nConfigManager[_instance] = null;\nmodule.exports = ConfigManager;"]}