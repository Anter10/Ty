{"version":3,"sources":["tt_model_config_manager.js"],"names":["TAG","_instance","Symbol","_configUrl","ConfigManager","tywx","tt","log","ads","listenCDNData","lottery","listenCDNConfigData","listenADManagerData","self","xhr","cc","loader","getXMLHttpRequest","onreadystatechange","readyState","status","response","JSON","parse","responseText","att","default","constants","WXAdConfig","bannerId","WXAd","banner","vedioId","video","isCanWatchVideo","stringify","NotificationCenter","trigger","events","TT_GET_CONFIG_SUCCESS","open","send","module","exports","getInstance"],"mappings":";;;;;;;;;;AAAA,IAAIA,MAAM,0BAAV;AACA,IAAIC,YAAYC,OAAOF,GAAP,CAAhB;AACA,IAAIG,aAAa,qDAAjB;;IACMC;AACF,6BAAc;AAAA;AAAE;;;;wCAKA;AACZC,iBAAKC,EAAL,CAAQC,GAAR,CAAYP,GAAZ,EAAiB,eAAjB;AACA;AACAK,iBAAKC,EAAL,CAAQE,GAAR,CAAYC,aAAZ;AACAJ,iBAAKC,EAAL,CAAQI,OAAR,CAAgBC,mBAAhB;AACAN,iBAAKC,EAAL,CAAQE,GAAR,CAAYI,mBAAZ;AACA,gBAAIC,OAAO,IAAX;AACA,gBAAIC,MAAMC,GAAGC,MAAH,CAAUC,iBAAV,EAAV;AACA;AACAH,gBAAII,kBAAJ,GAAyB,YAAM;AAC3B,oBAAIJ,IAAIK,UAAJ,KAAmB,CAAnB,IAAyBL,IAAIM,MAAJ,IAAc,GAAd,IAAqBN,IAAIM,MAAJ,GAAa,GAA/D,EAAqE;AACjE,wBAAIC,WAAWC,KAAKC,KAAL,CAAWT,IAAIU,YAAf,CAAf;AACA,yBAAK,IAAIC,GAAT,IAAgBJ,SAASK,OAAzB,EAAkC;AAC9Bb,6BAAKY,GAAL,IAAYJ,SAASK,OAAT,CAAiBD,GAAjB,CAAZ;AACH;AACDpB,yBAAKC,EAAL,CAAQqB,SAAR,CAAkBC,UAAlB,CAA6BC,QAA7B,GAAwChB,KAAKiB,IAAL,CAAUC,MAAlD;AACA1B,yBAAKC,EAAL,CAAQqB,SAAR,CAAkBC,UAAlB,CAA6BI,OAA7B,GAAuCnB,KAAKiB,IAAL,CAAUG,KAAjD;AACA,wBAAI5B,KAAKC,EAAL,CAAQqB,SAAR,CAAkBC,UAAlB,CAA6BI,OAA7B,KAAyC,EAA7C,EAAiD;AAC7C3B,6BAAKC,EAAL,CAAQ4B,eAAR,GAA0B,KAA1B;AACH,qBAFD,MAEO;AACH7B,6BAAKC,EAAL,CAAQ4B,eAAR,GAA0B,IAA1B;AACH;;AAED7B,yBAAKC,EAAL,CAAQC,GAAR,CAAYP,GAAZ,EAAiB,2BAA2BsB,KAAKa,SAAL,CAAed,QAAf,CAA5C;AACAhB,yBAAK+B,kBAAL,CAAwBC,OAAxB,CAAgChC,KAAKC,EAAL,CAAQgC,MAAR,CAAeC,qBAA/C,EAAsElB,QAAtE;AACH;AACJ,aAjBD;AAkBAP,gBAAI0B,IAAJ,CAAS,KAAT,EAAgBrC,UAAhB,EAA4B,IAA5B;AACAW,gBAAI2B,IAAJ;AACH;;;sCAjCoB;AACjB,gBAAI,CAACrC,cAAcH,SAAd,CAAL,EAA+BG,cAAcH,SAAd,IAA2B,IAAIG,aAAJ,EAA3B;AAC/B,mBAAOA,cAAcH,SAAd,CAAP;AACH;;;;;;AAgCLG,cAAcH,SAAd,IAA2B,IAA3B;AACAyC,OAAOC,OAAP,GAAiBvC,cAAcwC,WAAd,EAAjB","file":"tt_model_config_manager.js","sourceRoot":"../../../../../../assets/scripts/game/model","sourcesContent":["let TAG = '[tt.model.ConfigManager]';\nlet _instance = Symbol(TAG);\nlet _configUrl = 'https://elsfkws.nalrer.cn/teris/config/els1010.json';\nclass ConfigManager {\n    constructor() {}\n    static getInstance() {\n        if (!ConfigManager[_instance]) ConfigManager[_instance] = new ConfigManager();\n        return ConfigManager[_instance];\n    }\n    requestConfig() {\n        tywx.tt.log(TAG, 'requestConfig');\n        // * 成功通知\n        tywx.tt.ads.listenCDNData();\n        tywx.tt.lottery.listenCDNConfigData();\n        tywx.tt.ads.listenADManagerData();\n        let self = this;\n        let xhr = cc.loader.getXMLHttpRequest();\n        //TODO: 添加审核判断\n        xhr.onreadystatechange = () => {\n            if (xhr.readyState === 4 && (xhr.status >= 200 && xhr.status < 400)) {\n                let response = JSON.parse(xhr.responseText);\n                for (let att in response.default) {\n                    self[att] = response.default[att];\n                }\n                tywx.tt.constants.WXAdConfig.bannerId = self.WXAd.banner;\n                tywx.tt.constants.WXAdConfig.vedioId = self.WXAd.video;\n                if (tywx.tt.constants.WXAdConfig.vedioId === '') {\n                    tywx.tt.isCanWatchVideo = false;\n                } else {\n                    tywx.tt.isCanWatchVideo = true;\n                }\n\n                tywx.tt.log(TAG, 'request config success' + JSON.stringify(response));\n                tywx.NotificationCenter.trigger(tywx.tt.events.TT_GET_CONFIG_SUCCESS, response);\n            }\n        };\n        xhr.open(\"GET\", _configUrl, true);\n        xhr.send();\n    }\n}\nConfigManager[_instance] = null;\nmodule.exports = ConfigManager.getInstance();"]}