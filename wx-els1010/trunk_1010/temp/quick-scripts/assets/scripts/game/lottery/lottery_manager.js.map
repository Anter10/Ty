{"version":3,"sources":["lottery_manager.js"],"names":["TAG","lotery_view_path","lottery_button_path","lottery_manager","cc","Class","statics","lotterynode","data","getLotteryDataByType","lot_type","tywx","tt","error","removeLotteryView","removeFromParent","setData","default","turning_disc","log","JSON","stringify","addZPIcon","tlot_type","tparent","tpos","pos","parent","loader","loadRes","err","prefab","adsnode","instantiate","ads_script","getComponent","setType","position","addChild","listenCDNConfigData","NotificationCenter","listen","events","TT_GET_CONFIG_SUCCESS","showLottery","director","getScene","warn","module","exports"],"mappings":";;;;;;AAAA,IAAIA,MAAM,oCAAV;AACA,IAAIC,mBAAmB,sBAAvB;AACA,IAAIC,sBAAsB,wBAA1B;;AAEA,IAAMC,kBAAkBC,GAAGC,KAAH,CAAS;AAC7BC,aAAS;AACLC,qBAAa,IADR;AAELC,cAAM,IAFD;;AAIL;;;;AAIAC,8BAAsB,8BAAUC,QAAV,EAAoB;AACrC,gBAAIP,gBAAgBK,IAAhB,CAAqBE,QAArB,CAAJ,EAAmC;AAC/B,uBAAOP,gBAAgBK,IAAhB,CAAqBE,QAArB,CAAP;AACH,aAFD,MAEK;AACDC,qBAAKC,EAAL,CAAQC,KAAR,CAAcb,GAAd,EAAmB,SAASU,QAAT,GAAkB,SAArC;AACH;AACD,mBAAO,IAAP;AACJ,SAfI;;AAiBL;;;AAGAI,2BAAkB,6BAAU;AACvBX,4BAAgBI,WAAhB,CAA4BQ,gBAA5B,CAA6C,KAA7C;AACAZ,4BAAgBI,WAAhB,GAA8B,IAA9B;AACJ,SAvBI;;AAyBL;;;;AAIAS,iBAAS,iBAAUR,IAAV,EAAgB;AACrBL,4BAAgBK,IAAhB,GAAuBA,KAAKS,OAAL,CAAaC,YAApC;AACAP,iBAAKC,EAAL,CAAQO,GAAR,CAAY,eAAaC,KAAKC,SAAL,CAAelB,gBAAgBK,IAA/B,CAAzB;AACH,SAhCI;;AAkCL;;;;;;AAMAc,mBAAU,mBAASC,SAAT,EAAmBC,OAAnB,EAA2BC,IAA3B,EAAgC;AACtC,gBAAMC,MAAMD,IAAZ;AACA,gBAAME,SAASH,OAAf;AACA,gBAAMd,WAAWa,SAAjB;AACAnB,eAAGwB,MAAH,CAAUC,OAAV,CAAkB3B,mBAAlB,EAAuC,UAAC4B,GAAD,EAAMC,MAAN,EAAiB;AACpD,oBAAI,CAACD,GAAL,EAAU;AACN,wBAAIE,UAAU5B,GAAG6B,WAAH,CAAeF,MAAf,CAAd;AACA,wBAAIG,aAAaF,QAAQG,YAAR,CAAqB,gBAArB,CAAjB;AACAD,+BAAWE,OAAX,CAAmB1B,QAAnB;AACAsB,4BAAQK,QAAR,GAAmBX,GAAnB;AACAC,2BAAOW,QAAP,CAAgBN,OAAhB;AACH;AACJ,aARD;AASH,SArDI;;AAuDL;;;AAGAO,6BAAqB,+BAAY;AAC7B5B,iBAAK6B,kBAAL,CAAwBC,MAAxB,CAA+B9B,KAAKC,EAAL,CAAQ8B,MAAR,CAAeC,qBAA9C,EAAqExC,gBAAgBa,OAArF,EAA8Fb,eAA9F;AACH,SA5DI;;AA8DL;;;;AAIAyC,qBAAa,qBAAUlC,QAAV,EAAoB;AAC7B,gBAAIP,gBAAgBK,IAApB,EAA0B;AACtB,oBAAIe,YAAYb,QAAhB;AACAN,mBAAGwB,MAAH,CAAUC,OAAV,CAAkB5B,gBAAlB,EAAoC,UAAC6B,GAAD,EAAMC,MAAN,EAAiB;AACjD,wBAAI,CAACD,GAAL,EAAU;AACN,4BAAIvB,cAAcH,GAAG6B,WAAH,CAAeF,MAAf,CAAlB;AACA,4BAAIG,aAAa3B,YAAY4B,YAAZ,CAAyB,cAAzB,CAAjB;AACAD,mCAAWlB,OAAX,CAAmBb,gBAAgBM,oBAAhB,CAAqCc,SAArC,CAAnB;AACApB,wCAAgBI,WAAhB,GAA8BA,WAA9B;AACAH,2BAAGyC,QAAH,CAAYC,QAAZ,GAAuBR,QAAvB,CAAgC/B,WAAhC;AACH;AACJ,iBARD;AASH,aAXD,MAWK;AACDI,qBAAKC,EAAL,CAAQmC,IAAR,CAAa,QAAb;AACH;AACJ;AAjFI;AADoB,CAAT,CAAxB;;AAwFAC,OAAOC,OAAP,GAAiB9C,eAAjB","file":"lottery_manager.js","sourceRoot":"../../../../../../assets/scripts/game/lottery","sourcesContent":["let TAG = '[game/lottery/lottery_manager.js]]';\nlet lotery_view_path = \"prefabs/lottery_view\";\nlet lottery_button_path = \"prefabs/lottery_button\";\n\nconst lottery_manager = cc.Class({\n    statics: {\n        lotterynode: null,\n        data: null,\n\n        /**\n         * @description 得到当前类型的抽奖数据\n         * @param {String} lot_type  抽奖数据\n         */\n        getLotteryDataByType: function (lot_type) {\n             if (lottery_manager.data[lot_type]){\n                 return lottery_manager.data[lot_type];\n             }else{\n                 tywx.tt.error(TAG, \"没有你给\" + lot_type+\"类型的红包数据\");\n             }\n             return null;\n        },\n\n        /**\n         * @description 删除抽奖界面\n         */\n        removeLotteryView:function(){\n             lottery_manager.lotterynode.removeFromParent(false);\n             lottery_manager.lotterynode = null;\n        },\n\n        /**\n         * @description 设置游戏的抽奖数据\n         * @param {Object} data 抽奖的所有数据\n         */\n        setData: function (data) {\n            lottery_manager.data = data.default.turning_disc;\n            tywx.tt.log(\"当前的抽奖数据 = \"+JSON.stringify(lottery_manager.data));\n        },\n \n        /**\n         * @description 添加转盘按钮\n         * @param {String} tlot_type \n         * @param {cc.Node} tparent \n         * @param {cc.v2} tpos \n         */\n        addZPIcon:function(tlot_type,tparent,tpos){\n            const pos = tpos;\n            const parent = tparent;\n            const lot_type = tlot_type;\n            cc.loader.loadRes(lottery_button_path, (err, prefab) => {\n                if (!err) {\n                    let adsnode = cc.instantiate(prefab);\n                    let ads_script = adsnode.getComponent('lottery_button');\n                    ads_script.setType(lot_type);\n                    adsnode.position = pos;\n                    parent.addChild(adsnode);\n                }\n            });\n        },\n\n        /**\n         * @description 监听config的CDN数据\n         */\n        listenCDNConfigData: function () {\n            tywx.NotificationCenter.listen(tywx.tt.events.TT_GET_CONFIG_SUCCESS, lottery_manager.setData, lottery_manager);\n        },\n\n        /**\n         * @description 展示抽奖界面\n         * @param {String} lot_type 抽奖类型\n         */\n        showLottery: function (lot_type) {\n            if (lottery_manager.data) {\n                let tlot_type = lot_type;\n                cc.loader.loadRes(lotery_view_path, (err, prefab) => {\n                    if (!err) {\n                        let lotterynode = cc.instantiate(prefab);\n                        let ads_script = lotterynode.getComponent('lottery_view');\n                        ads_script.setData(lottery_manager.getLotteryDataByType(tlot_type));\n                        lottery_manager.lotterynode = lotterynode;\n                        cc.director.getScene().addChild(lotterynode);\n                    }\n                });\n            }else{\n                tywx.tt.warn(\"没有抽奖数据\");\n            }\n        }\n    },\n});\n\n\n\nmodule.exports = lottery_manager;"]}