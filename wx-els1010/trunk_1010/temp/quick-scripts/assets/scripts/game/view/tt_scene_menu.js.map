{"version":3,"sources":["tt_scene_menu.js"],"names":["cc","Class","extends","Component","properties","gqnumberLabel","Label","zpbtnNode","Node","bannerNode","btnGetMoney","onLoad","tywx","tt","Utils","sendWXMsg","method","MAIN_MENU_NUM","constants","TT_SCORE","boot","lottery","addZPIcon","v2","ads","addAdsNode","string","parseInt","loadItem","NotificationCenter","listen","events","TT_EVENT_RED_PACKET_CHANGE","onRedPacktChange","TT_EVENT_GET_IP_SUCCESS","getIPSuccess","Timer","setTimer","isMinGanIP","isMinGanIp","AdManager","ipLocInfo","loginSuccess","res","console","log","JSON","stringify","data","totalAmount","max","formatCashFen2Yuan","getComponent","init","self","UserInfo","userId","requestRedPacket","success","active","fail","isFirstLogin","onDestroy","hideGameClub","destroyWXBanner","ignoreScope","startGame","e","director","loadScene","showPhb","rank_manager","showRank","start"],"mappings":"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","file":"tt_scene_menu.js","sourceRoot":"../../../../../../assets/scripts/game/view","sourcesContent":["cc.Class({\n    extends: cc.Component,\n\n    properties: {\n        gqnumberLabel: cc.Label,\n        zpbtnNode: cc.Node,\n        bannerNode: cc.Node,\n        btnGetMoney: cc.Node,\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad() {\n        tywx.tt.Utils.sendWXMsg({\n            method: \"load_data\",\n            MAIN_MENU_NUM: tywx.tt.constants.TT_SCORE,\n        })\n        tywx.tt.boot();\n        tywx.tt.lottery.addZPIcon(\"home\", this.zpbtnNode, cc.v2(0, 0));\n        tywx.tt.ads.addAdsNode(\"banner_menu\", this.bannerNode, cc.v2(0, 0));\n        // 当前最大分数\n        this.gqnumberLabel.string = parseInt(tywx.tt.Utils.loadItem(tywx.tt.constants.TT_SCORE, 0)) + \"\";\n        tywx.NotificationCenter.listen(tywx.tt.events.TT_EVENT_RED_PACKET_CHANGE, this.onRedPacktChange, this);\n        tywx.NotificationCenter.listen(tywx.tt.events.TT_EVENT_GET_IP_SUCCESS, this.getIPSuccess, this);\n        tywx.Timer.setTimer(this, function () {\n            tywx.tt.isMinGanIP = tywx.tt.Utils.isMinGanIp(tywx.AdManager.ipLocInfo);\n            // console.log(\"是否为敏感IP = \" + JSON.stringify(tywx.tt.configManager.share_control));\n            this.loginSuccess();\n        }, 1, 1, 1);\n    },\n    \n    /**\n     * @param {Object} res 得到IP的回调\n     */\n    getIPSuccess:function(res){\n       console.log(\"IP信息 = \"+JSON.stringify(res));\n    },\n\n    /**\n     * @description 红包更改的时候回调\n     */\n    onRedPacktChange: function (res) {\n        if (res.data && res.data.totalAmount) {\n            let data = {}\n            data.max = tywx.tt.Utils.formatCashFen2Yuan(res.data.totalAmount);\n            this.btnGetMoney.getComponent('GetMoneyButton').init(data);\n        } else {\n             console.log(\"通知事件中的红包数据 = \"+JSON.stringify(res));\n        }\n    },\n    \n    /**\n     * @description 延迟加载初始化某些数据\n     */\n    loginSuccess() {\n        // ! 显示红包\n        let self = this;\n        console.log(\"tywx.UserInfo.userId = \" + tywx.UserInfo.userId);\n        // if (tywx.UserInfo.userId === 0 || tywx.config.auditing === true) return;\n        tywx.tt.Utils.requestRedPacket({\n            success: (res) => {\n                self.btnGetMoney.active = true;\n                console.log(\"huuu = \" + JSON.stringify(res));\n                self.btnGetMoney.getComponent('GetMoneyButton').init(res);\n            },\n            fail: (res) => {\n                self.btnGetMoney.active = false;\n            }\n        });\n        // ! 登陆游戏后第一次进入菜单特殊处理\n        if (tywx.tt.isFirstLogin) {\n\n        }\n    },\n\n    \n    onDestroy() {\n        tywx.tt.Utils.hideGameClub();\n        tywx.tt.Utils.destroyWXBanner();\n        tywx.NotificationCenter.ignoreScope(this);\n    },\n\n    /**\n     * @description 点击开始游戏的时候调用\n     * @param {Object} e 回调的对象\n     */\n    startGame: function (e) {\n        cc.director.loadScene(\"scene_play\");\n    },\n\n    /**\n     * @description 显示排行榜\n     */\n    showPhb: function () {\n        tywx.tt.rank_manager.showRank();\n    },\n\n    start() {\n\n    },\n\n    // update (dt) {},\n});"]}