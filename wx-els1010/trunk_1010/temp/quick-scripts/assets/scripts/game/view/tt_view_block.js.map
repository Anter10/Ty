{"version":3,"sources":["tt_view_block.js"],"names":["TAG","cc","Class","extends","Component","properties","blink","Sprite","onLoad","mask","node","getChildByName","active","onEnable","start","blockBlink","scale1","scaleTo","scale2","seq","sequence","rep","repeatForever","runAction","blockHide","stopAllActions","refresh","setStat","stat","frameIdx","init","getStat","hideBg","setBgColor","color","self","loader","loadRes","SpriteFrame","err","sprite_frame","getComponent","spriteFrame","tywx","tt","log","display","frame","displaySprite","frameSprite","blinkDisplay","scale","showMask","hideMask"],"mappings":";;;;;;AAAA,IAAIA,MAAM,iBAAV;AACAC,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACRC,eAAOL,GAAGM;AADF,KAHP;;AAOL;;AAEAC,UATK,oBASI;AACL;AACA,aAAKC,IAAL,GAAY,KAAKC,IAAL,CAAUC,cAAV,CAAyB,MAAzB,CAAZ;AACA;AACA,aAAKF,IAAL,CAAUG,MAAV,GAAmB,KAAnB;AACH,KAdI;AAeLC,YAfK,sBAeM;AACP;AACH,KAjBI;AAmBLC,SAnBK,mBAmBG;AACJ;;AAEH,KAtBI;;;AAwBLC,gBAAY,sBAAY;AACpB,aAAKT,KAAL,CAAWI,IAAX,CAAgBE,MAAhB,GAAyB,IAAzB;AACA,YAAII,SAASf,GAAGgB,OAAH,CAAW,GAAX,EAAgB,GAAhB,CAAb;AACA,YAAIC,SAASjB,GAAGgB,OAAH,CAAW,GAAX,EAAgB,CAAhB,CAAb;AACA,YAAIE,MAAMlB,GAAGmB,QAAH,CAAYJ,MAAZ,EAAoBE,MAApB,CAAV;AACA,YAAIG,MAAMpB,GAAGqB,aAAH,CAAiBH,GAAjB,CAAV;AACA,aAAKb,KAAL,CAAWI,IAAX,CAAgBa,SAAhB,CAA0BF,GAA1B;AACH,KA/BI;;AAiCLG,eAAW,qBAAY;AACnB,aAAKlB,KAAL,CAAWI,IAAX,CAAgBE,MAAhB,GAAyB,KAAzB;AACA,aAAKN,KAAL,CAAWI,IAAX,CAAgBe,cAAhB;AACH,KApCI;;AAsCL;AACAC,WAvCK,qBAuCK,CAET,CAzCI;AA0CLC,WA1CK,mBA0CGC,IA1CH,EA0CS;AACV;AACA,aAAKA,IAAL,GAAYA,IAAZ;AACA,aAAKC,QAAL,GAAgB,CAAC,CAAjB;AACA,aAAKC,IAAL;AAEH,KAhDI;AAkDLC,WAlDK,qBAkDI;AACL,eAAO,KAAKH,IAAZ;AACH,KApDI;AAsDLI,UAtDK,oBAsDI;AACL,aAAKtB,IAAL,CAAUC,cAAV,CAAyB,IAAzB,EAA+BC,MAA/B,GAAwC,KAAxC;AAEH,KAzDI;AA0DLqB,cA1DK,sBA0DMC,KA1DN,EA0Da;AACd;AACA;AACA,YAAIC,OAAO,IAAX;AACA,YAAID,SAAS,CAAb,EAAe;AACZjC,eAAGmC,MAAH,CAAUC,OAAV,+BAAgDpC,GAAGqC,WAAnD,EAAgE,UAACC,GAAD,EAAMC,YAAN,EAAuB;AACjF,oBAAI,CAACD,GAAL,EAAU;AACPJ,yBAAKzB,IAAL,CAAUC,cAAV,CAAyB,IAAzB,EAA+B8B,YAA/B,CAA4CxC,GAAGM,MAA/C,EAAuDmC,WAAvD,GAAqEF,YAArE;AACF,iBAFD,MAEO;AACJG,yBAAKC,EAAL,CAAQC,GAAR,CAAY7C,GAAZ,EAAiB,YAAjB;AACF;AACL,aANF;AAOF,SARD,MAQK;AACDC,eAAGmC,MAAH,CAAUC,OAAV,+BAAgDpC,GAAGqC,WAAnD,EAAgE,UAACC,GAAD,EAAMC,YAAN,EAAuB;AACnF,oBAAI,CAACD,GAAL,EAAU;AACNJ,yBAAKzB,IAAL,CAAUC,cAAV,CAAyB,IAAzB,EAA+B8B,YAA/B,CAA4CxC,GAAGM,MAA/C,EAAuDmC,WAAvD,GAAqEF,YAArE;AACH,iBAFD,MAEO;AACHG,yBAAKC,EAAL,CAAQC,GAAR,CAAY7C,GAAZ,EAAiB,YAAjB;AACH;AACJ,aAND;AAOH;AACJ,KA/EI;AAgFL8B,QAhFK,kBAgFE;AACH,aAAKgB,OAAL,GAAe,KAAKpC,IAAL,CAAUC,cAAV,CAAyB,SAAzB,CAAf;AACA,aAAKoC,KAAL,GAAa,KAAKrC,IAAL,CAAUC,cAAV,CAAyB,OAAzB,CAAb;AACA,aAAKqC,aAAL,GAAqB,KAAKF,OAAL,CAAaL,YAAb,CAA0BxC,GAAGM,MAA7B,CAArB;AACA,aAAK0C,WAAL,GAAmB,KAAKF,KAAL,CAAWN,YAAX,CAAwBxC,GAAGM,MAA3B,CAAnB;;AAEA,YAAI,KAAKqB,IAAL,KAAc,CAAC,CAAnB,EAAsB;AAClB;AACA,iBAAKmB,KAAL,CAAWnC,MAAX,GAAoB,IAApB;AACH,SAHD,MAGO,IAAI,KAAKgB,IAAL,KAAc,CAAC,CAAnB,EAAsB;AACzB;AACA,iBAAKmB,KAAL,CAAWnC,MAAX,GAAoB,KAApB;AACH,SAHM,MAGA,IAAI,KAAKgB,IAAL,KAAc,CAAlB,EAAqB;AACxB,iBAAKmB,KAAL,CAAWnC,MAAX,GAAoB,KAApB;AACA,iBAAKkC,OAAL,CAAalC,MAAb,GAAsB,KAAtB;AACH,SAHM,MAGA;;AAEH,iBAAKmC,KAAL,CAAWnC,MAAX,GAAoB,KAApB;AACA,iBAAKkC,OAAL,CAAalC,MAAb,GAAsB,IAAtB;AACA,iBAAKiB,QAAL,GAAgB,KAAKD,IAArB;AACA,gBAAIO,OAAO,IAAX;AACAlC,eAAGmC,MAAH,CAAUC,OAAV,wBAAuC,KAAKT,IAA5C,EAAoD3B,GAAGqC,WAAvD,EAAoE,UAACC,GAAD,EAAMC,YAAN,EAAuB;AACvF,oBAAI,CAACD,GAAL,EAAU;AACNJ,yBAAKa,aAAL,CAAmBN,WAAnB,GAAiCF,YAAjC;AACH,iBAFD,MAEO;AACJG,yBAAKC,EAAL,CAAQC,GAAR,CAAY7C,GAAZ,EAAiB,YAAjB;AACF;AACJ,aAND;AAOA,iBAAKkD,YAAL;AACH;AACJ,KA9GI;AAgHLA,gBAhHK,0BAgHU;AACX,aAAKF,aAAL,CAAmBtC,IAAnB,CAAwBe,cAAxB;AACA,YAAI,KAAKG,IAAL,IAAa,EAAjB,EAAqB;AACjB,gBAAIZ,SAASf,GAAGgB,OAAH,CAAW,GAAX,EAAgB,GAAhB,CAAb;AACA,gBAAIC,SAASjB,GAAGgB,OAAH,CAAW,GAAX,EAAgB,CAAhB,CAAb;AACA,gBAAIE,MAAMlB,GAAGmB,QAAH,CAAYJ,MAAZ,EAAoBE,MAApB,CAAV;AACA,gBAAIG,MAAMpB,GAAGqB,aAAH,CAAiBH,GAAjB,CAAV;AACA,iBAAK6B,aAAL,CAAmBtC,IAAnB,CAAwBa,SAAxB,CAAkCF,GAAlC;AACH,SAND,MAMK;AACD,iBAAK2B,aAAL,CAAmBtC,IAAnB,CAAwByC,KAAxB,GAAgC,CAAhC;AACH;AACJ,KA3HI;AA6HLC,YA7HK,sBA6HM;AACP,aAAK3C,IAAL,CAAUG,MAAV,GAAmB,IAAnB;AACH,KA/HI;AAgILyC,YAhIK,sBAgIM;AACP,aAAK5C,IAAL,CAAUG,MAAV,GAAmB,KAAnB;AACH;AAlII,CAAT","file":"tt_view_block.js","sourceRoot":"../../../../../../assets/scripts/game/view","sourcesContent":["let TAG = '[tt_view_block]';\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        blink: cc.Sprite,\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad() {\n        //tywx.tt.log(TAG,'onLoad');\n        this.mask = this.node.getChildByName('mask');\n        // this.node.getChildByName('frame').opacity = 144;\n        this.mask.active = false;\n    },\n    onEnable() {\n        //tywx.tt.log(TAG,'onEnable');\n    },\n\n    start() {\n        //tywx.tt.log(TAG,'start');\n\n    },\n\n    blockBlink: function () {\n        this.blink.node.active = true;\n        let scale1 = cc.scaleTo(0.5, 1.1);\n        let scale2 = cc.scaleTo(0.5, 1);\n        let seq = cc.sequence(scale1, scale2);\n        let rep = cc.repeatForever(seq);\n        this.blink.node.runAction(rep);\n    },\n\n    blockHide: function () {\n        this.blink.node.active = false;\n        this.blink.node.stopAllActions();\n    },\n\n    // update (dt) {},\n    refresh() {\n\n    },\n    setStat(stat) {\n        //tywx.tt.log(TAG,'setStat');        \n        this.stat = stat;\n        this.frameIdx = -1;\n        this.init();\n\n    },\n\n    getStat(){\n        return this.stat;\n    },\n\n    hideBg() {\n        this.node.getChildByName('bg').active = false;\n\n    },\n    setBgColor(color) {\n        // this.node.getChildByName('bg').color = color;\n        // this.node.getChildByName('bg').opacity = 35;\n        let self = this;\n        if (color == 1){\n           cc.loader.loadRes(`images/tt_blocks/greyblack`, cc.SpriteFrame, (err, sprite_frame) => {\n                 if (!err) {\n                    self.node.getChildByName('bg').getComponent(cc.Sprite).spriteFrame = sprite_frame;\n                 } else {\n                    tywx.tt.log(TAG, \"ddda error\");\n                 }\n            });\n        }else{\n            cc.loader.loadRes(`images/tt_blocks/hideblack`, cc.SpriteFrame, (err, sprite_frame) => {\n                if (!err) {\n                    self.node.getChildByName('bg').getComponent(cc.Sprite).spriteFrame = sprite_frame;\n                } else {\n                    tywx.tt.log(TAG, \"ddda error\");\n                }\n            });\n        }\n    },\n    init() {\n        this.display = this.node.getChildByName('display');\n        this.frame = this.node.getChildByName('frame');\n        this.displaySprite = this.display.getComponent(cc.Sprite);\n        this.frameSprite = this.frame.getComponent(cc.Sprite);\n\n        if (this.stat === -1) {\n            // * 显示选中框\n            this.frame.active = true;\n        } else if (this.stat === -2) {\n            // * 隐藏选中框\n            this.frame.active = false;\n        } else if (this.stat === 0) {\n            this.frame.active = false;\n            this.display.active = false;\n        } else {\n\n            this.frame.active = false;\n            this.display.active = true;\n            this.frameIdx = this.stat;\n            let self = this;\n            cc.loader.loadRes(`images/tt_blocks/b${this.stat}`, cc.SpriteFrame, (err, sprite_frame) => {\n                if (!err) {\n                    self.displaySprite.spriteFrame = sprite_frame;\n                } else {\n                   tywx.tt.log(TAG, \"ddda error\");\n                }\n            });\n            this.blinkDisplay();\n        }\n    },\n    \n    blinkDisplay() {\n        this.displaySprite.node.stopAllActions();\n        if (this.stat == 12) {\n            let scale1 = cc.scaleTo(0.6, 1.1);\n            let scale2 = cc.scaleTo(0.6, 1);\n            let seq = cc.sequence(scale1, scale2);\n            let rep = cc.repeatForever(seq);\n            this.displaySprite.node.runAction(rep);\n        }else{\n            this.displaySprite.node.scale = 1;\n        }\n    },\n\n    showMask() {\n        this.mask.active = true;\n    },\n    hideMask() {\n        this.mask.active = false;\n    }\n});"]}