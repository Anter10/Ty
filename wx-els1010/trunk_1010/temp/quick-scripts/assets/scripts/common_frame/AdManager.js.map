{"version":3,"sources":["AdManager.js"],"names":["tywx","AdManager","retryCrossTimes","retryBannerTimes","retryNewAdTimes","iconTimer","bannerTimer","newIconTimer","AnimType","STATIC","SHAKE","FRAME","adNodeList","bannerNodeList","newAdNodeList","newAdPointInfoList","allAdInfoList","allBannerInfoList","allNewAdInfoDict","rawAdInfoList","rawBannerInfoList","undefined","rawNewAdInfoDict","showAd","position","tag","_adnode","adNodeClass","adInfoList","JSON","parse","stringify","adType","adTag","x","y","createAdNode","push","showBanner","showNewAd","pointName","console","error","getAdNodeList","getAdNodeByTag","n","toString","getBannerNodeList","getBannerNodeByTag","getNewAdNodeList","getNewAdNodeByTag","getAdInfoList","getBannerInfoList","getNewAdInfoDict","adIconBtn","currentAdInfo","currentWebPage","adNodeObj","pos","genRandomFirstAdInfo","active","that","cc","loader","loadRes","err","prefab","preFabNode","instantiate","_pos","p","game","addPersistRootNode","adIconNode","adButton","getChildByName","on","onClickAdIconBtn","length","weight_list","i","_randomObj","parseInt","icon_weight","icon_id","sort","a","b","weight","_total","forEach","element","_randomIndex","Math","random","_tTotal","_selectIndex","_selectObj","id","genRandomSecondAdInfo","_webPages","webpages","webpage_weight","config_id","_animaType","icon_type","spriteIco","stopAllActions","removeComponent","Animation","setRotation","load","url","icon_url","texture","getComponent","Sprite","spriteFrame","SpriteFrame","width","height","setContentSize","size","anchorX","anchorY","_act1","rotateBy","_act2","_act3","_act4","_delay","delayTime","runAction","repeatForever","sequence","repeat","allFrames","playFrameAction","_firstFrameIcon","getTexture","_time_interval","time_interval","_frameRate","animation","addComponent","clip","AnimationClip","createWithSpriteFrames","name","wrapMode","WrapMode","Loop","addClip","play","results","log","getError","getContent","_frame","skip_type","icon_skip_type","toappid","togame","topath","path","second_toappid","webpage_url","webpage_id","bi_paramlist","BiLog","clickStat","clickStatEventType","clickStatEventTypeClickAdBtn","wx","navigateToMiniProgram","appId","envVersion","extraData","from","success","res","clickStatEventTypeClickDirectToMiniGameSuccess","fail","clickStatEventTypeClickDirectToMiniGameFail","complete","resetBtnIcon","clickStatEventTypeClickShowQRCode","IsWechatPlatform","previewImage","current","urls","LOGD","onForeGround","showAdNode","hideAdNode","freshAdIconByTime","_adNode","freshAdBannerByTime","freshNewAdIconByTime","startFreshAdIcon","icon_interval","_icon_interval","clearInterval","setInterval","banner_interval","new_icon_interval","e","getConfigSignStr","reqObj","sortedKeys","Object","keys","signStr","key","finalSign","hex_md5","requestADInfo","timeStamp","Date","getTime","act","time","game_mark","SystemInfo","cloudId","gameId","paramStrList","finalUrl","shareManagerUrl","join","request","method","statusCode","ret","data","retmsg","processIconConfigInfo","LOGE","requestBannerInfo","processBannerConfigInfo","requestNewAdInfo","processNewIconConfigInfo","processRawConfigInfo","UserInfo","userId","v","floor","isTestMode","_test_uidList","push_uids","len","_white_rear_uidList","push_users","_len","j","_sUid","charAt","NotificationCenter","trigger","EventType","GET_ADMANAGER_ICON_INFO_SUCCESS","GET_ADMANAGER_BANNER_INFO_SUCCESS","requestLocalIPInfo","_url","loc","ipLocInfo","tt","isMinGanIP","Utils","isMinGanIp","events","TT_EVENT_GET_IP_SUCCESS","newAdPoints","newAdPointList","GET_ADMANAGER_NEWICON_INFO_SUCCESS","init","prototype"],"mappings":"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","file":"AdManager.js","sourceRoot":"../../../../../assets/scripts/common_frame","sourcesContent":["/**\n * 交叉导流相关系统接口, 调用导流接口使用showAd 接口， 刷新导流显示icon使用resetBtnIcon 接口\n */\ntywx.AdManager = {\n\n    retryCrossTimes: 3, //3次网络重试的机会\n    retryBannerTimes: 3, //3次网络重试的机会\n    retryNewAdTimes: 3, //3次网络重试的机会\n\n    iconTimer: 0, //icon计时器\n    bannerTimer: 0, //banner计时器\n    newIconTimer: 0, //newIcon计时器\n\n    AnimType: {\n        STATIC: 1, //静态\n        SHAKE: 2, //抖动\n        FRAME: 3 //帧动画\n\n    },\n\n    adNodeList: [], //存放icon节点列表\n    bannerNodeList: [], //存放banner节点列表\n    newAdNodeList: [], //存放newAd节点列表\n    newAdPointInfoList: [], //存放newAdPoint信息列表\n    allAdInfoList: [], //存放icon信息列表\n    allBannerInfoList: [], //存放banner信息列表\n    allNewAdInfoDict: {}, //存放newAd信息列表\n    rawAdInfoList: [], //存放服务端返回的原始icon信息\n    rawBannerInfoList: undefined, //存放服务端返回的原始banner信息\n    rawNewAdInfoDict: undefined, //存放服务端返回的原始newAd信息\n\n    //创建导流icon，每调用一次就会创建一个\n    showAd: function (position, tag) {\n\n        var _adnode = new tywx.AdManager.adNodeClass();\n        _adnode.adInfoList = JSON.parse(JSON.stringify(tywx.AdManager.allAdInfoList));\n        _adnode.adType = 1;\n        _adnode.adTag = tag || '';\n\n        if (position == undefined) {\n            position = {\n                x: 0,\n                y: 0\n            };\n        }\n        _adnode.createAdNode(position);\n\n        tywx.AdManager.adNodeList.push(_adnode);\n\n    },\n\n    //创建导流banner, 每调用一次就会创建一个\n    showBanner: function (position, tag) {\n\n        var _adnode = new tywx.AdManager.adNodeClass();\n        _adnode.adInfoList = JSON.parse(JSON.stringify(tywx.AdManager.allBannerInfoList));\n        _adnode.adType = 2;\n        _adnode.adTag = tag || '';\n\n        if (position == undefined) {\n            position = {\n                x: 0,\n                y: 0\n            };\n        }\n        _adnode.createAdNode(position);\n\n        tywx.AdManager.bannerNodeList.push(_adnode);\n\n    },\n\n    //创建导流newicon, 每调用一次就会创建一个\n    showNewAd: function (position, pointName, tag) {\n\n        var _adnode = new tywx.AdManager.adNodeClass();\n\n        if (pointName == undefined) {\n            return;\n        } else {\n\n            if (typeof pointName != 'string' || tywx.AdManager.allNewAdInfoDict[pointName] == undefined) {\n                console.error('This PointName Does Not Exist!Please Check!');\n                return;\n            } else {\n                _adnode.adInfoList = JSON.parse(JSON.stringify(tywx.AdManager.allNewAdInfoDict[pointName]));\n                tywx.AdManager.newAdPointInfoList = _adnode.adInfoList;\n            }\n\n        }\n        _adnode.adType = 3;\n        _adnode.adTag = tag || '';\n\n        if (position == undefined) {\n            position = {\n                x: 0,\n                y: 0\n            };\n        }\n        _adnode.createAdNode(position);\n\n        tywx.AdManager.newAdNodeList.push(_adnode);\n    },\n\n    //获取所有导流icon节点的列表\n    getAdNodeList: function () {\n        return this.adNodeList;\n    },\n\n    //根据自定义的tag, 获取添加到界面上的导流icon节点\n    getAdNodeByTag: function (tag) {\n\n        if (!tag) return null;\n        for (var n in this.adNodeList) {\n            if (this.adNodeList[n].adTag.toString() == tag.toString()) {\n                return this.adNodeList[n];\n            }\n\n        }\n        return null;\n    },\n\n    //获取所有导流banner节点的列表\n    getBannerNodeList: function () {\n        return this.bannerNodeList;\n    },\n\n    //根据自定义的tag, 获取添加导界面上的导流banner节点\n    getBannerNodeByTag: function (tag) {\n\n        if (!tag) return null;\n        for (var n in this.bannerNodeList) {\n            if (this.bannerNodeList[n].adTag.toString() == tag.toString()) {\n                return this.bannerNodeList[n];\n            }\n\n        }\n        return null;\n    },\n\n    //获取所有导流newAd节点的列表\n    getNewAdNodeList: function () {\n        return this.newAdNodeList;\n    },\n\n    //根据自定义的tag, 获取添加导界面上的导流newAd节点\n    getNewAdNodeByTag: function (tag) {\n\n        if (!tag) return null;\n        for (var n in this.newAdNodeList) {\n            if (this.newAdNodeList[n].adTag.toString() == tag.toString()) {\n                return this.newAdNodeList[n];\n            }\n\n        }\n        return null;\n    },\n\n    //获取当前所有导流icon的信息\n    getAdInfoList: function () {\n        return this.allAdInfoList;\n    },\n\n    //获取当前所有导流banner的信息\n    getBannerInfoList: function () {\n        return this.allBannerInfoList;\n    },\n\n    //获取当前所有导流newAd的信息\n    getNewAdInfoDict: function () {\n        return this.allNewAdInfoDict;\n    },\n\n    adNodeClass: function () {\n        this.adType = 0; //1 icon   2 banner   3 newicon\n        this.adIconBtn = null;\n        this.currentAdInfo = null;\n        this.currentWebPage = null;\n        this.adInfoList = [];\n        this.adTag = '';\n    },\n\n    adNodeObj: {\n\n        createAdNode: function (pos) {\n\n            this.genRandomFirstAdInfo();\n\n            if (!this.currentAdInfo) {\n                return;\n            }\n\n            if (this.adIconBtn) {\n                this.adIconBtn.active = true;\n            } else {\n                var that = this;\n                //动态加载资源必须放在resources目录下,导流入口强制命名为adNode,放在resources/prefabs下\n                cc.loader.loadRes('prefabs/adNode', function (err, prefab) {\n                    var preFabNode = cc.instantiate(prefab);\n\n                    var _pos = pos ? pos : {\n                        x: 0,\n                        y: 0\n                    };\n                    preFabNode.position = cc.p(_pos.x, _pos.y);\n                    that.adIconBtn = preFabNode;\n                    cc.game.addPersistRootNode(preFabNode);\n                    that.adIconNode();\n                    var adButton = that.adIconBtn.getChildByName('adButton');\n                    adButton.on('click', function () {\n                        that.onClickAdIconBtn();\n                    });\n                });\n            }\n\n        },\n\n        genRandomFirstAdInfo: function () {\n\n            var that = this;\n\n            if (this.adInfoList.length == 0) {\n                return;\n            }\n\n            var weight_list = [{\n                'weight': 0,\n                'id': '000'\n            }];\n\n            for (var i in this.adInfoList) {\n\n                var _randomObj = {\n                    'weight': parseInt(that.adInfoList[i].icon_weight),\n                    'id': that.adInfoList[i].icon_id,\n                };\n                weight_list.push(_randomObj);\n            }\n\n            weight_list.sort(function (a, b) {\n                return a.weight > b.weight;\n            });\n\n            var _total = 0;\n\n            weight_list.forEach(function (element) {\n                _total += element.weight;\n            });\n\n            var _randomIndex = parseInt(Math.random() * 10000) % (_total + 1);\n\n            var _tTotal = 0;\n\n            var _selectIndex = 0;\n\n            for (var i = 0; i < (weight_list.length - 1); i++) {\n                _tTotal += weight_list[i].weight;\n                if (_tTotal < _randomIndex && (_tTotal + weight_list[i + 1].weight) >= _randomIndex) {\n                    _selectIndex = i + 1;\n                    break;\n                }\n            }\n            var _selectObj = weight_list[_selectIndex];\n\n            this.adInfoList.forEach(function (element) {\n                if (element.icon_id == _selectObj.id) {\n                    that.currentAdInfo = element;\n                }\n            });\n\n        },\n\n        genRandomSecondAdInfo: function () {\n\n            var that = this;\n\n            var _webPages = this.currentAdInfo.webpages;\n\n            if (typeof _webPages === 'undefined' || _webPages.length == 0) {\n                return;\n            }\n\n            var weight_list = [{\n                'weight': 0,\n                'id': '000'\n            }];\n\n            for (var i in _webPages) {\n\n                var _randomObj = {\n                    'weight': parseInt(_webPages[i].webpage_weight),\n                    'id': _webPages[i].config_id\n                }\n\n                weight_list.push(_randomObj);\n            }\n\n            weight_list.sort(function (a, b) {\n                return a.weight > b.weight;\n            });\n\n            var _total = 0;\n\n            weight_list.forEach(function (element) {\n                _total += element.weight;\n            });\n\n            var _randomIndex = parseInt(Math.random() * 10000) % (_total + 1);\n\n            var _tTotal = 0;\n\n            var _selectIndex = 0;\n            for (var i = 0; i < (weight_list.length - 1); i++) {\n                _tTotal += weight_list[i].weight;\n                if (_tTotal < _randomIndex && (_tTotal + weight_list[i + 1].weight) >= _randomIndex) {\n                    _selectIndex = i + 1;\n                    break;\n                }\n            }\n            var _selectObj = weight_list[_selectIndex];\n\n\n            _webPages.forEach(function (element) {\n                if (element.config_id == _selectObj.id) {\n                    that.currentWebPage = element;\n                }\n            });\n\n        },\n\n        adIconNode: function () {\n            if (!this.currentAdInfo || !this.adIconBtn) {\n                return;\n            }\n\n            var _animaType = this.currentAdInfo.icon_type;\n            var that = this;\n\n            var spriteIco = this.adIconBtn.getChildByName('adIcon');\n            var adButton = this.adIconBtn.getChildByName('adButton');\n\n            spriteIco.stopAllActions();\n            spriteIco.removeComponent(cc.Animation);\n\n            spriteIco.setRotation(0);\n\n            // tywx.BiLog.clickStat(tywx.clickStatEventType.clickStatEventTypeShowAdBtn, [that.currentAdInfo.icon_id,\n            //     '0',\n            //     '',\n            //     that.currentAdInfo.toappid,\n            //     that.currentAdInfo.togame,\n            //     '0',\n            //     that.adType]);\n            switch (_animaType) {\n\n                case tywx.AdManager.AnimType.STATIC:\n\n                    cc.loader.load({\n                        url: that.currentAdInfo.icon_url[0]\n                    }, function (err, texture) {\n                        if (!err) {\n\n                            spriteIco.getComponent(cc.Sprite).spriteFrame = new cc.SpriteFrame(texture);\n                            if (texture && texture.width && texture.height) {\n                                spriteIco.setContentSize(cc.size(texture.width, texture.height));\n                                adButton.setContentSize(cc.size(texture.width, texture.height));\n                            }\n                        } else {\n\n                        }\n                    });\n\n                    break;\n                case tywx.AdManager.AnimType.SHAKE:\n\n                    cc.loader.load({\n                        url: that.currentAdInfo.icon_url[0]\n                    }, function (error, texture) {\n\n                        spriteIco.getComponent(cc.Sprite).spriteFrame = new cc.SpriteFrame(texture);\n                        if (texture && texture.width && texture.height) {\n                            spriteIco.setContentSize(cc.size(texture.width, texture.height));\n                            adButton.setContentSize(cc.size(texture.width, texture.height));\n\n                        }\n                        spriteIco.anchorX = 0.5;\n                        spriteIco.anchorY = 0.5;\n                        var _act1 = cc.rotateBy(0.06, -20);\n                        var _act2 = cc.rotateBy(0.12, 40);\n                        var _act3 = cc.rotateBy(0.12, -40);\n                        var _act4 = cc.rotateBy(0.06, 20);\n                        var _delay = cc.delayTime(1);\n                        spriteIco.runAction(cc.repeatForever(cc.sequence(_act1,\n                            cc.repeat(cc.sequence(_act2, _act3), 2),\n                            _act4,\n                            _delay)));\n                    });\n\n\n                    break;\n                case tywx.AdManager.AnimType.FRAME:\n\n                    var allFrames = [];\n\n                    var playFrameAction = function () {\n                        spriteIco.stopAllActions();\n                        spriteIco.removeComponent(cc.Animation);\n                        var _firstFrameIcon = allFrames[0].getTexture();\n                        if (_firstFrameIcon && _firstFrameIcon.width && _firstFrameIcon.height) {\n                            spriteIco.setContentSize(cc.size(_firstFrameIcon.width, _firstFrameIcon.height));\n                            adButton.setContentSize(cc.size(_firstFrameIcon.width, _firstFrameIcon.height))\n                        }\n\n                        var _time_interval = that.currentAdInfo.time_interval;\n                        var _frameRate = (_time_interval && _time_interval > 0) ? 1000 / _time_interval : 10;\n\n                        var animation = spriteIco.addComponent(cc.Animation);\n                        var clip = cc.AnimationClip.createWithSpriteFrames(allFrames, _frameRate);\n                        clip.name = 'anim_frame';\n                        clip.wrapMode = cc.WrapMode.Loop;\n                        animation.addClip(clip);\n                        animation.play('anim_frame');\n                    };\n\n                    cc.loader.load(that.currentAdInfo.icon_url, function (err, results) {\n\n                        if (err) {\n                            for (var i = 0; i < err.length; i++) {\n                                cc.log('Error url [' + err[i] + ']: ' + results.getError(err[i]));\n                            }\n                        }\n\n                        for (var i = 0; i < that.currentAdInfo.icon_url.length; i++) {\n                            if (results.getContent(that.currentAdInfo.icon_url[i])) {\n                                var _frame = new cc.SpriteFrame(results.getContent(that.currentAdInfo.icon_url[i]));\n                                allFrames.push(_frame);\n                            }\n                        }\n\n                        playFrameAction();\n                    });\n\n                    break;\n                default:\n                    break;\n\n            }\n\n        },\n\n        onClickAdIconBtn: function () {\n\n            try {\n\n                this.genRandomSecondAdInfo();\n\n                //先尝试直接跳转\n                var skip_type = this.currentAdInfo.icon_skip_type;\n                var toappid = this.currentAdInfo.toappid;\n                var togame = this.currentAdInfo.togame;\n                var topath = this.currentAdInfo.path;\n                var second_toappid = this.currentAdInfo.second_toappid;\n\n                console.log('topath ====>' + topath);\n\n                var that = this;\n\n                var icon_id = this.currentAdInfo.icon_id;\n                var config_id = '0';\n                var webpage_url = '';\n                var webpage_id = '0';\n\n                if (this.currentWebPage && (1 == this.adType || 3 == this.adType)) {\n                    webpage_url = this.currentWebPage.webpage_url;\n                    config_id = this.currentWebPage.config_id;\n                    webpage_id = this.currentWebPage.webpage_id;\n                }\n\n                var bi_paramlist = [icon_id, config_id, webpage_url, toappid, togame, webpage_id, that.adType];\n\n                console.log('bi_paramlist ====> ' + JSON.stringify(bi_paramlist));\n\n                tywx.BiLog.clickStat(tywx.clickStatEventType.clickStatEventTypeClickAdBtn, bi_paramlist);\n\n\n                // //先尝试直接跳转\n                if (wx && wx.navigateToMiniProgram) {\n                    if (1 == skip_type) {\n\n                        wx.navigateToMiniProgram({\n                            appId: toappid,\n                            path: topath ? topath : '?from=adcross',\n                            envVersion: 'release',\n                            extraData: {\n                                from: topath ? topath : '?from=adcross',\n                            },\n                            success: function (res) {\n\n                                tywx.BiLog.clickStat(tywx.clickStatEventType.clickStatEventTypeClickDirectToMiniGameSuccess, bi_paramlist);\n\n                                console.log('wx.navigateToMiniProgram success');\n                                console.log(res);\n                            },\n                            fail: function (res) {\n                                tywx.BiLog.clickStat(tywx.clickStatEventType.clickStatEventTypeClickDirectToMiniGameFail, bi_paramlist);\n                                console.log('wx.navigateToMiniProgram fail');\n                                console.log(res);\n                            },\n                            complete: function (res) {\n                                console.log('navigateToMiniProgram ==== complete');\n                                that.resetBtnIcon();\n                            }\n                        });\n\n                        return;\n                    } else if (2 == skip_type) {\n                        wx.navigateToMiniProgram({\n                            appId: second_toappid,\n                            path: topath ? topath : '?from=adcross',\n                            envVersion: 'release',\n                            extraData: {\n                                from: topath ? topath : '?from=adcross',\n                            },\n                            success: function (res) {\n                                tywx.BiLog.clickStat(tywx.clickStatEventType.clickStatEventTypeClickDirectToMiniGameSuccess, bi_paramlist);\n                                console.log('wx.navigateToMiniProgram success');\n                                console.log(res);\n                            },\n                            fail: function (res) {\n                                tywx.BiLog.clickStat(tywx.clickStatEventType.clickStatEventTypeClickDirectToMiniGameFail, bi_paramlist);\n                                console.log('wx.navigateToMiniProgram fail');\n                                console.log(res);\n                            },\n                            complete: function (res) {\n                                that.resetBtnIcon();\n                                console.log('navigateToMiniProgram ==== complete');\n                            }\n                        });\n\n                    } else {\n                        console.error('Unsupported skip type! Please Check!');\n                    }\n\n                    return;\n                }\n\n                //直接跳转接口不好使，展示 小程序/小游戏 二维码图片\n\n                if (!that.currentWebPage || !that.currentWebPage.webpage_url) {\n                    that.resetBtnIcon();\n                    return;\n                }\n\n                tywx.BiLog.clickStat(tywx.clickStatEventType.clickStatEventTypeClickShowQRCode, bi_paramlist);\n\n                if (tywx.IsWechatPlatform()) {\n                    wx.previewImage({\n                        current: [that.currentWebPage.webpage_url],\n                        urls: [that.currentWebPage.webpage_url],\n                        success: function (res) {\n                            tywx.LOGD(null, \"预览图片成功！\");\n                        },\n                        fail: function (res) {\n                            tywx.LOGD(null, \"预览图片失败！\");\n                        },\n                        complete: function (res) {\n                            console.log('预览图片完成');\n                            that.resetBtnIcon();\n                        },\n                    });\n                }\n            } catch (err) {\n                console.log(\"error:\", \"tywx.AdManager.onClickAdIconBtn——\" + JSON.stringify(err));\n            }\n        },\n\n        resetBtnIcon: function () {\n\n            if (!this.adIconBtn) {\n                return;\n            } else {\n                this.genRandomFirstAdInfo();\n                this.adIconNode();\n            }\n\n        },\n\n        onForeGround: function () {\n            this.adIconNode();\n        },\n\n        showAdNode: function () {\n\n            if (this.adIconBtn) {\n                this.adIconBtn.active = true;\n            }\n        },\n\n        hideAdNode: function () {\n\n            if (this.adIconBtn) {\n                this.adIconBtn.active = false;\n            }\n        },\n\n    },\n\n    //定时刷新导流icon\n    freshAdIconByTime: function () {\n\n        tywx.AdManager.adNodeList.forEach(function (_adNode) {\n            _adNode && _adNode.resetBtnIcon && _adNode.resetBtnIcon();\n        });\n    },\n\n    //定时刷新导流banner\n    freshAdBannerByTime: function () {\n        tywx.AdManager.bannerNodeList.forEach(function (_adNode) {\n            _adNode && _adNode.resetBtnIcon && _adNode.resetBtnIcon();\n        });\n    },\n\n    //定时刷新导流newicon\n    freshNewAdIconByTime: function () {\n        tywx.AdManager.newAdNodeList.forEach(function (_adNode) {\n            _adNode && _adNode.resetBtnIcon && _adNode.resetBtnIcon();\n        });\n    },\n\n    //开始定时刷新导流icon\n    startFreshAdIcon: function () {\n\n        try {\n\n            //定时刷新icon\n            var icon_interval = 10; //默认是10s刷新一次\n\n            if (this.allAdInfoList && this.allAdInfoList.length && this.allAdInfoList.length > 0) {\n\n                for (var i = 0; i < this.allAdInfoList.length; i++) {\n                    var _icon_interval = this.allAdInfoList[i].icon_interval;\n                    if (_icon_interval) {\n                        icon_interval = parseInt(_icon_interval) > 0 ? parseInt(_icon_interval) : icon_interval;\n                        break;\n                    }\n                }\n            }\n            if (tywx.AdManager.iconTimer) {\n                clearInterval(tywx.AdManager.iconTimer);\n                tywx.AdManager.iconTimer = 0;\n            }\n            tywx.AdManager.iconTimer = setInterval(tywx.AdManager.freshAdIconByTime, icon_interval * 1000);\n\n            //定时刷新banner\n            var banner_interval = 10; //默认是10s刷新一次\n\n            if (this.allBannerInfoList && this.allBannerInfoList.length && this.allBannerInfoList.length > 0) {\n\n                for (var i = 0; i < this.allBannerInfoList.length; i++) {\n                    var _icon_interval = this.allBannerInfoList[i].icon_interval;\n                    if (_icon_interval) {\n                        banner_interval = parseInt(_icon_interval) > 0 ? parseInt(_icon_interval) : banner_interval;\n                        break;\n                    }\n                }\n            }\n            if (tywx.AdManager.bannerTimer) {\n                clearInterval(tywx.AdManager.bannerTimer);\n                tywx.AdManager.bannerTimer = 0;\n            }\n            tywx.AdManager.bannerTimer = setInterval(tywx.AdManager.freshAdBannerByTime, banner_interval * 1000);\n\n            //定时刷新newicon\n            var new_icon_interval = 10; //默认是10s刷新一次\n\n            if (this.newAdPointInfoList && this.newAdPointInfoList.length && this.newAdPointInfoList.length > 0) {\n\n                for (var i = 0; i < this.newAdPointInfoList.length; i++) {\n                    var _icon_interval = this.newAdPointInfoList[i].icon_interval;\n                    if (_icon_interval) {\n                        new_icon_interval = parseInt(_icon_interval) > 0 ? parseInt(_icon_interval) : new_icon_interval;\n                        break;\n                    }\n                }\n            }\n            if (tywx.AdManager.newIconTimer) {\n                clearInterval(tywx.AdManager.newIconTimer);\n                tywx.AdManager.newIconTimer = 0;\n            }\n            tywx.AdManager.newIconTimer = setInterval(tywx.AdManager.freshNewAdIconByTime, new_icon_interval * 1000);\n\n        } catch (e) {\n\n            console.error('Error: startFreshAdIcon==>' + JSON.stringify(e));\n        }\n\n    },\n\n    //从后台回到前台\n    onForeGround: function () {\n\n        this.freshAdIconByTime();\n        this.freshAdBannerByTime();\n        this.freshNewAdIconByTime();\n        this.startFreshAdIcon();\n    },\n\n    /**\n     * 计算签名字符串\n     * @param reqObj\n     * @returns {string}\n     */\n    getConfigSignStr: function (reqObj) {\n        var sortedKeys = Object.keys(reqObj).sort();\n        var signStr = '';\n        for (var i = 0; i < sortedKeys.length; i++) {\n            var key = sortedKeys[i];\n            if (key == 'act' || key == 'sign') {\n                continue;\n            } else {\n                signStr += key + '=' + reqObj[key];\n            }\n        }\n        var finalSign = tywx.hex_md5('market.tuyoo.com-api-' + signStr + '-market.tuyoo-api') || '';\n        return finalSign;\n    },\n\n    /**\n     * 请求交叉倒流的信息\n     */\n    requestADInfo: function () {\n        try {\n            if (!tywx.IsWechatPlatform()) {\n                return;\n            }\n            this.retryCrossTimes--;\n            var reqObj = {};\n            var timeStamp = new Date().getTime();\n            reqObj.act = 'api.getCrossConfig';\n            reqObj.time = timeStamp;\n            reqObj.game_mark = tywx.SystemInfo.cloudId + \"-\" + tywx.SystemInfo.gameId;\n            var signStr = this.getConfigSignStr(reqObj);\n            var paramStrList = [];\n            for (var key in reqObj) {\n                paramStrList.push(key + '=' + reqObj[key]);\n            }\n            paramStrList.push('sign=' + signStr);\n            var finalUrl = tywx.SystemInfo.shareManagerUrl + '?' + paramStrList.join('&');\n            var that = this;\n\n            wx.request({\n                url: finalUrl,\n                method: 'GET',\n                success: function (res) {\n                    if (res.statusCode == 200) {\n                        var ret = res.data;\n                        that.allAdInfoList = [];\n                        console.log(\"交叉倒流数据 = \" + JSON.stringify(ret.retmsg));\n                        if (ret.retmsg) {\n                            that.rawAdInfoList = ret.retmsg;\n                            that.processIconConfigInfo();\n                        }\n                        that.retryCrossTimes = 3;\n\n                    } else {\n                        if (that.retryCrossTimes > 0) {\n                            that.requestADInfo();\n                        } else {\n                            that.retryCrossTimes = 3;\n                        }\n                    }\n\n                },\n                fail: function (res) {\n\n                    if (that.retryCrossTimes > 0) {\n                        that.requestADInfo();\n                    } else {\n                        that.retryCrossTimes = 3;\n                    }\n                }\n            });\n        } catch (err) {\n            tywx.LOGE(\"error:\", \"tywx.AdManager.requestADInfo——\" + JSON.stringify(err));\n        }\n    },\n\n\n    /**\n     * 请求交叉倒流banner的信息\n     */\n    requestBannerInfo: function () {\n        try {\n            if (!tywx.IsWechatPlatform()) {\n                return;\n            }\n            this.retryBannerTimes--;\n            var reqObj = {};\n            var timeStamp = new Date().getTime();\n            reqObj.act = 'api.getBannerConfig';\n            reqObj.time = timeStamp;\n            reqObj.game_mark = tywx.SystemInfo.cloudId + \"-\" + tywx.SystemInfo.gameId;\n            var signStr = this.getConfigSignStr(reqObj);\n            var paramStrList = [];\n            for (var key in reqObj) {\n                paramStrList.push(key + '=' + reqObj[key]);\n            }\n            paramStrList.push('sign=' + signStr);\n            var finalUrl = tywx.SystemInfo.shareManagerUrl + '?' + paramStrList.join('&');\n            var that = this;\n            console.log(\"交叉倒流的数据地址  \" + finalUrl);\n            wx.request({\n                url: finalUrl,\n                method: 'GET',\n                success: function (res) {\n                    if (res.statusCode == 200) {\n\n                        var ret = res.data;\n                        that.allBannerInfoList = [];\n                        if (ret.retmsg) {\n                            that.rawBannerInfoList = ret.retmsg;\n                            that.processBannerConfigInfo();\n                        }\n                        that.retryBannerTimes = 3;\n\n                    } else {\n                        if (that.retryBannerTimes > 0) {\n                            that.requestBannerInfo();\n                        } else {\n                            that.retryBannerTimes = 3;\n                        }\n                    }\n\n                },\n                fail: function (res) {\n\n                    if (that.retryBannerTimes > 0) {\n                        that.requestBannerInfo();\n                    } else {\n                        that.retryBannerTimes = 3;\n                    }\n                }\n            });\n        } catch (err) {\n            tywx.LOGE(\"error:\", \"tywx.AdManager.requestADInfo——\" + JSON.stringify(err));\n        }\n    },\n\n    /**\n     * 请求交叉倒流newAd的信息\n     */\n    requestNewAdInfo: function () {\n        try {\n            if (!tywx.IsWechatPlatform()) {\n                return;\n            }\n            this.retryNewAdTimes--;\n            var reqObj = {};\n            var timeStamp = new Date().getTime();\n            reqObj.act = 'api.getCrossConfigNew';\n            reqObj.time = timeStamp;\n            reqObj.game_mark = tywx.SystemInfo.cloudId + \"-\" + tywx.SystemInfo.gameId;\n            var signStr = this.getConfigSignStr(reqObj);\n            var paramStrList = [];\n            for (var key in reqObj) {\n                paramStrList.push(key + '=' + reqObj[key]);\n            }\n            paramStrList.push('sign=' + signStr);\n            var finalUrl = tywx.SystemInfo.shareManagerUrl + '?' + paramStrList.join('&');\n            var that = this;\n\n            wx.request({\n                url: finalUrl,\n                method: 'GET',\n                success: function (res) {\n                    if (res.statusCode == 200) {\n\n                        var ret = res.data;\n                        that.allNewAdInfoDict = {};\n                        if (ret.retmsg) {\n                            that.rawNewAdInfoDict = ret.retmsg;\n                            that.processNewIconConfigInfo();\n                        }\n                        that.retryNewAdTimes = 3;\n\n                    } else {\n                        if (that.retryNewAdTimes > 0) {\n                            that.requestNewAdInfo();\n                        } else {\n                            that.retryNewAdTimes = 3;\n                        }\n                    }\n\n                },\n                fail: function (res) {\n\n                    if (that.retryNewAdTimes > 0) {\n                        that.requestNewAdInfo();\n                    } else {\n                        that.retryNewAdTimes = 3;\n                    }\n                }\n            });\n        } catch (err) {\n            tywx.LOGE(\"error:\", \"tywx.AdManager.requestADInfo——\" + JSON.stringify(err));\n        }\n    },\n\n    /**\n     * 处理服务端返回的信息（根据城市白名单等进行过滤筛选）\n     */\n    processRawConfigInfo: function () {\n        this.processIconConfigInfo();\n        this.processBannerConfigInfo();\n        this.processNewIconConfigInfo();\n    },\n\n    /**\n     * 处理返回的交叉导流的icon信息\n     */\n    processIconConfigInfo: function () {\n\n        var that = this;\n        this.allAdInfoList = [];\n\n        if (this.rawAdInfoList == undefined) {\n            return;\n        }\n        if (!tywx.UserInfo.userId) {\n            return;\n        }\n\n        this.rawAdInfoList.forEach(function (v) {\n\n            if (v.icon_weight == undefined || Math.floor(v.icon_weight) <= 0.1) {\n                v.icon_weight = 0;\n            }\n\n            var isTestMode = false; //是否是测试模式\n            var _test_uidList = v.push_uids || [];\n\n            for (var i = 0, len = _test_uidList.length; i < len; i++) {\n                if (tywx.UserInfo.userId.toString() == _test_uidList[i]) {\n                    isTestMode = true;\n                    break;\n                }\n            }\n\n            if (isTestMode) {\n                that.allAdInfoList.push(v);\n            } else {\n                var _white_rear_uidList = v.push_users || [];\n                var _len = _white_rear_uidList.length;\n                if (0 == _len) {\n                    that.allAdInfoList.push(v);\n                } else {\n                    for (var j = 0; j < _len; j++) {\n                        var _sUid = tywx.UserInfo.userId.toString();\n                        if (_sUid.charAt(_sUid.length - 1) == _white_rear_uidList[j]) {\n                            that.allAdInfoList.push(v);\n                            break;\n                        }\n                    }\n                }\n            }\n        });\n        tywx.NotificationCenter.trigger(tywx.EventType.GET_ADMANAGER_ICON_INFO_SUCCESS);\n    },\n\n    /**\n     * 处理返回的交叉导流的banner信息\n     */\n    processBannerConfigInfo: function () {\n\n        var that = this;\n        this.allBannerInfoList = [];\n\n        if (this.rawBannerInfoList == undefined) {\n            return;\n        }\n        if (!tywx.UserInfo.userId) {\n            return;\n        }\n\n        this.rawBannerInfoList.forEach(function (v) {\n\n            if (v.icon_weight == undefined || Math.floor(v.icon_weight) <= 0.1) {\n                v.icon_weight = 0;\n            }\n\n            var isTestMode = false; //是否是测试模式\n            var _test_uidList = v.push_uids || [];\n\n            for (var i = 0, len = _test_uidList.length; i < len; i++) {\n                if (tywx.UserInfo.userId.toString() == _test_uidList[i]) {\n                    isTestMode = true;\n                    break;\n                }\n            }\n\n            if (isTestMode) {\n                that.allBannerInfoList.push(v);\n            } else {\n                var _white_rear_uidList = v.push_users || [];\n                var _len = _white_rear_uidList.length;\n                if (0 == _len) {\n                    that.allBannerInfoList.push(v);\n                } else {\n                    for (var j = 0; j < _len; j++) {\n                        var _sUid = tywx.UserInfo.userId.toString();\n                        if (_sUid.charAt(_sUid.length - 1) == _white_rear_uidList[j]) {\n                            that.allBannerInfoList.push(v);\n                            break;\n                        }\n                    }\n                }\n            }\n        });\n        tywx.NotificationCenter.trigger(tywx.EventType.GET_ADMANAGER_BANNER_INFO_SUCCESS);\n    },\n\n    /**\n     * 请求本地的IP、地域等信息\n     */\n    requestLocalIPInfo: function () {\n        var that = this;\n        var _url = 'https://iploc.ywdier.com/api/iploc5/search/city';\n        wx.request({\n            url: _url,\n            success: function (res) {\n                if (res.statusCode == 200) {\n                    if (res.data && res.data.loc) {\n                        that.ipLocInfo = res.data;\n                        // ! Modify by luning [30-09-2018] 非框架，项目需要敏感ip判断\n                        tywx.tt.isMinGanIP = tywx.tt.Utils.isMinGanIp(that.ipLocInfo);\n                        tywx.NotificationCenter.trigger(tywx.tt.events.TT_EVENT_GET_IP_SUCCESS, null);\n                    }\n\n                    that.processRawConfigInfo();\n                }\n\n                console.log('requestLocalIPInfo ==>' + JSON.stringify(res));\n            },\n            fail: function (res) {}\n        });\n\n    },\n\n    /**\n     * 处理返回的交叉导流的newIcon信息\n     */\n    processNewIconConfigInfo: function () {\n\n        var that = this;\n        this.allNewAdInfoDict = {};\n\n        if (this.rawNewAdInfoDict == undefined) {\n            return;\n        }\n        if (!tywx.UserInfo.userId) {\n            return;\n        }\n\n        var newAdPoints = Object.keys(this.rawNewAdInfoDict);\n        for (var i = 0, len = newAdPoints.length; i < len; i++) {\n\n            var newAdPointList = this.rawNewAdInfoDict[newAdPoints[i]];\n\n            that.allNewAdInfoDict[newAdPoints[i]] = [];\n\n            if (0 < newAdPointList.length) {\n                newAdPointList.forEach(function (v) {\n\n                    if (v.icon_weight == undefined || Math.floor(v.icon_weight) <= 0.1) {\n                        v.icon_weight = 0;\n                    }\n\n                    var isTestMode = false; //是否是测试模式\n                    var _test_uidList = v.push_uids || [];\n\n                    for (var j in _test_uidList) {\n                        if (tywx.UserInfo.userId.toString() == _test_uidList[j]) {\n                            isTestMode = true;\n                            break;\n                        }\n                    }\n\n                    if (isTestMode) {\n                        that.allNewAdInfoDict[newAdPoints[i]].push(v);\n                    } else {\n                        var _white_rear_uidList = v.push_users || [];\n                        var _len = _white_rear_uidList.length;\n                        if (0 == _len) {\n                            that.allNewAdInfoDict[newAdPoints[i]].push(v);\n                        } else {\n                            for (var j = 0; j < _len; j++) {\n                                var _sUid = tywx.UserInfo.userId.toString();\n                                if (_sUid.charAt(_sUid.length - 1) == _white_rear_uidList[j]) {\n                                    that.allNewAdInfoDict[newAdPoints[i]].push(v);\n                                    break;\n                                }\n                            }\n                        }\n                    }\n                })\n            }\n        }\n        tywx.NotificationCenter.trigger(tywx.EventType.GET_ADMANAGER_NEWICON_INFO_SUCCESS);\n    },\n\n    /**\n     * 初始化交叉导流模块\n     */\n    init: function () {\n        console.log(\"ONSHOWINIT\");\n        this.requestLocalIPInfo();\n        this.requestADInfo();\n        this.requestBannerInfo();\n        this.requestNewAdInfo();\n    },\n\n};\n\ntywx.AdManager.adNodeClass.prototype = tywx.AdManager.adNodeObj;"]}