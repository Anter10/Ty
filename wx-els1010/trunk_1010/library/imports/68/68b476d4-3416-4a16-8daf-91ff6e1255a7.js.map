{"version":3,"sources":["../../../../../../assets/scripts/game/view/assets/scripts/game/view/tt_scene_menu.js"],"names":["TAG","cc","Class","extends","Component","properties","gqnumberLabel","Label","zpbtnNode","Node","bannerNode","btnGetMoney","onLoad","tywx","tt","Utils","sendWXMsg","method","MAIN_MENU_NUM","constants","TT_SCORE","boot","PropagateInterface","getShareConfigInfo","string","parseInt","loadItem","NotificationCenter","listen","events","TT_EVENT_RED_PACKET_CHANGE","onRedPacktChange","TT_EVENT_GET_IP_SUCCESS","getIPSuccess","self","Timer","setTimer","lottery","addZPIcon","v2","ads","addAdsNode","isMinGanIP","isMinGanIp","AdManager","ipLocInfo","loginSuccess","TT_GET_CONFIG_SUCCESS","dealConfig","res","log","JSON","stringify","data","totalAmount","max","formatCashFen2Yuan","getComponent","init","UserInfo","userId","requestRedPacket","success","configManager","getInstance","auditing","current","active","fail","isFirstLogin","onDestroy","hideGameClub","destroyWXBanner","ignoreScope","startGame","e","director","loadScene","showPhb","rank_manager","showRank","start"],"mappings":"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","file":"tt_scene_menu.js","sourceRoot":"../../../../../../assets/scripts/game/view","sourcesContent":["let TAG = \"[view/tt_scene_menu]\";\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        gqnumberLabel: cc.Label,\n        zpbtnNode: cc.Node,\n        bannerNode: cc.Node,\n        btnGetMoney: cc.Node,\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad() {\n        tywx.tt.Utils.sendWXMsg({\n            method: \"load_data\",\n            MAIN_MENU_NUM: tywx.tt.constants.TT_SCORE,\n        })\n        tywx.tt.boot();\n        tywx.PropagateInterface.getShareConfigInfo(); //! 获取所有分享点信息\n        // 当前最大分数\n        this.gqnumberLabel.string = parseInt(tywx.tt.Utils.loadItem(tywx.tt.constants.TT_SCORE, 0)) + \"\";\n        tywx.NotificationCenter.listen(tywx.tt.events.TT_EVENT_RED_PACKET_CHANGE, this.onRedPacktChange, this);\n        tywx.NotificationCenter.listen(tywx.tt.events.TT_EVENT_GET_IP_SUCCESS, this.getIPSuccess, this);\n        var self = this;\n        tywx.Timer.setTimer(this, function () {\n            tywx.tt.lottery.addZPIcon(\"home\", self.zpbtnNode, cc.v2(0, 0));\n            tywx.tt.ads.addAdsNode(\"banner_menu\", self.bannerNode, cc.v2(0, 0));\n            tywx.tt.isMinGanIP = tywx.tt.Utils.isMinGanIp(tywx.AdManager.ipLocInfo);\n            // console.log(\"是否为敏感IP = \" + JSON.stringify(tywx.tt.configManager.getInstance().share_control));\n            self.loginSuccess();\n        }, 1, 0, 1);\n\n        tywx.NotificationCenter.listen(tywx.tt.events.TT_GET_CONFIG_SUCCESS, this.dealConfig, this);\n\n    },\n\n    dealConfig:function(){\n          \n    },\n\n    /**\n     * @param {Object} res 得到IP的回调\n     */\n    getIPSuccess: function (res) {\n        tywx.tt.log(TAG ,\"IP信息 = \" + JSON.stringify(res));\n    },\n\n    /**\n     * @description 红包更改的时候回调\n     */\n    onRedPacktChange: function (res) {\n        if (res.data && res.data.totalAmount) {\n            let data = {}\n            data.max = tywx.tt.Utils.formatCashFen2Yuan(res.data.totalAmount);\n            this.btnGetMoney.getComponent('GetMoneyButton').init(data);\n        } else {\n            tywx.tt.log(TAG, \"通知事件中的红包数据 = \" + JSON.stringify(res));\n        }\n    },\n\n    /**\n     * @description 延迟加载初始化某些数据\n     */\n    loginSuccess() {\n        // ! 显示红包\n        let self = this;\n       tywx.tt.log(TAG, \"tywx.UserInfo.userId = \" + tywx.UserInfo.userId);\n        // if (tywx.UserInfo.userId === 0 || tywx.config.auditing === true) return;\n        tywx.tt.Utils.requestRedPacket({\n            success: (res) => {\n                tywx.tt.log(TAG, \"审核状态 = \"+tywx.tt.configManager.getInstance().auditing  + \"玩家红包数据= \" + JSON.stringify(res));\n                if (res.current && tywx.tt.configManager.getInstance().auditing == false) {\n                    self.btnGetMoney.active = true;\n                    self.btnGetMoney.getComponent('GetMoneyButton').init(res);\n                } else {\n                    self.btnGetMoney.active = false;\n                }\n            },\n            fail: (res) => {\n                self.btnGetMoney.active = false;\n            }\n        });\n        // ! 登陆游戏后第一次进入菜单特殊处理\n        if (tywx.tt.isFirstLogin) {\n\n        }\n    },\n\n\n    onDestroy() {\n        tywx.tt.Utils.hideGameClub();\n        tywx.tt.Utils.destroyWXBanner();\n        tywx.NotificationCenter.ignoreScope(this);\n    },\n\n    /**\n     * @description 点击开始游戏的时候调用\n     * @param {Object} e 回调的对象\n     */\n    startGame: function (e) {\n        cc.director.loadScene(\"scene_play\");\n    },\n\n    /**\n     * @description 显示排行榜\n     */\n    showPhb: function () {\n        tywx.tt.rank_manager.showRank();\n    },\n\n    start() {\n\n    },\n\n    // update (dt) {},\n});"]}