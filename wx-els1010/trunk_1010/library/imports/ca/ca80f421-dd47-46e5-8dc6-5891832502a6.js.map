{"version":3,"sources":["../../../../../../assets/scripts/game/gameover/assets/scripts/game/gameover/gameover_rank.js"],"names":["friend_path","self","gameover_rank","cc","Class","extends","Component","properties","phbSprite","Sprite","onLoad","tex","Texture2D","window","sharedCanvas","width","height","updatetime","score","tywx","tt","Utils","sendWXMsg","method","wx","postMessage","Timer","setTimer","updateFriendCanvas","openDataContext","getOpenDataContext","canvas","initWithElement","handleLoadedTexture","spriteFrame","SpriteFrame","node","active","setScoreFlush","start","statics","gamoverranknode","gameover_rank_script","addIcon","loader","loadRes","err","prefab","instantiate","getComponent","addChild","module","exports"],"mappings":";;;;;;AAAC,IAAIA,cAAc,uBAAlB;AACA,IAAIC,OAAO,IAAX;;AAEA,IAAMC,gBAAgBC,GAAGC,KAAH,CAAS;AAC3BC,aAASF,GAAGG,SADe;;AAG3BC,gBAAY;AACRC,mBAAWL,GAAGM;;AADN,KAHe;;AAQ3B;;AAEAC,UAV2B,oBAUlB;AACL,aAAKC,GAAL,GAAW,IAAIR,GAAGS,SAAP,EAAX;AACAC,eAAOC,YAAP,CAAoBC,KAApB,GAA4B,GAA5B;AACAF,eAAOC,YAAP,CAAoBE,MAApB,GAA6B,GAA7B;AACA,aAAKC,UAAL,GAAkB,CAAlB;AACA,aAAKC,KAAL,GAAa,CAAb;AACAjB,eAAO,IAAP;AACAkB,aAAKC,EAAL,CAAQC,KAAR,CAAcC,SAAd,CAAwB;AACpBC,oBAAQ;AADY,SAAxB;AAGAJ,aAAKC,EAAL,CAAQC,KAAR,CAAcC,SAAd,CAAwB;AACpBC,oBAAQ;AADY,SAAxB;AAGAC,WAAGC,WAAH,CAAe;AACXF,oBAAQ;AADG,SAAf;;AAIAJ,aAAKO,KAAL,CAAWC,QAAX,CAAoB1B,IAApB,EAA0B,YAAY;AAClC,iBAAK2B,kBAAL;AACH,SAFD,EAEG,GAFH,EAEQ,CAFR,EAEW,CAFX;AAIH,KA/B0B;;;AAiC3B;;;AAGAA,wBAAoB,8BAAY;AAC5B;AACA,YAAI,CAAC,KAAKjB,GAAN,IAAa,CAACa,EAAlB,EAAsB;AAClB;AACH;;AAED,YAAIK,kBAAkBL,GAAGM,kBAAH,EAAtB;AACA,YAAIhB,eAAee,gBAAgBE,MAAnC;AACA,aAAKpB,GAAL,CAASqB,eAAT,CAAyBlB,YAAzB;AACA,aAAKH,GAAL,CAASsB,mBAAT;AACA,aAAKzB,SAAL,CAAe0B,WAAf,GAA6B,IAAI/B,GAAGgC,WAAP,CAAmB,KAAKxB,GAAxB,CAA7B;AACA,aAAKH,SAAL,CAAe4B,IAAf,CAAoBC,MAApB,GAA6B,IAA7B;AAEH,KAjD0B;;AAmD3B;;;;AAIAC,mBAAe,uBAAUpB,KAAV,EAAiB;AAC5B,aAAKA,KAAL,GAAaA,SAAS,CAAtB;AACA,aAAKU,kBAAL;AACH,KA1D0B;;AA6D3BW,SA7D2B,mBA6DnB,CAEP,CA/D0B;;;AAiE3B;AACA;AACA;AACA;AACA;AACA;;AAEAC,aAAS;AACLC,yBAAiB,IADZ;AAELC,8BAAsB,IAFjB;AAGLC,iBAAS,iBAAUP,IAAV,EAAgB;AACrBjC,eAAGyC,MAAH,CAAUC,OAAV,CAAkB7C,WAAlB,EAA+B,UAAC8C,GAAD,EAAMC,MAAN,EAAiB;AAC5C,oBAAI,CAACD,GAAL,EAAU;AACN,wBAAIL,kBAAkBtC,GAAG6C,WAAH,CAAeD,MAAf,CAAtB;AACA,wBAAIL,uBAAuBD,gBAAgBQ,YAAhB,CAA6B,eAA7B,CAA3B;AACA/C,kCAAcwC,oBAAd,GAAqCA,oBAArC;AACAxC,kCAAcuC,eAAd,GAAgCA,eAAhC;AACAL,yBAAKc,QAAL,CAAcT,eAAd;AACH;AACJ,aARD;AASH;AAbI;AAxEkB,CAAT,CAAtB;;AAyFAU,OAAOC,OAAP,GAAiBlD,aAAjB","file":"gameover_rank.js","sourceRoot":"../../../../../../assets/scripts/game/gameover","sourcesContent":[" let friend_path = \"prefabs/gameover_rank\";\n var self = null;\n\n const gameover_rank = cc.Class({\n     extends: cc.Component,\n\n     properties: {\n         phbSprite: cc.Sprite,\n        \n     },\n\n     // LIFE-CYCLE CALLBACKS:\n\n     onLoad() {\n         this.tex = new cc.Texture2D();\n         window.sharedCanvas.width = 640;\n         window.sharedCanvas.height = 200;\n         this.updatetime = 5;\n         this.score = 0;\n         self = this;\n         tywx.tt.Utils.sendWXMsg({\n             method: 7,\n         });\n         tywx.tt.Utils.sendWXMsg({\n             method: 9,\n         });\n         wx.postMessage({\n             method: 8,\n         });\n\n         tywx.Timer.setTimer(self, function () {\n             this.updateFriendCanvas();\n         }, 0.5, 0, 0);\n\n     },\n\n     /**\n      * @description: 刷新子域即将超越的玩家Canvas\n      */\n     updateFriendCanvas: function () {\n         //return;\n         if (!this.tex || !wx) {\n             return;\n         }\n\n         var openDataContext = wx.getOpenDataContext();\n         var sharedCanvas = openDataContext.canvas;\n         this.tex.initWithElement(sharedCanvas);\n         this.tex.handleLoadedTexture();\n         this.phbSprite.spriteFrame = new cc.SpriteFrame(this.tex);\n         this.phbSprite.node.active = true;\n\n     },\n\n     /**\n      * 设置当前玩家的分数 \n      * @param {Number} score 设置当前玩家的分数刷新当前显示的好友分数\n      */\n     setScoreFlush: function (score) {\n         this.score = score || 0;\n         this.updateFriendCanvas();\n     },\n\n\n     start() {\n\n     },\n\n     //  update(dt) {\n     //      this.updatetime = this.updatetime - dt;\n     //      if (this.updatetime > 0) {\n     //          this.updateFriendCanvas();\n     //      }\n     //  },\n\n     statics: {\n         gamoverranknode: null,\n         gameover_rank_script: null,\n         addIcon: function (node) {\n             cc.loader.loadRes(friend_path, (err, prefab) => {\n                 if (!err) {\n                     let gamoverranknode = cc.instantiate(prefab);\n                     let gameover_rank_script = gamoverranknode.getComponent('gameover_rank');\n                     gameover_rank.gameover_rank_script = gameover_rank_script;\n                     gameover_rank.gamoverranknode = gamoverranknode;\n                     node.addChild(gamoverranknode);\n                 }\n             });\n         }\n     }\n });\n\n module.exports = gameover_rank;"]}