{"version":3,"sources":["TuyooSDK.js"],"names":["tywx","LOGE","TuyooSDK","SESSION_KEY","login","IsWechatPlatform","getSystemInfo","wechatLogin","PropagateInterface","_doHttpGetShareConfig","BiLog","clickStat","clickStatEventType","clickStatEventTypeWxLoginStart","wx","success","params","LOGD","JSON","stringify","clickStatEventTypeWxLoginSuccess","code","loginTuyooWithCode","NotificationCenter","trigger","EventType","WEIXIN_LOGIN_SUCCESS","fail","clickStatEventTypeWxLoginFailed","WEIXIN_LOGIN_FAIL","complete","err","loginTuyooWith3rdSession","getStorage","key","data","request","url","SystemInfo","loginUrl","snsId","deviceName","clientId","appId","userInfo","showShareMenu","withShareTicket","gender","local_uuid","Util","getLocalUUID","sdkPath","dataObj","wxAppId","uuid","scene_id","UserInfo","scene_param","invite_id","nickName","avatarUrl","clickStatEventTypeLoginSDKStart","header","method","console","log","checkData","error","result","userId","setTimeout","userName","userPic","purl","authorCode","wxgame_session_key","token","setStorage","clickStatEventTypeLoginSDKSuccess","showScene","showQuery","sourceCode","clickStatEventTypeUserFrom","inviteCode","imageType","initWebSocketUrl","SDK_LOGIN_SUCCESS","clickStatEventTypeLoginSDKFailed","SDK_LOGIN_FAIL","loginResult","tcpsrv","ip","port","wsport","webSocketUrl","indexOf","toString","model","isiPhone","windowHeight","resultType","systemType","wechatType","version","system","sdkVersion","SDKVersion","clickStatEventTypeSubmitVersionInfo","platform","wechatAuthorize","getSetting","res","authSetting","clickStatEventTypeAuthorizationStart","authorize","scope","clickStatEventTypeAuthorizationSuccess","START_AUTHORIZATION_SUCCESS","clickStatEventTypeAuthorizationFailed","START_AUTHORIZATION_FAILED","createOrder","id","prodPrice","name","prodCount","extraProdId","extraAppInfo","prodId","chargeType","gameId","prodName","appInfo","rechargeOrder","orderCallFunc","platformOrderId","chargeCoin","_chargeCoin","imei","results","tips","reqUrl","hall_version","mustcharge","prodOrderId","chargeInfo","chargeData","notifyUrl","requestMidasPayment","mode","env","offerId","buyQuantity","chargeTotal","currencyType","zoneId","errCode","cancelOrder","orderId","sendUrl","postData","payType","WechatInterfaceInit","onShow","scene","query","scenePath","from","StateInfo","isOnForeground","GAME_SHOW","hasUUID","checkLocalUUID","oldUserFlag","gdt_vid","weixinadinfo","isSceneQrCode","hasOwnProperty","path","replace","decodeURIComponent","clickStatEventTypeOnShowTimeStampSubmit","AdManager","onForeGround","ado","onHide","clickStatEventTypeOnHideTimeStampSubmit","GAME_HIDE","TCPClient","close","getNetSuccess","networkConnected","isConnected","errMsg","networkType","getNetworkType","onNetworkStatusChange","onError","d","Date","Utils","uploadErrorMsg","message","onAudioInterruptionEnd"],"mappings":"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","file":"TuyooSDK.js","sourceRoot":"../../../../../assets/Script/CommonFrame","sourcesContent":["/**\n * @author zhaoliang\n * @date 1.28\n * \n * 全局对象\n * 系统信息\n * 包括clientId，loginUrl等\n */\ntywx.LOGE(\"TuyooSDK loaded\");\ntywx.TuyooSDK = {\n    SESSION_KEY: 'TU_SESSION_STORAGE',\n\n    /***************************以下为登录相关接口*********************************/\n    login: function() {\n        if(tywx.IsWechatPlatform()) {\n            tywx.TuyooSDK.getSystemInfo();\n            tywx.TuyooSDK.wechatLogin();\n            tywx.PropagateInterface._doHttpGetShareConfig();\n        }\n        else {\n            //其他平台,待添加\n        }\n    },\n\n    // 微信登录\n    wechatLogin: function() {\n        try {\n            if(!tywx.IsWechatPlatform()) {\n                return;\n            }\n\n            tywx.BiLog.clickStat(tywx.clickStatEventType.clickStatEventTypeWxLoginStart, []);\n            wx.login({\n                success: function(params) {\n                    tywx.LOGD(null, 'wx login success, params:' + JSON.stringify(params));\n                    tywx.BiLog.clickStat(tywx.clickStatEventType.clickStatEventTypeWxLoginSuccess, [params.code]);\n                    if (params.code) {\n                        var code = params.code;\n                        tywx.TuyooSDK.loginTuyooWithCode(code, {});\n                        tywx.NotificationCenter.trigger(tywx.EventType.WEIXIN_LOGIN_SUCCESS);\n                    }\n                },\n\n                fail: function(params) {\n                    tywx.BiLog.clickStat(tywx.clickStatEventType.clickStatEventTypeWxLoginFailed, []);\n                    tywx.LOGD(null, 'wx login fail, params:' + JSON.stringify(params));\n                    tywx.NotificationCenter.trigger(tywx.EventType.WEIXIN_LOGIN_FAIL);\n                },\n\n                complete: function(params) {\n\n                }\n            });\n        }\n        catch(err) {\n            tywx.LOGE(\"error:\", \"tywx.TuyooSDK.wechatLogin——\" + JSON.stringify(err));\n        }\n    },\n\n    // 微信不需要重新授权，使用\n    loginTuyooWith3rdSession: function() {\n        try {\n            if(!tywx.IsWechatPlatform()) {\n                return;\n            }\n            wx.getStorage({\n                key: tywx.TuyooSDK.SESSION_KEY,\n                success: function(params) {\n                    if (!params.data) {\n                        tywx.TuyooSDK.wechatLogin();\n                        return;\n                    }\n                    // 微信授权成功后使用code登录途游服务器\n                    wx.request({\n                        url: tywx.SystemInfo.loginUrl + 'open/v3/user/processSnsIdNew',\n                        data: {\n                            snsId: params.data,\n                            deviceName: 'wechatGame',\n                            clientId: tywx.SystemInfo.clientId,\n                            appId: tywx.SystemInfo.appId\n                        },\n\n                        success: function(params) {\n                            tywx.LOGD(null, 'tuyoo login success, params:' + JSON.stringify(params));\n                        },\n\n                        fail: function(params) {\n                            tywx.LOGD(null, 'tuyoo login fail, params:' + JSON.stringify(params));\n                        },\n\n                        complete: function(params) {\n\n                        }\n                    });\n                },\n                fail: function(params) {\n                    tywx.TuyooSDK.wechatLogin();\n                },\n                complete:function(params) {\n\n                }\n            });\n        }\n        catch(err) {\n            tywx.LOGE(\"error:\", \"tywx.TuyooSDK.loginTuyooWith3rdSession——\" + JSON.stringify(err));\n        }\n    },\n\n    // 微信授权成功后，使用\n    /* {\n        \"data\": {\n            \"result\": {\n                \"code\": 0,\n                \"userId\": 10116,\n                \"exception_report\": 0,\n                \"userType\": 4,\n                \"authInfo\": \"{\\\"authcode\\\": \\\"eyJ1aWQiOiAxMDExNiwgInVuYW1lIjogIlx1Njc2NVx1NWJiZTAwNzRBaWJzVCIsICJ1dG9rZW4iOiAiMjAxOC0wMS0yOSAxNDoxMzoxMi40NzEzMzgiLCAiY29pbiI6IDAsICJlbWFpbCI6ICIiLCAidXRpbWUiOiAiMjAxOC0wMS0yOSAxNDoxMzoxMi40NzA0NzEifQ==\\\", \\\"account\\\": \\\"\\\", \\\"uid\\\": 10116, \\\"usercode\\\": \\\"\\\"}\",\n                \"tcpsrv\": {\n                    \"ip\": \"192.168.10.88\",\n                    \"port\": 8041\n                },\n                \"isCreate\": 1,\n                \"changePwdCount\": 0,\n                \"360.vip\": 0,\n                \"logclient\": {\n                    \"loguploadurl\": \"\",\n                    \"logreporturl\": \"\"\n                },\n                \"userPwd\": \"ty817142\",\n                \"purl\": \"http://ddz.image.tuyoo.com/avatar/head_female_0.png\",\n                \"snsId\": \"wxapp:071Nehqt0Z4XEe1jN6qt007Cqt0Nehqz\",\n                \"userEmail\": \"\",\n                \"connectTimeOut\": 35,\n                \"appId\": 9999,\n                \"heartBeat\": 6,\n                \"userName\": \"来宾0074AibsT\",\n                \"mobile\": \"\",\n                \"token\": \"cce362d6-68a8-485e-b137-86ae6828e07a\",\n                \"authorCode\": \"eyJ1aWQiOiAxMDExNiwgInVuYW1lIjogIlx1Njc2NVx1NWJiZTAwNzRBaWJzVCIsICJ1dG9rZW4iOiAiMjAxOC0wMS0yOSAxNDoxMzoxMi40NzEzMzgiLCAiY29pbiI6IDAsICJlbWFpbCI6ICIiLCAidXRpbWUiOiAiMjAxOC0wMS0yOSAxNDoxMzoxMi40NzA0NzEifQ==\",\n                \"log_report\": 0,\n                \"showAd\": 1\n            }\n        },\n        \"header\": {\n            \"Server\": \"nginx/1.4.1\",\n            \"Date\": \"Mon, 29 Jan 2018 06:13:12 GMT\",\n            \"Content-Type\": \"application/json;charset=UTF-8\",\n            \"Transfer-Encoding\": \"chunked\",\n            \"Connection\": \"keep-alive\",\n            \"Content-Encoding\": \"gzip\"\n        },\n        \"statusCode\": 200,\n        \"errMsg\": \"request:ok\"\n    }\n    */\n    loginTuyooWithCode: function(code, userInfo) {\n        try {\n            if (!tywx.IsWechatPlatform()) {\n                return;\n            }\n            // 微信授权成功后使用code登录途游服务器\n            wx.showShareMenu({\n                withShareTicket: true\n            });\n\n\n            //咱们后端 0 是男 1 是女,要转换\n            var gender = userInfo.gender || 0;\n\n            var local_uuid = tywx.Util.getLocalUUID();\n            tywx.LOGD(\"local_uuid:\", local_uuid);\n            var sdkPath = tywx.SystemInfo.loginUrl;\n            var dataObj = {\n                appId: tywx.SystemInfo.appId,\n                wxAppId: tywx.SystemInfo.wxAppId,\n                clientId: tywx.SystemInfo.clientId,\n                snsId: 'wxapp:' + code,\n                uuid: local_uuid,\n                //以下为上传玩家的微信用户信息\n                //nickName: userInfo.nickName,\n                //avatarUrl: userInfo.avatarUrl,\n                gender: gender,\n                scene_id: tywx.UserInfo.scene_id || \"\",\n                scene_param: tywx.UserInfo.scene_param || \"\",\n                invite_id: tywx.UserInfo.invite_id || 0\n            };\n            if (userInfo && userInfo.nickName) {\n                dataObj.nickName = userInfo.nickName;\n            }\n\n            if (userInfo && userInfo.avatarUrl) {\n                dataObj.avatarUrl = userInfo.avatarUrl;\n            }\n            tywx.BiLog.clickStat(tywx.clickStatEventType.clickStatEventTypeLoginSDKStart, [code, local_uuid, userInfo.nickName]);\n            wx.request({\n                url: sdkPath + 'open/v6/user/LoginBySnsIdNoVerify',\n                header: {\n                    'content-type': 'application/x-www-form-urlencoded'\n                },\n                data: dataObj,\n                method: 'POST',\n\n                success: function (params) {\n                    //tywx.LOGE('tuyoo login success, params:' + JSON.stringify(params));\n                    console.log('tuyoo login success, params:' + JSON.stringify(params));\n                    var checkData = params.data;\n                    if ((checkData.error && checkData.error.code == 1) || !(checkData.result && checkData.result.userId)) {\n                        // tywx.LOGE('tuyoo login fail...');\n                        setTimeout(tywx.TuyooSDK.login, 200);\n                        return;\n                    }\n\n                    // 保存用户名/用户ID/用户头像\n                    var result = checkData.result;\n                    tywx.UserInfo.userId = result.userId;\n                    tywx.UserInfo.userName = result.userName;\n                    tywx.UserInfo.userPic = result.purl;\n                    tywx.UserInfo.authorCode = result.authorCode;\n                    tywx.UserInfo.wxgame_session_key = result.wxgame_session_key;\n                    tywx.LOGD(null, 'userId:' + tywx.UserInfo.userId + ' userName:' + tywx.UserInfo.userName + ' userPic:' + tywx.UserInfo.userPic);\n\n                    if (tywx.UserInfo.userId && tywx.UserInfo.userName) {\n                        tywx.LOGE(\"TUYOO_SDK_LOGIN_SUCCESS\", JSON.stringify(params));\n                    } else {\n                        tywx.LOGE(\"TUYOO_SDK_LOGIN_FAIL\", JSON.stringify(params));\n                    }\n\n                    var token = result.token;\n                    tywx.LOGD(null, 'token:' + token);\n                    wx.setStorage({\n                        key: tywx.TuyooSDK.SESSION_KEY,\n                        data: token\n                    });\n\n\n                    tywx.BiLog.clickStat(tywx.clickStatEventType.clickStatEventTypeLoginSDKSuccess, [code, local_uuid, userInfo.nickName, result.userId]);\n                    if (tywx.showScene && tywx.showQuery && tywx.showQuery.sourceCode) {\n                        tywx.BiLog.clickStat(tywx.clickStatEventType.clickStatEventTypeUserFrom, [tywx.showScene, tywx.showQuery.inviteCode, tywx.showQuery.sourceCode, tywx.showQuery.imageType, \"GameStart\"]);\n                    }\n                    tywx.TuyooSDK.initWebSocketUrl(result);\n\n                    // 发送登录成功事件\n                    tywx.NotificationCenter.trigger(tywx.EventType.SDK_LOGIN_SUCCESS);\n                },\n\n                fail: function (params) {\n                    tywx.BiLog.clickStat(tywx.clickStatEventType.clickStatEventTypeLoginSDKFailed, [code, local_uuid, userInfo.nickName]);\n                    tywx.LOGD(null, 'tuyoo login fail, params:' + JSON.stringify(params));\n                    tywx.LOGE(\"TUYOO_SDK_LOGIN_FAIL\", JSON.stringify(params));\n                    tywx.NotificationCenter.trigger(tywx.EventType.SDK_LOGIN_FAIL);\n                },\n\n                complete: function (params) {\n\n                }\n            });\n        }\n        catch(err) {\n            tywx.LOGE(\"error:\", \"tywx.TuyooSDK.loginTuyooWithCode——\" + JSON.stringify(err));\n        }\n    },\n\n    /**\n     * 使用sdk登陆返回信息解析得到服务器连接地址,对于单机游戏来说无效\n     * @param loginResult\n     */\n    initWebSocketUrl: function(loginResult) {\n        if(loginResult && loginResult.tcpsrv) {\n            var ip = loginResult.tcpsrv.ip;\n            var port = loginResult.tcpsrv.wsport || loginResult.tcpsrv.port; //优先使用wsport\n            var webSocketUrl;\n            if (tywx.SystemInfo.loginUrl.indexOf(\"https://\") > -1){\n                webSocketUrl = 'wss://' + ip + '/';\n            }\n            else{\n                webSocketUrl = 'ws://' + ip + ':' + port.toString() + '/';\n            }\n            tywx.LOGD(null, 'webSocketUrl:' + webSocketUrl);\n            tywx.SystemInfo.webSocketUrl = webSocketUrl;\n        }\n    },\n\n\n    getSystemInfo : function () {\n        // {\n        // \t\"0\":{\n        // \t\"errMsg\":\"getSystemInfo:ok\",\n        // \t\t\"model\":\"iPhone X\",\n        // \t\t\"pixelRatio\":3,\n        // \t\t\"windowWidth\":375,\n        // \t\t\"windowHeight\":812,\n        // \t\t\"system\":\"iOS 10.0.1\",\n        // \t\t\"language\":\"zh_CN\",\n        // \t\t\"version\":\"6.6.3\",\n        // \t\t\"batteryLevel\":100,\n        // \t\t\"screenWidth\":375,\n        // \t\t\"screenHeight\":812,\n        // \t\t\"SDKVersion\":\"1.8.0\",\n        // \t\t\"brand\":\"devtools\",\n        // \t\t\"fontSizeSetting\":16,\n        // \t\t\"statusbarHeight\":44,\n        // \t\t\"platform\":\"devtools\"\n        // }\n        // }\n        try {\n            if(!tywx.IsWechatPlatform()) {\n                return;\n            }\n            wx.getSystemInfo({\n                success : function (result) {\n                    var model = result.model;\n                    var isiPhone = model.indexOf(\"iPhone\") >= 0;\n                    var windowHeight = result.windowHeight;\n                    var resultType = 0;\n                    if (isiPhone){\n                        if(windowHeight == 812){   //iPhoneX\n                            resultType = 2;\n                        }else if (windowHeight == 736){ // 7p 8p\n                            resultType = 4;\n                        }else {  //其他iPhone\n                            resultType = 1;\n                        }\n                    }else { //cc.sys.OS_ANDROID\n                        resultType = 3;\n                    }\n                    tywx.UserInfo.systemType = resultType;\n                    tywx.UserInfo.wechatType = result.version;\n                    tywx.UserInfo.model = result.model;\n                    tywx.UserInfo.system = result.system;\n                    tywx.UserInfo.sdkVersion = result.SDKVersion;\n                    //console.error(\"基础库版本为:\" + tywx.UserInfo.sdkVersion);\n                    //上报顺序为微信版本 基础库版本 平台 操作系统版本\n                    tywx.BiLog.clickStat(tywx.clickStatEventType.clickStatEventTypeSubmitVersionInfo,\n                        [result.version, result.SDKVersion, result.platform, result.system]);\n                },\n                fail : function () {\n                },\n                complete : function () {\n                }\n            });\n        }\n        catch(err) {\n            tywx.LOGE(\"error:\", \"tywx.TuyooSDK.getSystemInfo——\" + JSON.stringify(err));\n        }\n    },\n\n    wechatAuthorize: function() {\n        try {\n            if(!tywx.IsWechatPlatform()) {\n                return;\n            }\n            wx.getSetting({\n                success:function(res) {\n                    if (!res.authSetting['scope.userInfo']) {\n                        tywx.BiLog.clickStat(tywx.clickStatEventType.clickStatEventTypeAuthorizationStart, []);\n                        wx.authorize({\n                            scope : \"scope.userInfo\",\n                            success : function () {\n                                tywx.BiLog.clickStat(tywx.clickStatEventType.clickStatEventTypeAuthorizationSuccess, []);\n                                tywx.NotificationCenter.trigger(tywx.EventType.START_AUTHORIZATION_SUCCESS);\n                            },\n                            fail:function () {\n                                tywx.BiLog.clickStat(tywx.clickStatEventType.clickStatEventTypeAuthorizationFailed, []);\n                                tywx.NotificationCenter.trigger(tywx.EventType.START_AUTHORIZATION_FAILED);\n                            },\n                            complete:function () {\n                            }\n                        });\n                    }\n                    else{\n                        tywx.NotificationCenter.trigger(tywx.EventType.START_AUTHORIZATION_SUCCESS);\n                    }\n                }\n            })\n        }\n        catch(err) {\n            tywx.LOGE(\"error:\", \"tywx.TuyooSDK.wechatAuthorize——\" + JSON.stringify(err));\n        }\n    },\n\n    /***************************以下为支付相关接口*********************************/\n\n    createOrder:function(id, prodPrice, name, prodCount, extraProdId, extraAppInfo){\n        /*\n         params  id:商品ID,prodPrice:价格  单位元, name:商品名称\n         prodCount:购买数量,默认为1\n\n         prodId:商品ID, prodName:商品名称, prodCount:购买数量\n         prodPrice:价格  单位元,\n         chargeType:支付方式 wxapp.iap,\n         gameId:子游戏id,\n         appInfo:透传参数,\n         mustcharge:是否支付 默认填 1\n         */\n        var data = {};\n        data.prodId = id;\n        data.prodPrice = prodPrice;\n        data.chargeType = \"wxapp.iap\";\n        data.gameId = tywx.SystemInfo.gameId;\n        data.prodName = name;\n        data.prodCount = prodCount;\n        data.appInfo = extraAppInfo ? extraAppInfo :{};\n        data.extraProdId = extraProdId ? extraProdId : '';\n        tywx.TuyooSDK.rechargeOrder(data);\n    },\n\n    orderCallFunc:function(url, platformOrderId, chargeCoin){\n        try {\n            if(!tywx.IsWechatPlatform()) {\n                return;\n            }\n            var local_uuid = tywx.Util.getLocalUUID();\n            var _chargeCoin = chargeCoin;\n            wx.request({\n                url: url,\n                header: {\n                    'content-type': 'application/x-www-form-urlencoded'\n                },\n                data: {\n                    userId:tywx.UserInfo.userId,\n                    appId: tywx.SystemInfo.appId,\n                    wxAppId: tywx.SystemInfo.wxAppId,\n                    clientId: tywx.SystemInfo.clientId,\n                    imei: 'null',\n                    uuid : local_uuid,\n                    platformOrderId: platformOrderId,\n                },\n\n                method:'POST',\n\n                success: function(results) {\n                    var tips = \"购买成功\";\n                },\n                fail: function(params) {\n                    tywx.LOGE(null, 'file = [Recharge] fun = [OrderCallFun] 充值失败 params = ' + JSON.stringify(params));\n                },\n                complete: function(params) {\n\n                }\n            });\n        }\n        catch(err) {\n            tywx.LOGE(\"error:\", \"tywx.TuyooSDK.orderCallFunc——\" + JSON.stringify(err));\n        }\n    },\n\n    /*\n     params prodId:商品ID, prodName:商品名称, prodCount:购买数量\n     prodPrice:价格  单位元,\n     chargeType:支付方式 wxapp.iap,\n     gameId:子游戏id,\n     appInfo:透传参数,\n     mustcharge:是否支付 默认填 1\n     */\n    rechargeOrder: function (params){\n        try {\n            if(!tywx.IsWechatPlatform()) {\n                return;\n            }\n            var local_uuid = tywx.Util.getLocalUUID();\n            var sdkPath = tywx.SystemInfo.loginUrl;\n            var reqUrl = tywx.SystemInfo.hall_version == 'hall37' ? sdkPath + 'open/v4/pay/order': sdkPath + 'open/v5/pay/order';\n            wx.request({\n                url: reqUrl,\n                header: {\n                    'content-type': 'application/x-www-form-urlencoded'\n                },\n                data: {\n                    userId:tywx.UserInfo.userId,\n                    appId: tywx.SystemInfo.appId,\n                    wxAppId: tywx.SystemInfo.wxAppId,\n                    clientId: tywx.SystemInfo.clientId,\n                    imei: 'null',\n                    uuid : local_uuid,\n                    //商品信息\n                    prodId: params.prodId,\n                    prodName: params.prodName,\n                    prodCount: params.prodCount || 1,\n                    prodPrice: params.prodPrice,\n                    chargeType: params.chargeType,\n                    gameId : params.gameId,\n                    appInfo : params.appInfo,\n                    mustcharge : params.mustcharge || 1,\n                    prodOrderId: params.extraProdId,\n                },\n\n                method:'POST',\n\n                success: function(params) {\n                    tywx.LOGE(null, 'tuyoo rechargeOrder success, params:' + JSON.stringify(params));\n                    var results = params.data.result;\n                    if (results.code == 0) {\n                        var chargeInfo = results.chargeInfo;\n                        var chargeData = chargeInfo.chargeData;\n                        var notifyUrl = chargeData.notifyUrl;\n                        var platformOrderId = chargeData.platformOrderId;\n                        tywx.LOGE(null, 'tuyoo rechargeOrder success 创建订单成功, chargeData.mustcharge =' + chargeData.mustcharge);\n                        if (chargeData && chargeData.mustcharge == 1) {\n                            // wx.requestMidasPayment  购买微信币\n                            wx.requestMidasPayment({\n                                mode: chargeData.mode,\n                                env: chargeData.env,\n                                offerId: chargeData.offerId,\n                                buyQuantity: 10 * chargeInfo.chargeTotal,\n                                platform:chargeData.platform,\n                                currencyType:\"CNY\",\n                                zoneId: chargeData.zoneId,\n                                success:function(params) {\n                                    // 支付成功\n                                    tywx.TuyooSDK.orderCallFunc(notifyUrl,platformOrderId,chargeInfo.chargeCoin);\n                                },\n                                fail:function(res) {\n                                    tywx.LOGE(null, '米大师支付 fail params = ' + JSON.stringify(params));\n                                    if(res.errCode && res.errCode == 1) {\n                                        //支付取消\n                                        tywx.TuyooSDK.cancelOrder(platformOrderId);\n                                    }\n                                }\n                            });\n                        }else if (chargeData && chargeData.mustcharge == 0){\n                            tywx.TuyooSDK.orderCallFunc(notifyUrl,platformOrderId,chargeInfo.chargeCoin);\n                        }\n                    }else if (results.code == 1) {\n                        //hall.MsgBoxManager.showToast({title : results.info});\n                    }else if (results.code == 3) {\n                        //hall.MsgBoxManager.showToast({title : '微信小程序登陆验证失败!'});\n                    }\n                },\n                fail: function(params) {\n                    //hall.MsgBoxManager.showToast({title : '购买失败!'});\n                },\n                complete: function(params) {\n                }\n            });\n        }\n        catch(err) {\n            tywx.LOGE(\"error:\", \"tywx.TuyooSDK.rechargeOrder——\" + JSON.stringify(err));\n        }\n    },\n\n    cancelOrder: function(orderId) {\n        try {\n            var sendUrl = tywx.SystemInfo.loginUrl + 'open/v4/pay/cancelorder';\n            var postData = {\n                platformOrderId: orderId,\n                appId: tywx.SystemInfo.appId,\n                userId: tywx.UserInfo.userId,\n                clientId: tywx.SystemInfo.clientId,\n                payType:  \"wxapp.iap\"\n            };\n            wx.request({\n                url: sendUrl,\n                header: {\n                    'content-type': 'application/x-www-form-urlencoded'\n                },\n                data: postData,\n                method:'POST',\n                success: function(params) {\n                    tywx.LOGE(null, 'tuyoo cancelOrder success, params:' + JSON.stringify(params));\n                },\n                fail: function(params) {\n                    tywx.LOGE(null, 'tuyoo cancelOrder fail, params:' + JSON.stringify(params));\n                },\n                complete: function(params) {\n                }\n            });\n        }\n        catch(err) {\n            tywx.LOGE(\"error:\", \"tywx.TuyooSDK.cancelOrder——\" + JSON.stringify(err));\n        }\n    }\n}\n\n// tywx.playMusic = function(){\n//     if(tywx.addbgm == null){\n//         tywx.addbgm = wx.createInnerAudioContext();\n//         tywx.addbgm.src = \"https://marketqn.nalrer.cn/teris/m/3.mp3\";\n//         tywx.addbgm.loop = true\n//         tywx.addbgm.volume = 0.25\n//         tywx.addbgm.play();\n//      }else{\n//         if(tywx.addbgm.paused != false){\n//            tywx.addbgm.volume = 0.25\n//            tywx.addbgm.play();\n//         }\n//      }\n// };\n\n// tywx.stopMusic = function(){\n//     if(tywx.addbgm != null){\n//         tywx.addbgm.stop();\n//     }\n// };\n\n// tywx.pauseMusic = function(){\n//     if(tywx.addbgm != null){\n//         tywx.addbgm.pause();\n//     }\n// };\n\ntywx.WechatInterfaceInit = function() {\n    try {\n        if(tywx.IsWechatPlatform()) {\n            /**\n             * 小程序回到前台,具体逻辑自己实现\n             */\n            wx.onShow(function (result) {\n                //tywx.playMusic();\n                // {\"0\":{\"scene\":1044,\"shareTicket\":\"beecdf9e-e881-492c-8a3f-a7d8c54dfcdb\",\"query\":{}}}  (从后台切到前台才有shareTicket,启动时没有)\n                tywx.LOGE('', \"+++++++++++++++++onShow+++++++++++++++++\"+JSON.stringify(result));\n                //取相关参数\n                var scene = result.scene;\n                var query = result.query;\n                var scenePath = '';\n                tywx.showScene = scene;\n                tywx.showQuery = query;\n                //来源处理\n                tywx.UserInfo.scene_id = scene;\n                tywx.UserInfo.scene_param = query.from || \"\";\n                tywx.UserInfo.invite_id = query.inviteCode || 0;\n                tywx.StateInfo.isOnForeground = true;\n                tywx.NotificationCenter.trigger(tywx.EventType.GAME_SHOW, result);\n                var hasUUID = tywx.Util.checkLocalUUID();\n                var oldUserFlag = hasUUID ? 1 : 0;\n                if (query && query.gdt_vid && query.weixinadinfo) {\n                    //从广点通广告跳过来的，from的开头加入gdt标识区分\n                    var from = \"gdt.\" + query.weixinadinfo;\n                    tywx.UserInfo.scene_param = from;\n                    tywx.BiLog.clickStat(tywx.clickStatEventType.clickStatEventTypeUserFrom,[scene, from, oldUserFlag]);\n                }\n                else if(query && query.sourceCode) {\n                    //从小程序消息卡片中点入,该场景为\"点击用户分享卡片进入游戏注册时，分享用户的user_id直接当做场景参数放在param02，param03和param04分别代表分享点id和分享图文id\"\n                    //var query = \"inviteCode=\"+ty.UserInfo.userId+\"&sourceCode=\"+type +\"&imageType=\"+imageMap.imageType+\"&inviteName=\"+ty.UserInfo.userName;\n                    tywx.BiLog.clickStat(tywx.clickStatEventType.clickStatEventTypeUserFrom,[scene, query.inviteCode, query.sourceCode, query.imageType, \"CardActive\", oldUserFlag]);\n                } else {\n                    if(tywx.Util.isSceneQrCode(scene)) {\n                        //从小程序码进入,相关见文档https://developers.weixin.qq.com/minigame/dev/tutorial/open-ability/qrcode.html\n                        if (query.hasOwnProperty('scene')){\n                            scenePath = query.scene;\n                        } else if(result.hasOwnProperty('path')) {\n                            scenePath = result.path;\n                        }\n                        scenePath.replace(\".html\", \"\");     //生成时可能会在path后面添加.html\n                        scenePath = decodeURIComponent(scenePath);\n                        tywx.UserInfo.scene_param = scenePath;\n                        tywx.BiLog.clickStat(tywx.clickStatEventType.clickStatEventTypeUserFrom,[scene, scenePath, oldUserFlag]);\n                    } else {\n                        //场景值和场景参数分别记录到可选参数param01和param02当中，如param01=1058，param02=tuyouqipai\n                        //场景参数由项目组接入推广渠道时配置，如公众号dacihua、tuyouqipai，二维码填写企业或个人标识\n                        tywx.BiLog.clickStat(tywx.clickStatEventType.clickStatEventTypeUserFrom,[scene, query.from, oldUserFlag]);\n                    }\n                }\n                tywx.BiLog.clickStat(tywx.clickStatEventType.clickStatEventTypeOnShowTimeStampSubmit,[]);\n                tywx.TuyooSDK.login();\n\n                tywx.AdManager && tywx.AdManager.onForeGround && tywx.AdManager.onForeGround();\n                //! 插件接口\n                tywx.ado.onShow(result);\n            });\n\n            /**\n             * 小程序进入后台\n             */\n            wx.onHide(function () {\n                tywx.LOGE('',\"+++++++++++++++++onHide+++++++++++++++++\");\n                tywx.BiLog.clickStat(tywx.clickStatEventType.clickStatEventTypeOnHideTimeStampSubmit,[]);\n                tywx.UserInfo.scene_id = 0;\n                tywx.StateInfo.isOnForeground = false;\n                tywx.NotificationCenter.trigger(tywx.EventType.GAME_HIDE);\n                tywx.TCPClient.close();\n\n                //! 插件接口\n                tywx.ado.onHide();\n            });\n\n            var getNetSuccess = function (res) {\n                if (res.hasOwnProperty('isConnected')){\n                    tywx.StateInfo.networkConnected = res.isConnected;\n                }\n                else if (res.hasOwnProperty('errMsg')){\n                    tywx.StateInfo.networkConnected = res.errMsg == 'getNetworkType:ok'\n                }\n                else{\n                    tywx.StateInfo.networkConnected = res.networkType != 'none';\n                }\n\n                tywx.StateInfo.networkType = res.networkType;//wifi,2g,3g,4g,none,unknown\n            };\n\n            wx.getNetworkType({\n                success:getNetSuccess\n            });\n\n            wx.onNetworkStatusChange(getNetSuccess);\n\n            wx.onError(function (res) {\n                var d = new Date();\n                // var errMsg = 'userId:' + tywx.UserInfo.userId + 'time:'+ d.toDateString() + ' ' + d.toTimeString() +';' + res.message;\n                tywx.ado.Utils.uploadErrorMsg(res.message);\n            });\n\n            wx.onAudioInterruptionEnd(function () {\n                //tywx.playMusic();\n            });\n        };\n    }\n    catch(err) {\n        tywx.LOGE(\"error:\", \"tywx.WechatInterfaceInit——\" + JSON.stringify(err));\n    }\n};\n\ntywx.WechatInterfaceInit();\n\n"]}