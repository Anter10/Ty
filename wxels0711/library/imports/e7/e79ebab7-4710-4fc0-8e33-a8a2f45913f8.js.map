{"version":3,"sources":["../../../../../assets/script/CommonFrame/assets/script/CommonFrame/TY_Receiver.js"],"names":["ELSEvent","require","els","ElsUtils","tywx","Receiver","_map","init","NotificationCenter","listen","EventType","TCP_OPENED","_onMsgTcpOpen","TCP_ERROR","_onMsgTCPErr","TCP_CLOSE","CMD_UPDATE_NOTIFY","_onMsgUpdateNotify","TCP_RECEIVE","_onMsgServerMessage","register","CMD_USER_INFO","_onMsgUserInfo","CMD_GAME_DATA","_onMsgGameData","CMD_ITEM","_onMsgItem","CMD_ELSWX","_onMsgElsWx","CMD_STORE","_onMsgStore","onDestroy","ignoreScope","eventName","func","MSG","bindUser","console","log","params","cmd","call","JSON","stringify","trigger","bindGame","SystemInfo","gameId","StoreList","getStoreList","hallInfo","getBagInfo","enterGame","UserInfo","invite_id","user_add_item","addItems","select_gift_item","_item","content","items","itemId","substr","_amount","_uuid","uuid","whisperStart","undefined","showQuery","SECRET_LANGUAGE_TO_GAME","_onMsgHallInfo","result","action","_bag","forEach","index","_kindID","_count","diamond","push","kindID","count","bag","ELS_EVENT_UPDATE_BAG","error","info","Util","wechatShowModal","changes","i","length","getUserInfo","ps","ds","gs","_data","_ps","_ds","_gs","_products","products","item","parseInt","status","ELS_EVENT_CUNSOME_ITEM_SUCCESS","reason","ELS_EVENT_ADD_ITEM_SUCCESS","whisperResult","loginReward","openId","ELS_EVENT_DAILY_LOGIN_GIFT_SUCCESS","normalItems","recvCount","sort","lhr","rhr","lvalue","isNaN","rvalue","elsBag","recvPrice","saveItem","sendPrice"],"mappings":"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","file":"TY_Receiver.js","sourceRoot":"../../../../../assets/script/CommonFrame","sourcesContent":["var ELSEvent = require(\"../core/ElsEvents.js\");\nvar els = require(\"../core/els.js\");\nvar ElsUtils = require(\"../core/ElsUtils.js\");\n\ntywx.Receiver = {\n\n    _map: {}, // 保存注册的协议回调\n\n    init: function() {\n        /**\n         * tcp消息，不要再注册。\n         */\n        tywx.NotificationCenter.listen(tywx.EventType.TCP_OPENED, this._onMsgTcpOpen, this);\n        tywx.NotificationCenter.listen(tywx.EventType.TCP_ERROR, this._onMsgTCPErr, this);\n        tywx.NotificationCenter.listen(tywx.EventType.TCP_CLOSE, this._onMsgTCPErr, this);\n        tywx.NotificationCenter.listen(tywx.EventType.CMD_UPDATE_NOTIFY, this._onMsgUpdateNotify, this);\n        tywx.NotificationCenter.listen(tywx.EventType.TCP_RECEIVE, this._onMsgServerMessage, this);\n\n        this.register(tywx.EventType.CMD_USER_INFO, this._onMsgUserInfo, this);\n        this.register(tywx.EventType.CMD_GAME_DATA, this._onMsgGameData, this);\n        this.register(tywx.EventType.CMD_USER_INFO, this._onMsgUserInfo, this);\n        this.register(tywx.EventType.CMD_ITEM, this._onMsgItem, this);\n        this.register(tywx.EventType.CMD_ELSWX, this._onMsgElsWx, this);\n        this.register(tywx.EventType.CMD_STORE, this._onMsgStore, this);\n\n    },\n\n    onDestroy() {\n        tywx.NotificationCenter.ignoreScope(this);\n    },\n\n    // 注册cmd回调\n    register: function(eventName, func) {\n        this._map[eventName] = func;\n    },\n\n    _onMsgTcpOpen() {\n        tywx.MSG.bindUser();\n    },\n\n    _onMsgTCPErr() {\n        console.log(\"链接断开了....\");\n    },\n\n    _onMsgServerMessage(params) {\n        params = params || {};\n        let cmd = params.cmd;\n        if (cmd) {\n            let func = this._map[cmd];\n            if (typeof func === 'function') {\n                func.call(this, params);\n                console.log(\"_onMsgServerMessage::\", JSON.stringify(params));\n            }\n            tywx.NotificationCenter.trigger(cmd, params);\n        }\n    },\n\n    // ===============>>>>>\n    _onMsgUserInfo(params) {\n        console.log(\"_onMsgUserInfo\", JSON.stringify(params));\n        tywx.MSG.bindGame(tywx.SystemInfo.gameId);\n    },\n\n    _onMsgGameData(params) {\n        console.log(\"_onMsgGameData\", JSON.stringify(params));\n        if (!tywx.StoreList) {\n            tywx.MSG.getStoreList();\n        }\n        tywx.MSG.hallInfo();\n        tywx.MSG.getBagInfo();\n        tywx.MSG.enterGame(tywx.UserInfo.invite_id);\n        if (tywx.UserInfo.user_add_item > 0) {\n            tywx.MSG.addItems(6, 0, tywx.UserInfo.user_add_item);\n            tywx.UserInfo.user_add_item = -1;\n        }\n        if (tywx.UserInfo.select_gift_item) {\n            let _item = tywx.UserInfo.select_gift_item ? tywx.UserInfo.select_gift_item.content.items[0].itemId.substr(-4) : \"\";\n            let _amount = 1;\n            let _uuid = tywx.UserInfo.select_gift_item.uuid;\n            tywx.MSG.whisperStart(_uuid, _item, _amount);\n            tywx.UserInfo.select_gift_item = undefined;\n        }\n        if (tywx.UserInfo.showQuery) {\n            tywx.NotificationCenter.trigger(tywx.EventType.SECRET_LANGUAGE_TO_GAME, tywx.UserInfo.showQuery);\n        }\n    },\n\n    _onMsgHallInfo(params) {\n        console.log(\"_onMsgHallInfo\", JSON.stringify(params));\n    },\n\n    _onMsgItem(params) {\n        console.log(\"_onMsgItem\", JSON.stringify(params));\n        if (params.result.action === \"_feiqi\") {\n            // 背包信息\n            let _bag = [];\n            params.result.items.forEach(function(_item, index) {\n                let _kindID = _item[1];\n                let _count = _item[2];\n                // TODO: 遍历道具信息 组合成布局需要的数据\n                if (_kindID === 1014) { // 钻石数\n                    tywx.UserInfo.diamond = _count;\n                }\n                _bag.push({\n                    kindID: _kindID,\n                    itemId: _kindID,\n                    count: _count\n                });\n            });\n\n            tywx.UserInfo.bag = _bag; //ELS_EVENTS\n            tywx.NotificationCenter.trigger(ELSEvent.ELS_EVENT_UPDATE_BAG, _bag);\n        }\n\n        if (params.result.action === 'product') { // 兑换道具成功后 重新拉起背包\n            if (params.error && params.error.info) {\n                tywx.Util.wechatShowModal(params.error.info, false, \"\\u786e\\u8ba4\");\n                return;\n            }\n            tywx.MSG.getBagInfo();\n            tywx.Util.wechatShowModal(\"道具兑换成功啦!\", false, \"确认\");\n        }\n    },\n\n    /**\n     * 通知更新数据：用户信息\n     * @private\n     */\n    _onMsgUpdateNotify(params) {\n        let result = params.result;\n        let changes = result['changes'] || [];\n        for (let i = 0; i < changes.length; i++) {\n            if (changes[i] === \"udata\") {\n                tywx.MSG.getUserInfo();\n            } else if (changes[i] === \"item\") {\n                tywx.MSG.getBagInfo();\n            } else if (changes[i] === \"redpoint5\") {\n                tywx.MSG.getUserInfo();\n                tywx.MSG.getBagInfo();\n            }\n        }\n    },\n\n    _onMsgStore(params) {\n        if (params.result.action === \"sc_list\") { // 道具消耗\n            tywx.StoreList = undefined;\n            var ps = [];\n            var ds = [];\n            var gs = [];\n            // 道具配置\n\n            let _data = params.result;\n\n            let _ps = _data[\"shelves\"][\"shelves\"][\"coin:01\"][\"products\"] || [];\n            let _ds = _data[\"shelves\"][\"shelves\"][\"diamond:00\"][\"products\"] || [];\n            let _gs = _data[\"shelves\"][\"shelves\"][\"gift:01\"][\"products\"] || [];\n\n            let _products = _data.products.products;\n\n            _ps.forEach((item) => {\n                ps.push(_products[item]);\n            });\n\n            _ds.forEach((item) => {\n                ds.push(_products[item]);\n            });\n\n            _gs.forEach((item) => {\n                gs.push(_products[item]);\n            });\n\n            tywx.StoreList = {\n                ps: ps,\n                gs: gs,\n                ds: ds,\n                items: _data.items.items\n            };\n        }\n    },\n\n    _onMsgElsWx(params) {\n        if (params.result.action === \"consume_items\") { // 道具消耗\n            if (parseInt(params.result.status) === 1) { // 道具消耗成功\n                tywx.NotificationCenter.trigger(ELSEvent.ELS_EVENT_CUNSOME_ITEM_SUCCESS, params);\n            }\n        }\n\n        if (params.result.action === \"add_items\") { // 道具添加\n            if (parseInt(params.result.status) === 1 && parseInt(params.result.reason) === 6) { // 水瓶满 道具添加成功\n                tywx.NotificationCenter.trigger(ELSEvent.ELS_EVENT_ADD_ITEM_SUCCESS, params);\n            }\n        }\n        if (params.result.action === \"add_diamond\") { // 道具添加\n            // if (parseInt(params.result.count) === 1) { // 看广告 道具添加成功\n                tywx.Util.wechatShowModal(\"恭喜获得钻石x\"+params.result.count, false, \"确认\");\n            // }\n        }\n\n        if (params.result.action === \"enter_game\") {\n            // 悄悄话通关奖励\n            tywx.UserInfo.whisperResult = params.result.whisperResult;\n            // 每日登陆奖励\n            tywx.UserInfo.loginReward = params.result.loginReward;\n            // openId\n            tywx.UserInfo.openId = params.result.openId.substr(6);\n\n        }\n\n        if (params.result.action === 'daily_login') {\n            //! 更新背包信息\n            tywx.MSG.getBagInfo();\n            //! 通知获取奖励成功\n            tywx.NotificationCenter.trigger(ELSEvent.ELS_EVENT_DAILY_LOGIN_GIFT_SUCCESS, params);\n        }\n\n        if (params.result.action === 'get_bag') {\n            //! 更新背包信息\n            // 背包信息\n            let _bag = [];\n            params.result.normalItems.forEach(function(_item, index) {\n                let _kindID = _item[1];\n                let _count = _item[2];\n                // TODO: 遍历道具信息 组合成布局需要的数据\n                if (_kindID === 1014) { // 钻石数\n                    tywx.UserInfo.diamond = _count;\n                }\n                _bag.push({\n                    kindID: _kindID,\n                    itemId: _kindID,\n                    count: _count\n                });\n            });\n\n            for (var i in params.result.recvCount) {\n                let _kindID = parseInt(i);\n                let _count = params.result.recvCount[i];\n                _bag.push({\n                    kindID: _kindID,\n                    itemId: _kindID,\n                    count: _count\n                });\n            }\n\n            _bag.sort(function(lhr, rhr) {\n                var lvalue = parseInt(lhr.kindID);\n                if (isNaN(lvalue)) lvalue = 0;\n                var rvalue = parseInt(rhr.kindID);\n                if (isNaN(rvalue)) rvalue = 0;\n                return rvalue - lvalue;\n            });\n            tywx.UserInfo.bag = _bag; //ELS_EVENTS\n            tywx.UserInfo.elsBag = params.result; //ELS_EVENTS\n            tywx.NotificationCenter.trigger(ELSEvent.ELS_EVENT_UPDATE_BAG, _bag);\n            // TODO : 更新排行榜\n            if (params.result.recvPrice !== tywx.UserInfo.recvPrice) {\n                tywx.UserInfo.recvPrice = params.result.recvPrice;\n                ElsUtils.saveItem(\"ELS_RECV_PRIVE\", params.result.recvPrice); // 接受\n            } \n            if (params.result.sendPrice !== tywx.UserInfo.sendPrice) {\n                tywx.UserInfo.sendPrice = params.result.sendPrice;\n                ElsUtils.saveItem(\"ELS_SEND_PRIVE\", params.result.sendPrice); // 发送\n            } \n        }\n    },\n};\n\ntywx.Receiver.init();"]}