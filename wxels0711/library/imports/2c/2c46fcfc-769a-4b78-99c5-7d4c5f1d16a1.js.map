{"version":3,"sources":["../../../../assets/script/assets/script/main.js"],"names":["nge","require","els","model","ElsGrid","ElsModel","ElsRender","ElsTouch","ElsGame","elsGame","ELSEvent","ELSProfile","ElsUtils","SkinConfig","cc","Class","name","properties","skinName","localId","serverId","blocks","SpriteFrame","MainGame","extends","Component","gameCommon","Node","hgNode","default","type","displayName","saiNode","gvsNode","gleNode","helpNode","rankNode","pause","prefabblock","Prefab","prefabattack0","prefabattack1","blockConfigs","blockimgs","p_c","mask_label","prefabGiftAnimation","nodeYanHua","prefabCombo","prefabRocketMoveParticle","prefabRocketMoveEndBoom","prefabAimAtBlock","arrPropPlaceHolder","arrPropCount","Label","nodeProp0","nodeProp1","nodeProp2","nodeProp3","nodeProp1Using","nodeProp2Effect","nodeProp0Effect","prefabProp0Effect","nodeMaticBottle","prefabGiftPropView","nodeMagicBottlePlaceHolder","soundTag","nodePop","prefabZhuBaoAnimation","onLoad","allBlockSpriteFrames","loadRes","initZhuBaoAnimations","director","setDisplayStats","CONFIG","CONFIG_LOCAL","tywx","NotificationCenter","listen","onStatusChange","node","on","EventType","TOUCH_START","touchStart","TOUCH_MOVE","touchMove","TOUCH_END","touchEnd","headAtlas","undefined","self","loader","SpriteAtlas","err","atlas","UIManager","registerUI","ELS_GAME_LAYER","HOMEPAGE","GAME_COMMON","GAME_SINGLE","GAME_VS","GAME_SEARCH_AI","RANK","HELP","StarControl","init","ELS_EVENT_MAGIC_BOTTLE_FULL","showGiftProp","ELS_EVENT_CUNSOME_ITEM_SUCCESS","onAddProp","ELS_EVENT_ADD_ITEM_SUCCESS","ELS_EVENT_UPDATE_BAG","ELS_EVENT_HIDE_GIFT_PROP","hideGiftProp","ELS_EVENT_ADD_MAGIC","addMagic","ELS_EVENT_SHOW_MAGIC_ADD_EFFECT","showAddMagicEffect2","ELS_EVENT_REFRESH_LOCAL_SKIN","onChangeBlocks","ELS_EVENT_SHOW_GIFT_PROP_ANIMATION","onShowGiftPropAnimation","ELS_EVENT_SHOW_CLEARN_ROW_EFFECT","onShowClearnRowEffect","ELS_EVENT_REFRESH_ZHUBAO_COUNT","onShowAddZhuBaoEffect","ELS_EVENT_SHOW_ICE_EFFECT","onUpdateIceBlock","ELS_EVENT_ON_SHOW_ENDLESS_LEVEL_UP","onShowEndlessLevelUpEffect","ELS_EVENT_ADD_ZHUBAO_ANIMATION","onAddZhuBaoAnimations","ELS_EVENT_REFRESH_ZHUBAO_ANIMATION_POS","onRefreshZhuBaoAnimation","ELS_EVENT_DELETE_ZHUBAO_ANIMATION","onDeleteZhuBaoAnimation","ELS_EVENT_RESET_ZHUBAO_ANIMATION_POOL","resetZhuBaoAnimations","ELS_EVENT_ENDLESS_SHOW_LEVEL_END","onEndelssShowLevelEnd","ELS_EVENT_ENDLESS_ON_ZHUBAO_CHANGE","onEndlessZhuBaoChange","onDestroy","ignoreScope","Map","allShadows","loadResDir","assets","urls","console","log","forEach","asset","set","initBlockSkinConfig","idx","i","length","t","tmp_skin_config","block_frames","j","str_format","has","push","get","k","_pf","parseInt","loadItem","initZhuBaoFrames","zhuBaoFrames","frame_name","zhubaoAnimations","e","destroy","createNewZhuBaoAnimations","ani","instantiate","parent","getChildByName","active","getZhuBaoAnimation","ret","splice","getZhuBaoAnimationByRowAndCol","row","col","key","zhubaoAnimationMap","v","clear","params","zhubao","getComponent","showZhuBaoAnimationByIdx","position","rawpos","game","endless_level","n_row","is_down","n_key","delete","Error","zhubao_arr","shadow","zhubao_datas","tmp_data","tmp_zhubao_ani","s2l","lbl_next","lbl_hold","yanhua","backmask","add5step","opacity","share5line","share5step","animShare5Line","animShare5Step","lbl_time","lbl_antiscore","lbl_progress","lbl_title","lbl_myscore","lbl_endless_score","back","maintips","scale","HENG","mask","timestep","combo","removeAllChildren","n","il","ZONG","Array","jl","c","bsize","rawscale","setBlkColor","v2","ice_blocks","prefab","preFabNode","holdnext","by","attani","scaletail","op","Sprite","setVisible","magicAni","step","item","start","singleView","vsView","m","r","tou","initGame","Math","random","setGameStatus","ELS_GAME_STATE","begin_help1st","begin_cd","begin_win_partical","needhelp1st","pkstar","updatePKStar","frametime","run","showUI","getWXUserInfo","getFriendCloudStorage","magicBottle","reset","refreshPropCount","gift_view","ani_magic_wand","Animation","num","string","mgrid","clearnBottomLinesByCount","checkReward","insertChild","beyondOpenData","UserInfo","loginReward","error","message","daily_login","showAddMagicEffect","getNextUserInfo","next_current_stage_user","next_pk_user","getdat","_type","data","d","value","pk_star_data","nickname","WXUserInfo","nickName","avatarUrl","UserRankData","next_pk_star_data","next_current_stage","user_data","KVDataList","cal","OpenDataContextUtil","para","JSON","stringify","getUserInfo","refreshBgAdapter","status","PLAYING","refreshShow","mconf","mode","RESULT_LOSE","showGameLost","RESULT_WIN","showGameWin","KEEPSTAR","showKeepStar","SEARCH_AI","SHOW_REVIVE","showRevive","emergencyShare","ELS_MODE_SINGLE","showLose","showWin","btnPause","getGameStatus","pauseGame","refreshSoundTag","btnContinue","continueGame","btnBackToHome","hideAllUI","_backToHomePage","event","t1","getLocation","temp","convertToNodeSpace","began","x","y","moved","ended","update","dt","cmap","rotation","isZhubao","spriteFrame","isEndless","showCombo","combo_count","p","showClearAnimation","clear_count","showBeyondNode","showBeyond","hidenBeyondNode","usePropSink","usePropByKey","PROP_TYPES","PROP_0","cb","sinkAllCol","showHammerEffect","usePorpRocket","PROP_1","datas","fillRandomBlock","showRocketEffectByData","usr_idx","trigger","ELS_EVENT_SET_MAGIC_BUSY","ani_count","end_cb","clearnRow","playMusic","ELS_VOICE","DAODAN_MUSIC","GRIDW","nodeBlock","prop_pos","aimAt","rocketMove","moveEndCB","removeFromParent","boom","runAction","sequence","callFunc","fillGridByIndex","delayTime","removeSelf","moveTo","effect","CHUI_MUSIC","showClearnTopCol","setTimeout","showGiftBox","getPropByKey","prop_key","PROP_DEAFULT_VALUE","_","_key","TCPClient","connectStatus","CONNECT_STATUS_OK","userId","wx","showToast","title","duration","getPropCountByKey","showUnlockUI","MSG","consumeItem","local2Server","do_consume_item","getCurrentUI","tmp_count","prop_num","end_pos","count","animation_cb","target","fr","mcore","fullrows","b","spawn","rotateBy","onUseMagicWand","play","onUseIceB","setFreezeStep","consume_item_success","_items","result","items","_item","server2local","itemId","current_endless","is_endless","t_endless","delay_time","pg","ct","col_top","grid","usePopMagicWand","onHelpHandler","unSelectSound","getInstance","switchMusicMute","getIsMusicMute","BG_MUSIC","playRandomBgMusic","animation_display","prop_id","showClearnLineEffectByRow","pos","hide_block","animation","end_node","sp","ep","dist","pDistance","normalPos","pSub","normalizeSelf","cfg","bezierTo","easing","easeSineIn","size","width","height","scaleTo","add_score","ENDLESS_VALUES","GetZhuBaoAddScore","module","exports"],"mappings":"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","file":"main.js","sourceRoot":"../../../../assets/script","sourcesContent":["var nge = require(\"./core/engine.js\");\nvar els = require(\"./core/els.js\");\nvar model = require(\"./core/model.js\");\nvar ElsGrid = require(\"./core/grid.js\");\nvar ElsModel = model.ElsModel;\nvar ElsRender = require(\"./core/render.js\");\nvar ElsTouch = require(\"./core/touch.js\");\nvar ElsGame = require(\"./core/game.js\").elsGame;\nvar ELSEvent = require(\"./core/ElsEvents.js\");\nvar ELSProfile = require(\"./core/ELSProfile.js\");\nvar ElsUtils = require(\"./core/ElsUtils.js\");\n// 皮肤数据类型\nlet SkinConfig = cc.Class({\n    name:'SkinConfig',\n    properties:{\n        skinName:'皮肤名字',\n        localId:0,\n        serverId:0,\n        blocks:[cc.SpriteFrame]\n    }\n});\n\nlet MainGame = cc.Class({\n    extends: cc.Component,\n\n    properties: {\n\n        gameCommon : cc.Node,\n        hgNode: {\n            default: null,\n            type: cc.Node,\n            displayName: \"对[homepage]的引用\"\n        },\n\n        saiNode: {\n            default: null,\n            type: cc.Node,\n            displayName: \"对[searchai]的引用\"\n        },\n\n        gvsNode: {\n            default: null,\n            type: cc.Node,\n            displayName: \"对[game VS]的引用\"\n        },\n\n        gleNode: {\n            default: null,\n            type: cc.Node,\n            displayName: \"对[game single]的引用\"\n        },\n\n        helpNode: {\n            default: null,\n            type: cc.Node,\n            displayName: \"对[help]的引用\"\n        },\n\n        rankNode: {\n            default: null,\n            type: cc.Node,\n            displayName: \"对[rank]的引用\"\n        },\n        pause : cc.Node,\n        prefabblock: cc.Prefab,\n        prefabattack0: cc.Prefab,\n        prefabattack1: cc.Prefab,\n        blockConfigs: [SkinConfig],\n        blockimgs: [cc.SpriteFrame],\n        p_c: cc.Prefab,\n        mask_label: cc.Prefab,\n        prefabGiftAnimation: {\n            default: null,\n            type: cc.Prefab,\n            displayName: \"猫头鹰动画\"\n        },\n        nodeYanHua:{\n            default: null,\n            type: cc.Node,\n            displayName: '烟花粒子'\n        },\n        prefabCombo:{\n            default: null,\n            type: cc.Prefab,\n            displayName: '连击动画预制件',\n        },\n        prefabRocketMoveParticle:{\n            default: null,\n            type: cc.Prefab,\n            displayName: '火箭移动追随粒子'\n        },\n        prefabRocketMoveEndBoom:{\n            default: null,\n            type: cc.Prefab,\n            displayName: \"火箭爆炸\",\n        },\n        prefabAimAtBlock:{\n            default: null,\n            type: cc.Prefab,\n            displayName: '瞄准镜动画',\n        },\n        arrPropPlaceHolder: [cc.Node], //! 道具占位节点\n        arrPropCount: [cc.Label], //! 道具数量\n        nodeProp0: cc.Node,\n        nodeProp1: cc.Node,\n        nodeProp2: cc.Node, // 魔棒\n        nodeProp3: cc.Node, // 冰弹\n        nodeProp1Using: cc.Node,\n        nodeProp2Effect: cc.Node,\n        nodeProp0Effect: cc.Node,\n        prefabProp0Effect: {\n            default: null,\n            type: cc.Prefab,\n            displayName:\"锤子特效预制件\"\n        },\n        nodeMaticBottle: cc.Node,\n        prefabGiftPropView:{\n            default: null,\n            type: cc.Prefab,\n            displayName: \"获取宝箱弹窗\"\n        },\n        nodeMagicBottlePlaceHolder: cc.Node, //! 魔法瓶占位节点\n        soundTag:cc.Node, // 音量标识\n        nodePop: {\n            default: null,\n            type: cc.Node,\n            displayName: '弹窗根结点'\n        }, //! 弹窗根结点\n        prefabZhuBaoAnimation: cc.Prefab, //! 珠宝动画\n\n    },\n\n    onLoad() {\n        this.allBlockSpriteFrames = [];\n        this.loadRes();\n        this.initZhuBaoAnimations();\n        cc.director.setDisplayStats(true);\n        els.CONFIG = els.CONFIG_LOCAL;\n\n        tywx.NotificationCenter.listen(\"STATUS_CHANGE\", this.onStatusChange, this);\n        this.node.on(cc.Node.EventType.TOUCH_START, this.touchStart, this);\n        this.node.on(cc.Node.EventType.TOUCH_MOVE, this.touchMove, this);\n        this.node.on(cc.Node.EventType.TOUCH_END, this.touchEnd, this);\n        this.headAtlas = undefined;\n        var self = this;\n        cc.loader.loadRes(\"image/heads/heads\", cc.SpriteAtlas, function (err, atlas) {\n            self.headAtlas = atlas;\n        });\n\n        //注册UI\n        tywx.UIManager.registerUI(els.ELS_GAME_LAYER.HOMEPAGE, this.hgNode, 'homePage');\n        tywx.UIManager.registerUI(els.ELS_GAME_LAYER.GAME_COMMON, this.node, 'main');\n        tywx.UIManager.registerUI(els.ELS_GAME_LAYER.GAME_SINGLE, this.gleNode, 'gameSinglemode');\n        tywx.UIManager.registerUI(els.ELS_GAME_LAYER.GAME_VS, this.gvsNode, 'gameVSmode');\n        tywx.UIManager.registerUI(els.ELS_GAME_LAYER.GAME_SEARCH_AI, this.saiNode, 'searchAIPage');\n        tywx.UIManager.registerUI(els.ELS_GAME_LAYER.RANK, this.rankNode, 'rank');\n        tywx.UIManager.registerUI(els.ELS_GAME_LAYER.HELP, this.helpNode);\n\n        tywx.StarControl.init();\n        //! 注册监听事件\n        tywx.NotificationCenter.listen(ELSEvent.ELS_EVENT_MAGIC_BOTTLE_FULL, this.showGiftProp,this);\n        tywx.NotificationCenter.listen(ELSEvent.ELS_EVENT_CUNSOME_ITEM_SUCCESS, this.onAddProp,this);\n        tywx.NotificationCenter.listen(ELSEvent.ELS_EVENT_ADD_ITEM_SUCCESS, this.onAddProp,this);\n        tywx.NotificationCenter.listen(ELSEvent.ELS_EVENT_UPDATE_BAG, this.onAddProp,this);\n        tywx.NotificationCenter.listen(ELSEvent.ELS_EVENT_HIDE_GIFT_PROP, this.hideGiftProp,this);\n        tywx.NotificationCenter.listen(ELSEvent.ELS_EVENT_ADD_MAGIC, this.addMagic,this);\n        tywx.NotificationCenter.listen(ELSEvent.ELS_EVENT_SHOW_MAGIC_ADD_EFFECT, this.showAddMagicEffect2,this);\n        tywx.NotificationCenter.listen(ELSEvent.ELS_EVENT_REFRESH_LOCAL_SKIN, this.onChangeBlocks,this);\n        tywx.NotificationCenter.listen(ELSEvent.ELS_EVENT_SHOW_GIFT_PROP_ANIMATION, this.onShowGiftPropAnimation,this);\n        tywx.NotificationCenter.listen(ELSEvent.ELS_EVENT_SHOW_CLEARN_ROW_EFFECT, this.onShowClearnRowEffect,this);\n        tywx.NotificationCenter.listen(ELSEvent.ELS_EVENT_REFRESH_ZHUBAO_COUNT, this.onShowAddZhuBaoEffect,this);\n        tywx.NotificationCenter.listen(ELSEvent.ELS_EVENT_SHOW_ICE_EFFECT, this.onUpdateIceBlock,this);\n        tywx.NotificationCenter.listen(ELSEvent.ELS_EVENT_ON_SHOW_ENDLESS_LEVEL_UP, this.onShowEndlessLevelUpEffect,this);\n        tywx.NotificationCenter.listen(ELSEvent.ELS_EVENT_ADD_ZHUBAO_ANIMATION, this.onAddZhuBaoAnimations,this);\n        tywx.NotificationCenter.listen(ELSEvent.ELS_EVENT_REFRESH_ZHUBAO_ANIMATION_POS, this.onRefreshZhuBaoAnimation,this);\n        tywx.NotificationCenter.listen(ELSEvent.ELS_EVENT_DELETE_ZHUBAO_ANIMATION, this.onDeleteZhuBaoAnimation,this);\n        tywx.NotificationCenter.listen(ELSEvent.ELS_EVENT_RESET_ZHUBAO_ANIMATION_POOL, this.resetZhuBaoAnimations,this);\n        tywx.NotificationCenter.listen(ELSEvent.ELS_EVENT_ENDLESS_SHOW_LEVEL_END, this.onEndelssShowLevelEnd,this);\n        tywx.NotificationCenter.listen(ELSEvent.ELS_EVENT_ENDLESS_ON_ZHUBAO_CHANGE, this.onEndlessZhuBaoChange,this);\n        // tywx.NotificationCenter.listen(ELSEvent.ELS_EVENT_CUNSOME_ITEM_SUCCESS, this.consume_item_success,this);\n    },\n\n    onDestroy(){\n        //! 注销事件监听\n        // tywx.NotificationCenter.ignore(ELSEvent.ELS_EVENT_MAGIC_BOTTLE_FULL, this.showGiftProp,this);\n        // tywx.NotificationCenter.ignore(ELSEvent.ELS_EVENT_ADD_PROP, this.onAddProp,this);\n        // tywx.NotificationCenter.ignore(ELSEvent.ELS_EVENT_HIDE_GIFT_PROP, this.hideGiftProp,this);\n        // tywx.NotificationCenter.ignore(ELSEvent.ELS_EVENT_ADD_MAGIC, this.addMagic,this);\n        // tywx.NotificationCenter.ignore(ELSEvent.ELS_EVENT_SHOW_MAGIC_ADD_EFFECT, this.showAddMagicEffect2,this);\n        tywx.NotificationCenter.ignoreScope(this);\n    },\n\n    loadRes(){\n        this.allBlockSpriteFrames = new Map();\n        this.allShadows = new Map();\n        var self = this;\n        cc.loader.loadResDir(\"image/blocks/\", cc.SpriteFrame, function (err, assets, urls) {\n            console.log('loadRes===>',err, assets, urls);\n            console.log(typeof self.allBlockSpriteFrames[0]);\n            assets.forEach(asset=>{\n                let name = asset.name;\n                self.allBlockSpriteFrames.set(name, asset);\n            });\n            self.initBlockSkinConfig();\n        });\n    },\n\n    initBlockSkinConfig(){\n        let type = [0,1,2,3]; ////[0,1,2,3,4];\n        let idx = [0,11];\n        this.blockConfigs =[];\n        for(let i = 0; i < type.length; i++){\n            let t = type[i];\n            let tmp_skin_config = new SkinConfig();\n            let block_frames = [];\n            for(let j = 0;j <= 10; j++){\n                let str_format = `b_${t}_${j}`;\n                if(this.allBlockSpriteFrames.has(str_format)){\n                    block_frames.push(this.allBlockSpriteFrames.get(str_format));\n                }\n                else{\n                    console.log('initBlockSkinConfigError===>',str_format);\n                }\n            }\n            for(let k = 0; k <= 8; k++){\n                let str_format = `shadow${k}`;\n                if(this.allBlockSpriteFrames.has(str_format)){\n                    block_frames.push(this.allBlockSpriteFrames.get(str_format));\n                }\n                else{\n                    console.log('initBlocksSkinConfigError===>',str_format);\n                }\n            }\n            tmp_skin_config.blocks = block_frames;\n            tmp_skin_config.localId = type;\n            this.blockConfigs.push(tmp_skin_config);\n        }\n        this.blockimgs = this.blockConfigs[0].blocks;\n        console.log('main/initBlockSkinConfig',this.blockConfigs);\n        // TODO: 初始皮肤\n        let _pf = parseInt(ElsUtils.loadItem(\"els_select_pifu\", 201)) - 201;\n        this.onChangeBlocks({\"idx\":_pf});\n\n        this.initZhuBaoFrames();\n    },\n    /**\n     * 初始化珠宝Frames\n     */\n    initZhuBaoFrames(){\n        this.zhuBaoFrames = [];\n        for(let i = 0; i < 3; i++){\n            let frame_name = `zhubao_${i}`;\n            if(this.allBlockSpriteFrames.has(frame_name)){\n                this.zhuBaoFrames.push(this.allBlockSpriteFrames.get(frame_name));\n            }\n        }\n    },\n    /**\n     * * 初始化珠宝动画\n     * ! 初始化珠宝动画缓存池\n     */\n    initZhuBaoAnimations(){\n        if(this.zhubaoAnimations && this.zhubaoAnimations.length > 0){\n            this.zhubaoAnimations.forEach(e=>{\n                e.destroy();\n            });\n        }\n        this.zhubaoAnimations = [];\n        this.createNewZhuBaoAnimations();\n    },\n    /**\n     * * 创建新的珠宝动画\n     * ! 每次只创建3个\n     */\n    createNewZhuBaoAnimations(){\n        let self = this;\n        // let loadCallback = (err,prefab)=>{\n        //     if(err) cc.err(err);\n        //     else{\n        //         let ani = cc.instantiate(prefab);\n        //         ani.parent = this.node.getChildByName('render_effect');\n        //         ani.active = false;\n        //         self.zhubaoAnimations.push(ani);\n        //     }\n        // };\n        //! 每次创建只增加三个\n        for(let i = 0; i < 3; i++){\n            //cc.loader.loadRes('prefab/els_view_zhubao',cc.Prefab,loadCallback);       \n            let ani = cc.instantiate(this.prefabZhuBaoAnimation);\n            ani.parent = this.node.getChildByName('render_effect');\n            ani.active = false;\n            self.zhubaoAnimations.push(ani); \n        }\n    },\n    /**\n     * * 从珠宝缓存池中获取没有被使用的珠宝\n     *\n     * @returns {Object} 珠宝动画实例\n     */\n    getZhuBaoAnimation(){\n        let ret = null;\n        if(this.zhubaoAnimations.length > 0){\n            ret = this.zhubaoAnimations[0];\n            this.zhubaoAnimations.splice(0,1);\n        }\n        //! 提前创建，保持缓存池总能取到\n        if(this.zhubaoAnimations.length <= 2){\n            this.createNewZhuBaoAnimations();\n        }\n        return ret;\n    },\n    /**\n     * \n     * @param {Number} row \n     * @param {Number} col \n     * @return {Object}\n     */\n    getZhuBaoAnimationByRowAndCol(row,col){\n        let ret = null;\n        let key = `${row}_${col}`;\n        this.zhubaoAnimationMap = this.zhubaoAnimationMap || new Map();\n        if(this.zhubaoAnimationMap.has(key)){\n            ret = this.zhubaoAnimationMap.get(key);\n        }\n        else{\n            ret = this.getZhuBaoAnimation();\n            this.zhubaoAnimationMap.set(key,ret);\n        }\n        ret.active = true;\n        return ret;\n    },\n    /**\n     * * 重置珠宝动画缓存池\n     * ! 将使用中的珠宝动画全部添加到没有使用的数组中\n     */\n    resetZhuBaoAnimations(){\n        //console.log(`resetZhuBaoAnimations==>${this.zhubaoAnimationMap.size()}===>${this.zhubaoAnimationMap}`);        \n        this.zhubaoAnimationMap = this.zhubaoAnimationMap || new Map();\n        this.zhubaoAnimationMap.forEach((v,k)=>{\n            this.zhubaoAnimations.push(v);\n            v.active = false;\n        });\n        this.zhubaoAnimationMap.clear();\n        //console.log(`resetZhuBaoAnimations==>${this.zhubaoAnimationMap.size()}===>${this.zhubaoAnimationMap}`);\n    },\n    /**\n     * * 添加珠宝动画\n     *\n     * @param {Object} params\n     * @param {Number} params.row\n     * @param {Number} params.col\n     * @param {Number} params.type\n     */\n    onAddZhuBaoAnimations(params){\n        console.log(`onAddZhuBaoAnimations===>${params}`);\n        let zhubao = this.getZhuBaoAnimationByRowAndCol(params.row, params.col);\n        zhubao.getComponent('els_view_block').showZhuBaoAnimationByIdx(params.type - 112);\n        zhubao.position = this.blocks[0][params.row][params.col].rawpos;\n        let game = tywx.UIManager.game;\n        zhubao.active = game.model.endless_level === 1;\n        console.log(`onAddZhuBaoAnimations===>${params}`,zhubao,zhubao.position);\n    },\n    onEndelssShowLevelEnd(){\n        this.zhubaoAnimationMap = this.zhubaoAnimationMap || new Map();\n        this.zhubaoAnimationMap.forEach((v,k)=>{\n            //this.zhubaoAnimations.push(v);\n            v.active = true;\n        });\n    },\n    /**\n     * * 刷新珠宝动画位置\n     * ！即将废弃\n     * @param {Object} params\n     * @param {Number} params.row\n     * @param {Number} params.col\n     * @param {Number} params.type\n     * @param {bool} params.is_down\n     */\n    onRefreshZhuBaoAnimation(params){\n        let zhubao = this.getZhuBaoAnimationByRowAndCol(params.row, params.col);\n        let n_row = params.is_down ? params.row - 1 : params.row + 1;\n        let n_key = `${n_row}_${params.col}`;\n        console.log(`onRefreshZhuBaoAnimation==>${n_row},${n_key}`);\n        if(!this.zhubaoAnimationMap.has(n_key)){\n            this.zhubaoAnimationMap.set(n_key,zhubao);\n            this.zhubaoAnimationMap.delete(`${params.row}_${params.col}`);\n            zhubao.position = this.blocks[0][n_row][params.col].rawpos;\n        }\n        else{\n            throw new Error('onRefreshZhuBaoAnimation');\n        }\n    },\n    /**\n     * * 删除珠宝动画\n     *\n     * @param {Object} params\n     * @param {Number} params.row\n     * @param {Number} params.col\n     * @param {Number} params.type\n     */\n    onDeleteZhuBaoAnimation(params){\n        let zhubao = this.getZhuBaoAnimationByRowAndCol(params.row, params.col);\n        zhubao.active = false;\n        this.zhubaoAnimationMap.delete(`${params.row}_${params.col}`);\n        this.zhubaoAnimations.push(zhubao);\n    },\n    /**\n     * * 珠宝发生变化回调\n     *\n     * @param {Array} zhubao_arr [{type:number,row:number,col:number}]\n     */\n    onEndlessZhuBaoChange(zhubao_arr){\n        // ? shadow作为是否显示的标识，后面考虑是否加一个变量来控制\n        if(!this.shadow.active) return;\n        this.resetZhuBaoAnimations();\n        let zhubao_datas = zhubao_arr;\n        for(let i = 0; i < zhubao_datas.length; i++){\n            let tmp_data = zhubao_datas[i];\n            let tmp_zhubao_ani = this.getZhuBaoAnimationByRowAndCol(tmp_data.row,tmp_data.col);\n            tmp_zhubao_ani.position = this.blocks[0][tmp_data.row][tmp_data.col].rawpos;\n            tmp_zhubao_ani.getComponent('els_view_block').showZhuBaoAnimationByIdx(tmp_data.type - 112);\n        }\n    },\n    /**\n     * 皮肤更新事件\n     *\n     * @param {Object} params  params.idx 本地皮肤id\n     */\n    onChangeBlocks(params){\n        let idx = params.idx || 0;\n        let s2l = {\n            0:0,\n            1:2,\n            2:3,\n            3:1\n        };\n        idx = s2l[idx];\n        if(idx >= this.blockimgs.length) idx = 0;\n        this.blockimgs = this.blockConfigs[idx].blocks;\n    },\n\n    init : function () {\n        this.lbl_next = this.node.getChildByName('next');\n        this.lbl_hold = this.node.getChildByName('hold');\n        //this.yanhua = this.node.getChildByName(\"yanhua\");\n        this.yanhua = this.nodeYanHua;\n        this.backmask = this.node.getChildByName('backmask');\n\n        // this.game_mask = this.gleNode.getChildByName('game_mask');\n        // this.mask_btn = this.game_mask.getChildByName('mask_btn');\n        // this.mask_btn.on(cc.Node.EventType.TOUCH_END, this.mask_btn_click, this);\n\n        this.add5step = this.gleNode.getChildByName('add5step');\n        this.add5step.opacity = 0;\n        this.share5line = this.gvsNode.getChildByName('share-5');\n//        this.share5line.opacity = 0;\n        this.share5line.active = false;\n        this.share5step = this.gleNode.getChildByName('share+5');\n        this.share5line.active = false;\n//        this.share5step.opacity = 0;\n        //* 添加spine动画\n        this.animShare5Line = cc.instantiate(this.prefabGiftAnimation);\n        this.animShare5Line.getComponent('shareGiftAnimationView').init('分享到群\\n减5行');\n        this.animShare5Line.parent = this.share5line;\n\n        this.animShare5Step = cc.instantiate(this.prefabGiftAnimation);\n        this.animShare5Step.getComponent('shareGiftAnimationView').init('分享到群\\n加5步');\n        this.animShare5Step.parent = this.share5step;\n        //暂停面板\n        this.pause = this.pause; //this.node.getChildByName('pause');\n\n        this.lbl_time = this.node.getChildByName('time');\n        this.lbl_antiscore = this.node.getChildByName('lbl_antiscore');\n        this.lbl_progress = this.node.getChildByName('lbl_progress');\n        this.lbl_title = this.node.getChildByName('lbl_title');\n        this.lbl_myscore = this.node.getChildByName('lbl_myscore');\n        this.lbl_endless_score = this.node.getChildByName('lbl_endless_score');\n        this.back = this.node.getChildByName('back');\n\n\n        this.maintips = this.node.getChildByName('maintips');\n\n        this.shadow = this.node.getChildByName('shadow');\n        this.shadow.scale = 9.8 / els.HENG;\n        this.mask = this.node.getChildByName('mask');\n        //this.ad = this.node.getChildByName('ad');\n        this.timestep = this.node.getChildByName('timestep');\n        this.combo = [];\n        this.combo[0] = this.node.getChildByName('combo0');\n        this.combo[1] = this.node.getChildByName('combo1');\n        //生成精灵\n        this.node.getChildByName('back').removeAllChildren();\n        this.blocks = [[], []];\n        for (var n = 0; n < 2; n++) {\n            for (var i = 0, il = els.ZONG; i < il; i++) {\n                this.blocks[n][i] = new Array(els.HENG + 1);\n                for (var j = 0, jl = els.HENG + 1; j < jl; j++) {\n                    var c = cc.instantiate(this.prefabblock);\n                    this.blocks[n][i][j] = c;\n                    var scale = n == 0 ? 6.6 / els.HENG  : 2.4 / els.HENG ;\n                    var bsize = 72 * scale + 2;\n                    c.scale = scale;\n                    c.rawscale = c.scale;\n                    this.setBlkColor(c, 0, 8);\n                    //自己方块区域\n                    if (n == 0) {\n                        c.position = cc.v2(216 + (j+0.5) * bsize, 215 + (i+0.5) * bsize); //自己202\n                        c.rawpos = c.position;\n                    }\n                    if (n == 1) {\n                        c.position = cc.v2(14 + (j+0.5) * bsize, 796 + (i+0.5) * bsize); //AI  796\n                        c.rawpos = c.position;\n                    }\n                    c.parent = this.node.getChildByName('back');\n                }\n            }\n        }\n        this.ice_blocks = [];\n        var self = this;\n        cc.loader.loadRes(\"prefab/ice_block\", function(err, prefab) {\n          var preFabNode = cc.instantiate(prefab);\n          for (var j = 0, jl = els.HENG; j < jl; j++) {\n            var c = cc.instantiate(preFabNode);\n            self.ice_blocks[j] = c;\n            var scale = 6.6 / els.HENG;\n            var bsize = 72 * scale + 2;\n            c.scale = scale;\n            c.rawscale = c.scale;\n            c.opacity = 0;\n            c.position = cc.v2(216 + (j + .5) * bsize, 215 + .5 * bsize);\n            c.rawpos = c.position;\n            c.parent = self.node.getChildByName(\"render_effect\");\n          }\n        });\n        this.holdnext = [[], [], []];\n        var by = [295, 530, 430];\n        for (var n = 0; n < 3; n++) {\n            for (var i = 0; i < 4; i++) {\n                this.holdnext[n][i] = new Array(4);\n                for (var j = 0; j < 4; j++) {\n                    var c = cc.instantiate(this.prefabblock);\n                    this.holdnext[n][i][j] = c;\n                    c.scale = 0.18;\n                    var bsize = 72 * c.scale + 2;\n                    this.setBlkColor(c, 50, 10);\n                    //这里是左边方块的坐标\n                    c.position = cc.v2(72 + (j+0.5) * bsize, 170 + by[n] - (i+0.5) * bsize);\n                    c.parent = this.node.getChildByName('back');\n                }\n            }\n        }\n        //attack...\n        this.node.getChildByName('anim').removeAllChildren();\n        this.attani = [[[], [], [], [], []], [[], [], [], [], []]];\n        var scaletail = [2.0, 1.5, 1.35, 1.2, 1.05, 0.9];\n        var op = [255, 255, 220, 190, 160, 130];\n        for (var n = 0; n < 2; n++) {\n            for (var i = 0; i < 5; i++) {\n                this.attani[n][i] = new Array(6);\n                for (var j = 0; j < 6; j++) {\n                    var c = (j == 0) ?\n                        cc.instantiate(this.prefabattack0) :\n                        cc.instantiate(this.prefabattack1);\n                    this.attani[n][i][j] = c;\n                    c.scale = scaletail[j];\n                    c.opacity = op[j];\n                    c.getComponent(cc.Sprite).setVisible(false);\n                    c.parent = this.node.getChildByName('anim');\n                }\n            }\n        }\n        //! 魔法瓶特效\n        this.magicAni = [];\n        for(let n = 0; n < 40; n++){\n            let c = (n % 2 === 0) ?cc.instantiate(this.prefabattack0) :cc.instantiate(this.prefabattack1);\n            this.magicAni.push(c);\n            c.opacity = 180;\n            c.active = false;\n            c.parent = this.node.getChildByName('anim');\n        }\n\n\n        this.nodeProp1Using.active = false;\n        this.nodeProp2Effect.active = false;\n    },\n\n    // 更新\n    onUpdateIceBlock (step) {\n        step = step > 5 ? 5 : step;\n        let op = step > 0 ? step * 30 : 0;\n        this.ice_blocks.forEach((item) => {\n          item.opacity = op;\n        });\n    },\n\n    start() {\n        this.init();\n        this.singleView = this.gleNode.getComponent(\"gameSinglemode\");\n        this.vsView = this.gvsNode.getComponent(\"gameVSmode\");\n\n\n        var m = new ElsModel(ElsGrid);\n        var r = new ElsRender();\n        var game = new ElsGame(m, r);\n        var tou = new ElsTouch(game);\n        this.tou = tou;\n        m.tou = tou;\n        game.initGame(this.node, 0, parseInt(Math.random() * 10000));\n\n        m.setGameStatus(els.ELS_GAME_STATE.HOMEPAGE);\n        this.game = game;\n        tywx.UIManager.init(this.game);\n\n        //help1st 0:show 1:hidden\n        game.model.begin_help1st = -1;\n        //0: 初始化 1:动画\n        game.model.begin_cd = -1;\n        //监控 胜利界面的例子动画\n        game.model.begin_win_partical = -1;\n\n        /// 去掉轮播\n        if (parseInt(game.loadItem(\"ELS_HELP1ST\", 0)) === 0)\n            game.model.needhelp1st = false;//game.model.needhelp1st = true;\n        else\n            game.model.needhelp1st = false;\n        game.model.pkstar = parseInt(game.loadItem(\"ELS_PKSTAR\", 0));\n        game.model.pkstar = !game.model.pkstar ? 0 : game.model.pkstar;\n        game.updatePKStar(0);\n        this.frametime = 0;\n        nge.run(this.game);\n\n        tywx.UIManager.showUI(els.ELS_GAME_LAYER.HOMEPAGE, null ,false);\n\n        this.getWXUserInfo();\n        this.getFriendCloudStorage();\n\n        this.magicBottle = this.nodeMaticBottle.getComponent('MagicBottleView');\n        if(this.magicBottle){\n            this.magicBottle.reset();\n            this.magicBottle.init(this.game);\n        }\n\n        this.refreshPropCount();\n        //! init gift box\n        this.gift_view = cc.instantiate(this.prefabGiftPropView);\n        this.gift_view.parent = this.nodePop;\n        this.gift_view.active = false;\n\n        // init prop magic wand animation\n        let ani_magic_wand = this.nodeProp2Effect.getComponent(cc.Animation);\n        let self = this;\n        ani_magic_wand.on('finished', (num, string)=>{\n            console.log('ani_magic_wand finished',num, string);\n            self.nodeProp2Effect.active = false;\n            self.game.model.mgrid[0].clearnBottomLinesByCount(1);\n        }, this);\n        // this.nodePop.getChildByName(\"tcp_node\").getComponent(\"tcp_node\").game_show();\n        this.checkReward();\n        //this.refreshSoundTag();\n\n        cc.loader.loadRes('prefab/OpenData', function (err, prefab) {\n            var preFabNode = cc.instantiate(prefab);\n            // preFabNode.parent = self.node;\n            self.node.insertChild(preFabNode, 0);\n            self.beyondOpenData = preFabNode;\n        });\n    },\n    // 检查 奖励:: 1.悄悄话 2.每日\n    checkReward(){\n        // 每日登陆奖励\n        if(!tywx.UserInfo.loginReward) return;\n        if (tywx.UserInfo.loginReward.get === 1) { // 2\n            let self = this;\n            cc.loader.loadRes('prefab/els_view_daliy_login',cc.Prefab,(err,prefab)=>{\n                if(err) cc.error(err.message || err);\n                else{\n                    let daily_login = cc.instantiate(prefab);\n                    daily_login.getComponent('els_view_daliy_login').init();\n                    daily_login.parent = self.nodePop;\n                }\n            });\n        }\n    },\n\n    showAddMagicEffect2(){\n        console.log('show add magic effect ===> main');\n        this.magicBottle.showAddMagicEffect();\n    },\n\n    getNextUserInfo(){\n        tywx.next_current_stage_user = undefined;\n        tywx.next_pk_user = undefined;\n        let getdat = function (_type, data) {\n            if (!data) {\n                return undefined;\n            }\n            let d = undefined;\n            for (let i = 0; i < data.length; i ++){\n                if (data[i].key == _type) {\n                    d = data[i].value;\n                }\n            }\n            return parseInt(d);\n        };\n\n        for (let i = 0; i < this.pk_star_data.length; i ++) {\n            let t = this.pk_star_data[i];\n            if (t.nickname == tywx.WXUserInfo.nickName && t.avatarUrl == tywx.WXUserInfo.avatarUrl) {\n                tywx.UserRankData = t;\n            }\n        }\n        var next_pk_star_data = undefined;\n        var next_current_stage = undefined;\n        let user_data = tywx.UserRankData.KVDataList.length > 0 ? tywx.UserRankData.KVDataList : undefined;\n\n        for (let i = 0; i < this.pk_star_data.length; i ++) {\n            let t = this.pk_star_data[i];\n            let data = t.KVDataList.length > 0 ? t.KVDataList : undefined;\n\n            if (getdat(\"ELS_PKSTAR\", data) > getdat(\"ELS_PKSTAR\", user_data)) {\n                if (!next_pk_star_data) {\n                    next_pk_star_data = data;\n                    tywx.next_pk_user = t;\n                }\n                if (getdat(\"ELS_PKSTAR\", data) < getdat(\"ELS_PKSTAR\", next_pk_star_data)) {\n                    next_pk_star_data = data;\n                    tywx.next_pk_user = t;\n                }\n            }\n\n            if (getdat(\"ELS_CURRENT_STAGE2\", data) > getdat(\"ELS_CURRENT_STAGE2\", user_data)) {\n                if (!next_current_stage) {\n                    next_current_stage = data;\n                    tywx.next_current_stage_user = t;\n                }\n                if (next_current_stage && getdat(\"ELS_CURRENT_STAGE2\", data) < getdat(\"ELS_CURRENT_STAGE2\", next_current_stage)) {\n                    next_current_stage = data;\n                    tywx.next_current_stage_user = t;\n                }\n            }\n        }\n        console.log(\"getNextUserInfo\");\n    },\n\n    getFriendCloudStorage(cal){\n        try {\n            let self = this;\n            tywx.OpenDataContextUtil.getFriendCloudStorage(['ELS_PKSTAR', 'ELS_CURRENT_STAGE2'], function (para) {\n                //console.log(JSON.stringify(para));\n                self.pk_star_data = para;\n                self.getNextUserInfo();\n                if (cal){\n                    cal();\n                }\n            },function (para) {\n                console.log(JSON.stringify(para));\n            });\n        } catch(e) {\n        }\n    },\n\n    getWXUserInfo(){\n        try {\n            let self = this;\n            tywx.OpenDataContextUtil.getUserInfo(\n                function (ret) {\n                    console.log(\"ret-->\" + ret);\n                    tywx.WXUserInfo = ret[0];\n                    self.getFriendCloudStorage();\n                },\n                function (ret) {\n                    console.log(ret);\n                });\n        } catch (e){\n            tywx.WXUserInfo = undefined;\n        }\n    },\n\n    refreshBgAdapter(){\n        //if()\n    },\n\n    onStatusChange : function (status) {\n        switch (status){\n            case els.ELS_GAME_STATE.PLAYING:\n                this.refreshShow(this.game.model.mconf.mode);\n                break;\n            case els.ELS_GAME_STATE.RESULT_LOSE:\n                this.showGameLost();\n                break;\n            case els.ELS_GAME_STATE.RESULT_WIN:\n                this.showGameWin();\n                break;\n            case els.ELS_GAME_STATE.KEEPSTAR:\n                this.vsView.showKeepStar();\n                break;\n            case els.ELS_GAME_STATE.SEARCH_AI:\n                tywx.UIManager.showUI(els.ELS_GAME_LAYER.GAME_SEARCH_AI);\n                break;\n            case els.ELS_GAME_STATE.SHOW_REVIVE:\n                this.singleView.showRevive();\n                break;\n        }\n    },\n\n    emergencyShare : function () {\n        this.game.emergencyShare();\n    },\n\n    showGameLost : function () {\n        if(this.game.model.mconf.mode === els.ELS_MODE_SINGLE) {\n            //this.magicBottle.reset();\n            this.singleView.showLose();\n        } else{\n            this.vsView.showLose();\n        }\n    },\n\n    showGameWin : function () {\n        if(this.game.model.mconf.mode === els.ELS_MODE_SINGLE) {\n            //this.magicBottle.reset();\n            this.singleView.showWin();\n        } else{\n            this.vsView.showWin();\n        }\n    },\n\n    btnPause : function () {\n        if (this.game.model.getGameStatus() === els.ELS_GAME_STATE.PLAYING) {\n           this.pause.active = true;\n           this.game.pauseGame();\n           this.refreshSoundTag();\n        }\n    },\n\n    btnContinue : function () {\n        this.pause.active = false;\n        this.game.continueGame();\n    },\n\n    btnBackToHome : function () {\n        this.pause.active = false;\n        tywx.UIManager.hideAllUI();\n        this.game._backToHomePage();\n        tywx.UIManager.showUI(els.ELS_GAME_LAYER.HOMEPAGE);\n    },\n    touchStart(event) {\n        var t1 = event.getLocation();\n        var temp = this.node.convertToNodeSpace(t1);\n        this.tou.began(temp.x, temp.y);\n    },\n\n    touchMove(event) {\n        var t1 = event.getLocation();\n        var temp = this.node.convertToNodeSpace(t1);\n        this.tou.moved(temp.x, temp.y);\n    },\n\n    touchEnd(event) {\n        var t1 = event.getLocation();\n        var temp = this.node.convertToNodeSpace(t1);\n        this.tou.ended(temp.x, temp.y);\n    },\n\n    update(dt) {\n        this.frametime += dt;\n        if (this.frametime >= 0.02) {\n            this.frametime = 0;\n            nge.run(this.game);\n        }\n    },\n\n    setBlkColor(c, op, idx, scale, r) {\n        var cmap = [0, 9, 1, 2, 3, 4, 5, 6, 7, 8, 0, 0];\n        if(c.rawpos) c.position = c.rawpos;\n        if(c.rawscale) c.scale = c.rawscale;\n        c.opacity = op;\n        c.rotation = 0 || r;\n        c.scale = c.scale || c.scale * scale;\n        if(ElsUtils.isZhubao(idx + 100)){\n            /// 珠宝\n            c.getComponent('cc.Sprite').spriteFrame = this.zhuBaoFrames[idx - 12];//\n            //let zhubao_ani = this.getZhuBaoAnimation();\n            //zhubao_ani.getComponent('els_view_block').showZhuBaoAnimationByIdx(idx - 12);\n        }\n        else{\n            c.getComponent('cc.Sprite').spriteFrame = this.blockimgs[cmap[idx]];\n        }\n    },\n\n    refreshShow : function (mode) {\n        this.pause.active = false;\n        if (mode !== els.ELS_MODE_SINGLE) {\n            this.timestep.getComponent('cc.Label').string = '时间';\n            this.nodeProp0.active = false;\n            this.nodeProp1.active = false;\n            this.nodeProp2.active = false;\n            this.nodeProp3.active = false;\n            this.nodeMaticBottle.active = false;\n            this.onUpdateIceBlock(0);\n        } else {\n            this.timestep.getComponent('cc.Label').string = '剩余步数';\n            this.nodeProp0.active = true;\n            this.nodeProp1.active = true;\n            if (this.game.model.mconf.isEndless) {\n                this.nodeProp3.active = true;\n                this.nodeProp2.active = false;\n            } else {\n                this.nodeProp2.active = true;\n                this.nodeProp3.active = false;\n                this.onUpdateIceBlock(0);\n            }\n            this.nodeMaticBottle.active = true;\n        }\n    },\n\n    /**\n     * 展示连击动画\n     * \n     * @param {int} combo_count\n     */\n    showCombo(combo_count){\n        let combo = cc.instantiate(this.prefabCombo);\n        combo.parent = this.node;\n        combo.position = cc.p(400,840);\n        combo.getComponent('ComboAnimation').init(true, combo_count);\n    },\n\n    /**\n     * 播放消除动画\n     * \n     * @param {int} clear_count 消除的行数\n     */\n    showClearAnimation(clear_count) {\n        console.log('showClearAnimation',clear_count);\n        let combo = cc.instantiate(this.prefabCombo);\n        combo.parent = this.node;\n        combo.position = cc.p(420,840);\n        combo.getComponent('ComboAnimation').init(false, clear_count);\n    },\n\n    showBeyondNode(_type) {\n        if (!_type) {\n            return;\n        }\n        this.beyondOpenData.getComponent(\"OpenData\").showBeyond(_type);\n    },\n\n    hidenBeyondNode(){\n    },\n\n    //! 使用塌陷道具\n    usePropSink(){\n        if(this.usePropByKey(ELSProfile.PROP_TYPES.PROP_0)){\n            this.refreshPropCount();\n            let self = this;\n            let cb = ()=>{\n                self.game.sinkAllCol(0);\n            };\n            this.showHammerEffect(0,cb);\n        }\n        else{\n            //! 使用道具失败\n        }\n    },\n    //! 使用火箭道具\n    usePorpRocket(){\n        if(this.usePropByKey(ELSProfile.PROP_TYPES.PROP_1)){\n            this.refreshPropCount();\n            let datas = this.game.fillRandomBlock(0,5);\n            this.showRocketEffectByData(0,datas);\n        }\n        else{\n            //! 使用道具失败\n        }\n    },\n    showRocketEffectByData(usr_idx, datas){\n        tywx.NotificationCenter.trigger(ELSEvent.ELS_EVENT_SET_MAGIC_BUSY,true);\n        this.nodeProp1Using.active = true;\n        let self = this;\n        let ani_count = 0;\n        let end_cb = ()=>{\n            ani_count--;\n            if(ani_count <= 0) {\n                self.nodeProp1Using.active = false;\n                self.game.clearnRow(usr_idx);\n                tywx.NotificationCenter.trigger(ELSEvent.ELS_EVENT_SET_MAGIC_BUSY,false);\n            }\n        };\n        this.game.model.playMusic(els.ELS_VOICE.DAODAN_MUSIC, false);\n        for(let data of datas){\n            console.log(data);\n            let x = data[0];\n            let y = parseInt((data[1] - 2 - x) / els.GRIDW);\n\n            let nodeBlock = this.blocks[usr_idx][els.ZONG - y - 1][x];\n            let prop_pos = this.arrPropPlaceHolder[1];\n            let parent = this.node.getChildByName('back');\n            //! 1.显示瞄准镜; 2. 移动动画; 3. 爆裂动画，同时显示\n            let aimAt = cc.instantiate(this.prefabAimAtBlock);\n            aimAt.parent = parent;\n            aimAt.position = nodeBlock.position;\n\n            let rocketMove = cc.instantiate(this.prefabRocketMoveParticle);\n            rocketMove.parent = parent;\n            rocketMove.position = prop_pos.position;\n            let moveEndCB = ()=>{\n                rocketMove.removeFromParent();\n                aimAt.removeFromParent();\n                let boom = cc.instantiate(this.prefabRocketMoveEndBoom);\n                boom.parent = parent;\n                boom.position = nodeBlock.position;\n                boom.runAction(cc.sequence(\n                    cc.callFunc(function(){\n                        self.game.fillGridByIndex(usr_idx,data[1]);\n                    }),\n                    cc.delayTime(0.1),\n                    cc.callFunc(end_cb),\n                    cc.removeSelf()\n                    \n                ));\n            };\n            rocketMove.runAction(\n                cc.sequence(\n                    cc.moveTo(0.5,nodeBlock.position),\n                    cc.callFunc(moveEndCB)\n                )\n            );\n            ani_count++;\n        }\n    },\n    showHammerEffect(usr_idx,cb){\n        tywx.NotificationCenter.trigger(ELSEvent.ELS_EVENT_SET_MAGIC_BUSY,true);\n        let effect = cc.instantiate(this.prefabProp0Effect);\n        effect.parent = this.nodeProp0Effect;\n        let ani = effect.getComponent(cc.Animation);\n        let self = this;\n        this.game.model.playMusic(els.ELS_VOICE.CHUI_MUSIC, false);\n        this.showClearnTopCol(0.3);        \n        ani.on('finished', (num, string)=>{\n            console.log('hammer finished',num, string);\n            //! 回调\n            if(cb) cb();\n            effect.runAction(\n                cc.sequence(\n                    cc.delayTime(0.3),\n                    cc.callFunc(()=>{\n                        self.game.clearnRow(usr_idx);\n                        tywx.NotificationCenter.trigger(ELSEvent.ELS_EVENT_SET_MAGIC_BUSY,false);\n                    }),\n                    cc.removeSelf()\n                )\n            );\n        }, this);\n        \n    },\n    showGiftProp(){\n        let self = this;\n        setTimeout(()=>{\n            // if(self.game.model.getGameStatus() !== els.ELS_GAME_STATE.PLAYING){\n            //     return;\n            // }\n            //self.game.pauseGame();\n            if(!self.gift_view){\n                self.gift_view = cc.instantiate(self.prefabGiftPropView);\n                self.gift_view.parent = self.nodePop;\n                self.gift_view.getComponent('els_gift_prop_view').init(self.game);\n                self.gift_view.getComponent('els_gift_prop_view').showGiftBox();\n            }\n            else{\n\n                self.gift_view.getComponent('els_gift_prop_view').init(self.game);\n                self.gift_view.getComponent('els_gift_prop_view').showGiftBox();\n                self.gift_view.active = true;\n            }\n            \n        },1000);\n        \n    },\n    hideGiftProp(){\n        this.game.continueGame();\n        this.gift_view.active = false;\n    },\n    //! {type:0,num:1}\n    onAddProp(){\n        console.log('onAddProp');\n        //! 更新数据\n        //ELSProfile.getInstance().addPropByKey(param.type,param.num);\n        // let prop_num = this.game.loadItem(`prop_${param.type}`,els.PROP_DEAFULT_VALUE);\n        // this.game.saveItem(`prop_${param.type}`,parseInt(prop_num) + param.num);\n        //! 刷新显示\n        this.refreshPropCount();\n    },\n    getPropByKey(key){\n        let prop_key = `prop_${key}`;\n        return this.game.loadItem(prop_key,els.PROP_DEAFULT_VALUE);\n    },\n    usePropByKey(_, _key){\n        // this.do_consume_item(0);\n        // return;\n        //! 没有连接到服务器或者SDK登陆失败，不能使用道具\n        if(tywx.TCPClient.connectStatus !== tywx.TCPClient.CONNECT_STATUS_OK || tywx.UserInfo.userId === 0)\n        {\n            wx.showToast({\n                title: '网络异常',\n                duration: 1000,\n            });\n            return;\n        }\n        let key = parseInt(_key);\n        if (key === 0 && tywx.UserInfo.getPropCountByKey(key) === 0) { // 锤子数目为0\n            this.showUnlockUI();\n            return;\n        }\n        if (tywx.MSG.consumeItem(tywx.UserInfo.local2Server(key))) {\n            this.do_consume_item(key);\n            this.refreshPropCount();\n        }\n    },\n\n    showUnlockUI(){\n        let self = this;\n        cc.loader.loadRes('prefab/unlock', function (err, prefab) {\n            self.game.pauseGame();\n            var preFabNode = cc.instantiate(prefab);\n            preFabNode.parent = tywx.UIManager.getCurrentUI();\n        });\n    },\n\n    //! 刷新道具数量\n    refreshPropCount(){\n        for(let i = 0; i < this.arrPropCount.length; i++){\n            let tmp_count = this.arrPropCount[i];\n            let prop_num = tywx.UserInfo.getPropCountByKey(i);\n            tmp_count.string = `${prop_num}`;\n            console.log('refreshPropCount',`x${prop_num}`);\n        }\n    },\n    addMagic(value){\n        if(this.game.model.mconf.mode !== els.ELS_MODE_SINGLE) return;\n        this.magicBottle.addMagic(value);\n    },\n    showAddMagicEffect(){\n        //! 闯关模式才有魔法瓶和道具\n        //if(this.game.model.mconf.mode !== els.ELS_MODE_SINGLE) return;\n        let end_pos = this.nodeMagicBottlePlaceHolder.position;\n        let self = this;\n        let count = 0;\n        let animation_cb = (target)=>{\n            target.active = false;\n            count--;\n            if(count === 0){\n                //self.magicBottle.showAddMagicEffect();\n            }\n        };\n\n        let fr = this.game.model.mgrid[0].mcore.fullrows;\n        for(let i = 0; i < fr.length; i++){\n            for(let j=0; j<els.HENG; j++) {\n                if(count >= this.magicAni.length) return;\n                let e = this.magicAni[count];\n                let b = this.blocks[0][i][j];\n                e.position = b.rawpos;\n                e.active = true;\n                count++;\n                e.runAction(\n                    cc.sequence(\n                        cc.delayTime(0.2 * Math.random()),\n                        cc.spawn(\n                            cc.rotateBy(0.5, 1800), \n                            cc.moveTo(0.5, end_pos)\n                        ),\n                        cc.callFunc(animation_cb,e)\n                    )\n                );\n            }\n        }\n    },\n    /**\n     * 使用魔法棒\n     *\n     */\n    onUseMagicWand(){\n        console.log('onUseMagicWand');\n        this.nodeProp2Effect.active = true;\n        let ani = this.nodeProp2Effect.getComponent(cc.Animation);\n        if(ani){\n            ani.play();\n        }\n    },\n\n    onUseIceB () {\n        console.log(\"use ice bom\");\n        this.game.setFreezeStep();\n        this.onUpdateIceBlock(5);\n    },\n\n    // 消耗道具成功\n    consume_item_success(params) {\n        let self = this;\n        let _items = params.result.items;\n        _items.forEach(function (_item) {\n            let _type = tywx.UserInfo.server2local(_item.itemId);\n            self.do_consume_item(_type);\n        });\n    },\n\n    do_consume_item(_type) {\n        if (_type === 3) { // 冰弹\n            this.onUseIceB();\n        }   \n        if (_type === 2) { // 魔法棒\n            this.onUseMagicWand();\n        }\n        if (_type === 1) { // 火箭\n            let datas = this.game.fillRandomBlock(0, 5);\n            this.showRocketEffectByData(0, datas);\n        }\n        if (_type === 0) { // 锤子\n            let self = this;\n            let current_endless = this.game.model.endless_level;\n            let is_endless = this.game.model.mconf.isEndless;\n            let cb = () => {\n                let t_endless = self.game.model.endless_level;\n                if(is_endless && t_endless === current_endless){\n                    self.game.sinkAllCol(0);\n                }\n                if(!is_endless) self.game.sinkAllCol(0);\n            };\n            this.showHammerEffect(0, cb);\n        }\n    },\n\n    showClearnTopCol(delay_time = 0.5){\n        let pg = this.game.model.mgrid[0];\n        let ct = pg.mcore.col_top;\n        let parent = this.node.getChildByName('back');\n        let self = this;\n        let delayTime = delay_time;\n        for(let i = 0; i < ct.length; i++){\n            let r = els.ZONG - ct[i];\n            let idx = r * els.GRIDW + i + 2;\n            if(pg.mcore.grid[idx] > 100 && pg.mcore.grid[idx] !== 200){\n                //! 1.显示瞄准镜\n                let c = this.blocks[0][ct[i] - 1][i];\n                let aimAt = cc.instantiate(this.prefabAimAtBlock);\n                aimAt.parent = parent;\n                aimAt.position = c.position;\n                aimAt.runAction(\n                    cc.sequence(\n                        cc.delayTime(delayTime),\n                        cc.removeSelf()\n                    )\n                );\n            }\n            \n        }\n\n        setTimeout(()=>{\n            self.game.usePopMagicWand(0);\n        },delayTime * 1000 / 2);\n    },\n\n    /**\n     * 帮助\n     */\n    onHelpHandler() {\n        tywx.UIManager.showUI(els.ELS_GAME_LAYER.HELP);\n    },\n\n    /**\n     * 音量反选\n     */\n    unSelectSound(){\n        ELSProfile.getInstance().switchMusicMute();\n        this.refreshSoundTag();\n    },\n\n    /**\n     *  刷新音量标识\n     */\n    refreshSoundTag() {\n        if (ELSProfile.getInstance().getIsMusicMute()) {\n            this.soundTag.active = true;\n            this.game.model.playMusic(els.ELS_VOICE.BG_MUSIC, true, 0.4);\n            this.game.model.playMusic(els.ELS_VOICE.DAODAN_MUSIC, false);\n        } else {\n            this.soundTag.active = false;\n            this.game.model.playRandomBgMusic();\n        }\n    },\n    /**\n     * \n     * @param {Object} params params.prop_id, params.type \n     */\n    onShowGiftPropAnimation(params){\n        let self = this;\n        cc.loader.loadRes('prefab/els_view_prop_animation_display',cc.Prefab,(err,prefab)=>{\n            if(err) cc.error(err.message || err);\n            else{\n                let animation_display = cc.instantiate(prefab);\n                animation_display.getComponent('els_view_porp_animation_display').init(params.prop_id,params.type);\n                animation_display.parent = self.nodePop;\n            }\n        });\n    },\n    /**\n     * \n     * @param {Object} params 回调参数\n     * @param {Number} params.row 需要消除的行\n     * @param {Function} params.cb 动画完成分类\n     */\n    onShowClearnRowEffect(params){\n        let row = params.row;\n        let cb = params.cb || null;\n        this.showClearnLineEffectByRow(row, cb);\n    },\n    /**\n     * \n     * @param {Number} row 行号\n     * @param {Function} end_cb 动画结束回调\n     */\n    showClearnLineEffectByRow(row, end_cb = null){\n        let bsize = 72 * (6.6 / els.HENG) + 2;\n        let pos = cc.v2(195 + (5 + 0.5) * bsize, 215 + (row + 1) * bsize - 0.5 * bsize);//* 0.5\n        let self = this;\n        //! 强制隐藏block\n        let hide_block = ()=>{\n            let r = els.ZONG - row - 1; \n            for(let i = 0; i < els.HENG; i++){\n                self.blocks[0][row][i].opacity = 0;    \n                self.blocks[0][r][i].opacity = 0;    \n            }\n        }; \n        cc.loader.loadRes('prefab/els_view_effect_clearn_line',cc.Prefab,(err,prefab)=>{\n            if(err) cc.err(err.message || err);\n            else{\n\n                let effect = cc.instantiate(prefab);\n                effect.parent = this.node.getChildByName('render_effect');\n                effect.position = pos;\n                let animation = effect.getComponent(cc.Animation);\n                animation.on(\"finished\", function(num, string) {\n                    console.log(\"show clearn line effect finished\", num, string);\n                    effect.destroy();\n                    end_cb && end_cb();\n                    hide_block();\n                }, this);\n                animation.play();\n            }\n        });\n    },\n    /**\n     * @param {Object} params\n     * @param {Number} params.x\n     * @param {Number} params.y\n     * @param {Number} params.type\n     */\n    onShowAddZhuBaoEffect(params){\n        // ! 重置的时候不需要特效\n        if(!params) return;\n        let c = this.blocks[0][params.x][params.y];\n        let pos = c.position;\n        cc.loader.loadRes('prefab/els_view_effect_get_zhubao',cc.Prefab,(err,prefab)=>{\n            if(err) cc.err(err.message || err);\n            else{\n                let effect = cc.instantiate(prefab);\n                effect.getChildByName('siprite_display').getComponent(cc.Sprite).spriteFrame = this.zhuBaoFrames[params.type - 112];\n                effect.parent = this.node.getChildByName('render_effect');\n                effect.position = pos;\n                let end_node = this.node.getChildByName('render_effect').getChildByName(`z_${params.type - 112}`);\n\n                let sp = pos;\n                let ep = end_node.position;\n                let dist = cc.pDistance(sp,ep);\n                let normalPos = cc.pSub(ep,sp).normalizeSelf();\n                let cfg = [\n                    cc.p(sp.x + 30, sp.y + normalPos.y * dist / 2),\n                    cc.p(sp.x + normalPos.x * dist / 4 * 3, sp.y + normalPos.y * dist / 4 * 3),\n                    ep\n                ];\n\n                effect.runAction(\n                    cc.sequence(\n                        cc.bezierTo(0.5,cfg).easing(cc.easeSineIn()),\n                        cc.callFunc(()=>{\n                            effect.destroy();\n                        })\n                    )\n                );\n            }\n        });    \n    },\n    /**\n     * * 显示无尽模式过关成功 ===> 恭喜升级\n     *\n     */\n    onShowEndlessLevelUpEffect(){\n        let self = this;\n        cc.loader.loadRes('prefab/els_view_level_up',cc.Prefab,(err,prefab)=>{\n            if(err) cc.err(err.message || err);\n            else{\n                let effect = cc.instantiate(prefab);\n                effect.parent = self.node.getChildByName('render_effect');\n                let size = self.node.getChildByName('render_effect');\n                effect.position = cc.p(size.width * 0.35 + size.width * 0.3, size.height * 0.7);\n\n                effect.runAction(\n                    cc.sequence(\n                        cc.scaleTo(0.2,1),\n                        cc.scaleTo(0.3,0.8),\n                        cc.delayTime(1.0),\n                        cc.callFunc(()=>{\n                            effect.destroy();\n                        })\n                    )\n                );\n\n            }\n        });\n        //* Add Score Effect\n        //! 如果位置需要调整，那么，则需要另外一个事件,需要获取珠宝的位置\n        cc.loader.loadRes('prefab/els_view_add_magic',cc.Prefab,(err,prefab)=>{\n            if(err) cc.err(err.message || err);\n            else{\n                let add_score = cc.instantiate(prefab);\n                add_score.parent = self.node.getChildByName(\"render_effect\");\n                let size = self.node.getChildByName('render_effect');\n                add_score.getComponent('els_view_add_magic').init(els.ENDLESS_VALUES.GetZhuBaoAddScore);\n                add_score.position = cc.p(size.width / 2, size.height * 0.7);\n            }\n        });\n    },\n});\nmodule.exports = MainGame;\n"]}