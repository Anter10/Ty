{"version":3,"sources":["../../../../../assets/script/ui/assets/script/ui/WisperStartAnimation.js"],"names":["cc","Class","extends","Component","properties","nodeContent","Node","nodeHeard","labelContent","Label","nodeStartTag","onLoad","start","console","log","play","init","str_content","cb","move_star","string","aniHeart","getComponent","Animation","aniContent","self","on","num","active","node","removeFromParent","star_pos","parent","convertToWorldSpace","position","start_pos","move_dis","p","x","y","star_pos_cache","runAction","sequence","moveBy","callFunc","opacity"],"mappings":"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","file":"WisperStartAnimation.js","sourceRoot":"../../../../../assets/script/ui","sourcesContent":["\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        nodeContent: cc.Node,\n        nodeHeard: cc.Node,\n        labelContent: cc.Label,\n        nodeStartTag: cc.Node,\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad () {},\n\n    start () {\n        console.log('wisper animation start');\n        this.play();\n    },\n\n    // update (dt) {},\n\n    init(str_content, cb, move_star){\n        console.log('wisper animation init');\n        this.labelContent.string = str_content;\n        //this.playIdx = idx;\n        this.cb = cb;\n        this.move_star = move_star;\n        //this.play();\n        \n    },\n    play(){\n        let aniHeart = this.nodeHeard.getComponent(cc.Animation);\n        let aniContent = this.nodeContent.getComponent(cc.Animation);\n        let self = this;\n\n        aniHeart.on('play',(num, string)=>{\n            console.log('heart play',num, string);\n        }, this);\n        aniHeart.on('finished', (num, string)=>{\n            console.log('heart finished',num, string);\n            self.nodeContent.active = true;\n            self.nodeHeard.active = false;\n            aniContent.play();\n        }, this);\n\n        aniContent.on('play',(num, string)=>{\n            console.log('content play',num, string);\n        }, this);\n        aniContent.on('finished', (num, string)=>{\n            console.log('content finished',num, string);\n            self.cb();\n            self.node.removeFromParent();\n        }, this);\n\n\n        let star_pos = this.move_star.parent.convertToWorldSpace(this.move_star.position);\n        let start_pos = this.nodeStartTag.parent.convertToWorldSpace(this.nodeStartTag.position);\n        let move_dis = cc.p(start_pos.x - star_pos.x + 50,start_pos.y - star_pos.y - 375);\n        console.log('play wisper start animation ====>',move_dis, star_pos, start_pos);\n        let star_pos_cache = this.move_star.position;\n        this.move_star.runAction(\n            cc.sequence(\n                cc.moveBy(0.2,move_dis),\n                cc.callFunc(()=>{\n                    self.nodeHeard.active = true;\n                    self.move_star.opacity = 255;\n                    self.move_star.active = false;\n                    //aniHeart.play(`tanshe0${this.playIdx}`);\n                    aniHeart.play('tanshe02');\n                    self.move_star.position = star_pos_cache;\n                })\n            )\n        );\n    },\n    \n});\n"]}