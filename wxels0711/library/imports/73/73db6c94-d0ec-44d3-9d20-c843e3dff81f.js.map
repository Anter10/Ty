{"version":3,"sources":["../../../../../assets/script/ui/assets/script/ui/gameAward.js"],"names":["ElsProfile","require","cc","Class","extends","Component","properties","page_view_prefab","Prefab","page_view_node","Node","page_view","PageView","daily_reward_label","Label","am_info_label","pm_info_label","reward_info_label","ad_content","ad_info_label","btn_content_nodes","cell","onLoad","active","string","button_state","node","getChildByName","on","back_btn_click","tywx","NotificationCenter","listen","EventType","CMD_ELSWX","_MsgRewardInfo","MSG","getRewardInfo","getNextAdreward","onDestroy","ignoreScope","showWithData","_data","update_page_view_data","_dc","self","dailyReward","forEach","_item","_index","parseInt","getDiamond","desc","update_button_state","i","length","_list","page_index","_state","undefined","c","instantiate","getComponent","init","_y","_x","position","v2","parent","getPages","right_btn_click","getCurrentPageIndex","setCurrentPageIndex","left_btn_click","award_btn_click","addRewardDiamond","removeFromParent","destroyAllChildren","destroy","ad_btn_click","showDaliy","loader","loadRes","err","prefab","error","message","daily_login","UIManager","getCurrentUI","params","result","action","CMD_ACTION_REWARD_INFO","UserInfo","rewardInfo","CMD_ACTION_ADD_DIAMOND","status","reason","Util","wechatShowModal"],"mappings":"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","file":"gameAward.js","sourceRoot":"../../../../../assets/script/ui","sourcesContent":["let ElsProfile = require(\"../core/ELSProfile.js\");\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        page_view_prefab: cc.Prefab,\n        page_view_node: cc.Node,\n        page_view: cc.PageView,\n\n        daily_reward_label: cc.Label,\n        am_info_label:cc.Label,\n        pm_info_label:cc.Label,\n        reward_info_label:cc.Label,\n\n        ad_content:cc.Node, // 广告UI\n        ad_info_label:cc.Label, // 广告倒计时描述\n\n        btn_content_nodes:[cc.Node],\n        cell:cc.Prefab,\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad () {\n        this.ad_content.active = true;\n        this.ad_info_label.string = \"\";\n        this.button_state = 0;\n        this.node.getChildByName(\"back_btn\").on(\"click\", this.back_btn_click, this);\n        tywx.NotificationCenter.listen(tywx.EventType.CMD_ELSWX, this._MsgRewardInfo, this);\n        tywx.MSG.getRewardInfo();\n        tywx.MSG.getNextAdreward();\n    },\n\n    onDestroy() {\n        tywx.NotificationCenter.ignoreScope(this);\n    },\n\n\n    showWithData(_data) {\n        this.node.active = true;\n        this.update_page_view_data(_data['shareUsers']);\n        let _dc = 0;\n        let self = this;\n        _data.dailyReward.forEach(function (_item, _index) {\n            _dc = _dc + parseInt(_item.getDiamond);\n            if (_index === 0) {\n                self.am_info_label.string = _item.desc;\n            }else if (_index === 1){\n                self.pm_info_label.string = _item.desc;\n            }\n        });\n        this.daily_reward_label.string = \"每日领奖（\" + _dc + \"/2）\";\n        this.reward_info_label.string = \"奖励：     + \" + _data[\"oneRewardDiamond\"];\n        this.button_state = _data[\"getReward\"];\n        this.update_button_state();\n    },\n\n    update_button_state() {\n        for (let i = 0; i < this.btn_content_nodes.length; i ++) {\n            if (i === this.button_state) {\n                this.btn_content_nodes[i].active = true;\n            }else  {\n                this.btn_content_nodes[i].active = false;\n            }\n        }\n    },\n\n    update_page_view_data(_list) {\n        for (let i = 0; i < 30; i ++) {\n            let page_index = parseInt(i / 6);\n            let _state = _list.length > i ? 2 : 1;\n            let _data = undefined;\n            if (_state === 2){\n                _data = _list[i];\n                if (parseInt(_data[\"getDianmond\"]) === 1){\n                    _state = 0;\n                }\n            }\n            let c = cc.instantiate(this.cell);\n            c.getComponent(\"diamond_award_cell\").init({\"state\":_state, \"data\":_data});\n            let _y = i % 6 >=3 ? -110 : 180;\n            let _x = 0;\n            if (i % 6 % 3 === 2) {\n                _x = 200;\n            }else if (i % 6 % 3 === 0) {\n                _x = -200;\n            }\n            c.position = cc.v2(_x, _y);\n            c.parent = this.page_view.getPages()[page_index];\n        }\n    },\n\n    right_btn_click(){\n        if (this.page_view.getCurrentPageIndex() == 0) {\n            return;\n        }\n        this.page_view.setCurrentPageIndex(this.page_view.getCurrentPageIndex() - 1);\n    },\n\n    left_btn_click(){\n        if (this.page_view.getCurrentPageIndex() == 4) {\n            return;\n        }\n        this.page_view.setCurrentPageIndex(this.page_view.getCurrentPageIndex() + 1);\n    },\n\n    award_btn_click(){\n        if (this.button_state === 1) { // 领取\n            tywx.MSG.addRewardDiamond();\n        }\n    },\n\n    // button click\n    back_btn_click(){\n      this.node.active = false;\n      this.node.removeFromParent();\n      this.node.destroyAllChildren();\n      this.node.destroy();\n    },\n\n    ad_btn_click(){\n        this.showDaliy();\n    },\n\n    showDaliy() {\n        let self = this;\n            cc.loader.loadRes('prefab/els_view_daliy_login',cc.Prefab,(err,prefab)=>{\n                if(err) cc.error(err.message || err);\n                else{\n                    let daily_login = cc.instantiate(prefab);\n                    daily_login.getComponent('els_view_daliy_login').init();\n                    daily_login.parent = tywx.UIManager.getCurrentUI();\n                }\n            });\n    },\n\n    _MsgRewardInfo(params){\n        if (params.result.action === tywx.EventType.CMD_ACTION_REWARD_INFO){\n            tywx.UserInfo.rewardInfo = params.result;\n            this.showWithData(params.result);\n        }\n        if (params.result.action === tywx.EventType.CMD_ACTION_ADD_DIAMOND) {\n            if (params.result.status === 1 && params.result.reason === 3){// 每日领取成功\n                this.button_state = 0;\n                this.update_button_state();\n                tywx.Util.wechatShowModal(\"每日奖励领取成功\", false, \"确定\");\n            }\n        }\n    },\n\n    // update (dt) {},\n});\n"]}