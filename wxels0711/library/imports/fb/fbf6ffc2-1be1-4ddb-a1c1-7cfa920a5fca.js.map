{"version":3,"sources":["../../../../../assets/script/ui/assets/script/ui/els_view_porp_animation_display.js"],"names":["ELSEvent","require","prop_map","Map","cc","Class","extends","Component","properties","animationNodes","Node","nodeMoTai","onLoad","tywx","NotificationCenter","listen","ELS_EVENT_CLEARN_GIFT_PROP_ANIMATION","clearnSelf","onDestroy","ignoreScope","node","destroyAllChildren","removeAllChildren","destroy","init","prop_id","type","_this","hideAllAnimationNode","scale","pos","p","is_show_motai","is_loop","end_cb","tmp_idx","get","position","active","tmp_animation","getComponent","Animation","on","num","string","console","log","tmp_ani_state","play","wrapMode","WrapMode","Loop","Normal","motaiCallback","trigger","ELS_EVENT_CLEARN_GIFT","forEach","e"],"mappings":"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","file":"els_view_porp_animation_display.js","sourceRoot":"../../../../../assets/script/ui","sourcesContent":["let ELSEvent = require('../core/ElsEvents.js');\nlet prop_map = new Map([[1301,0],[1302,3],[1303,2],[1304,1],[1305,4],[1306,5],[1307, 6]]);\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        animationNodes:[cc.Node],\n        nodeMoTai: cc.Node,\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad () {\n        tywx.NotificationCenter.listen(ELSEvent.ELS_EVENT_CLEARN_GIFT_PROP_ANIMATION, this.clearnSelf,this);\n    },\n\n    onDestroy() {\n        tywx.NotificationCenter.ignoreScope(this);  \n    },\n\n    clearnSelf(){\n        this.node.destroyAllChildren();\n        this.node.removeAllChildren();\n        this.node.destroy();\n    },\n\n    /**\n     * \n     * @param {Number} prop_id 道具ID,服务器道具id\n     * @param {Number} type 类型0:展示，1:预览\n     */\n    init(prop_id, type) {\n        var _this = this;\n        this.hideAllAnimationNode();\n        var scale = 0;\n        var pos = cc.p(0, 0);\n        var is_show_motai = false;\n        var is_loop = false;\n        var end_cb = null;\n        if (2 === type) {\n          scale = 1;\n          pos = cc.p(0, 0);\n          is_show_motai = true;\n          is_loop = false;\n          // end_cb = function end_cb() {\n          //   _this.node.destroy();\n          // };/Users/daichenxi/msvn/wx-els-check/branch/branch-prop-20180711/assets/script/ui/els_view_porp_animation_display.js\n        } else if (1 === type){\n          scale = .5;\n          pos = cc.p(0, -220);\n          is_show_motai = false;\n          is_loop = true;\n          end_cb = null;\n        } else if (0 === type ) {\n          scale = 1;\n          pos = cc.p(0, 0);\n          is_show_motai = false;\n          is_loop = false;\n          end_cb = function end_cb() {\n            _this.node.destroy();\n          };\n        }\n        var tmp_idx = prop_map.get(prop_id);\n        this.animationNodes[tmp_idx].scale = scale;\n        this.animationNodes[tmp_idx].position = pos;\n        this.nodeMoTai.active = is_show_motai;\n        this.animationNodes[tmp_idx].active = true;\n        var tmp_animation = this.animationNodes[tmp_idx].getComponent(cc.Animation);\n        tmp_animation.on(\"finished\", function(num, string) {\n          console.log(\"show gift box finished\", num, string);\n          end_cb && end_cb();\n        }, this);\n        var tmp_ani_state = tmp_animation.play();\n        tmp_ani_state.wrapMode = is_loop ? cc.WrapMode.Loop : cc.WrapMode.Normal;\n      },\n    motaiCallback(){\n        this.node.destroy();\n        tywx.NotificationCenter.trigger(ELSEvent.ELS_EVENT_CLEARN_GIFT);\n    },\n    hideAllAnimationNode(){\n        this.animationNodes.forEach(e => {\n            e.active = false;\n        });\n    }\n});\n"]}