{"version":3,"sources":["../../../../../assets/script/ui/assets/script/ui/ui_manager.js"],"names":["tywx","UIManager","_container","uistack","init","game","registerUI","uikey","uinode","jsname","node","getUI","layer","showUI","params","withaction","closepre","popCurrentUI","_curLayer","active","js","getComponent","showMe","console","log","_doAction","pushCurrentUI","setScale","runAction","cc","sequence","scaleTo","hideUI","hideMe","getCurrentUI","length","undefined","push","pop","hideAllUI"],"mappings":"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","file":"ui_manager.js","sourceRoot":"../../../../../assets/script/ui","sourcesContent":["/**\n * 简易UI管理\n * @type {{}}\n */\ntywx.UIManager = {\n    //ui 容器\n    _container : {},\n    //ui 当前显示堆栈\n    uistack : [],\n\n    init : function (game) {\n        this.game = game;\n    },\n\n    registerUI : function (uikey, uinode, jsname) {\n        this._container[uikey] = this._container[uikey] || [];\n        this._container[uikey] = {\n            node: uinode,\n            jsname: jsname\n        };\n    },\n\n    getUI : function(uikey) {\n        let layer = this._container[uikey];\n        return layer;\n    },\n\n    showUI :function(uikey, params, withaction, closepre){\n        if(closepre===true){\n            this.popCurrentUI();\n        }\n\n        let layer = this._container[uikey];\n        if(layer&&layer.node) {\n            this._curLayer = layer.node;\n            var node = layer.node;\n            node.active = true;\n            if(layer.jsname){\n                var js = node.getComponent(layer.jsname);\n                if(js&&js.showMe)\n                    js.showMe(params);\n            }\n            //是否是bool。并且为true\n            console.log(\"-----withaction 类型:----\"+typeof(withaction) );\n            if( typeof(withaction) === \"boolean\" &&  withaction !== false)\n                this._doAction(node);\n            this.pushCurrentUI(node);\n        }else{\n            console.log(\"fengbing\", \"error:  \"+uikey+'  not in ui manager');\n        }\n\n    },\n\n    _doAction : function (node) {\n        if(!node)\n            return;\n\n        node.setScale(0);\n        node.runAction(cc.sequence(\n            cc.scaleTo(0.2, 1.1, 1.1),\n            cc.scaleTo(0.1, 1, 1)\n        ));\n    },\n\n    hideUI : function (uikey) {\n        let layer = this._container[uikey];\n        if(layer&&layer.node) {\n            var node = layer.node;\n            node.active = false;\n            var js = node.getComponent(layer.jsname);\n            if(js&&js.hideMe){\n                js.hideMe();\n            }\n            this.popCurrentUI();\n        }\n    },\n\n    getCurrentUI : function () {\n        if(this.uistack.length> 0){\n            return this.uistack[this.uistack.length-1];\n        }\n        return undefined;\n    },\n\n    pushCurrentUI : function (layer) {\n        if(layer){\n            this.uistack.push(layer);\n        }\n    },\n\n    popCurrentUI : function () {\n        if(this.uistack.length > 0){\n            this.uistack.pop();\n        }\n    },\n\n    hideAllUI : function () {\n      while (this.uistack.length>0){\n          var node = this.uistack.pop();\n          if(node)\n              node.active = false;\n      }\n    }\n\n};\n"]}