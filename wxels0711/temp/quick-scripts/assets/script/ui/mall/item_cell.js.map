{"version":3,"sources":["item_cell.js"],"names":["ElsUtils","require","ELSEvent","cc","Class","extends","Component","properties","bgs","Node","count_label","Label","name_label","select_tag","icon","Sprite","onLoad","active","_itemId","item_data","checkPF","string","selectPF","init","_data","_count","_name","setImage","_node","ELS_PRODUCT_CONFIG","url","scale","y","rotation","_item","console","log","purl","node","loader","loadRes","SpriteFrame","err","spriteFrame","getComponent","update_select","item_cell_click","savePF","_i","pf_tag","parseInt","substr","length","tywx","NotificationCenter","trigger","ELS_EVENT_REFRESH_LOCAL_SKIN","ELS_EVENT_UPDATE_ITEMS","checkGift","ELS_EVENT_SHOW_GIFT_PROP_ANIMATION","type","prop_id"],"mappings":"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","file":"item_cell.js","sourceRoot":"../../../../../../assets/script/ui/mall","sourcesContent":["var ElsUtils = require(\"../../core/ElsUtils.js\");\nvar ELSEvent = require(\"../../core/ElsEvents.js\");\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        bgs: [cc.Node],\n        count_label: cc.Label,\n        name_label: cc.Label,\n        select_tag: cc.Node,\n        icon: cc.Sprite\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad() {\n        this.select_tag.active = false;\n        this.count_label.active = false;\n        this.bgs[0].active = false;\n        this.bgs[1].active = true;\n        let _itemId = this.item_data[\"kindID\"] || \"\";\n        if (ElsUtils.checkPF(_itemId)) { // 当前是选中皮肤\n            this.count_label.active = false;\n            this.count_label.string = \"\";\n            if (ElsUtils.selectPF(_itemId)) {\n                this.bgs[0].active = true;\n                this.bgs[1].active = false;\n            }\n        }\n    },\n\n    init(_data) {\n        if (!_data || !_data[\"item\"]) return;\n        this.item_data = _data;\n        let _itemId = _data[\"kindID\"];\n        let _count = _data[\"count\"] ? _data[\"count\"] : 0;\n        if (_count > 0 && !ElsUtils.checkPF(_itemId)) {\n            this.count_label.active = true;\n            this.count_label.string = _count;\n        }\n        let _name = _data[\"item\"][\"displayName\"];\n        this.name_label.string = _name;\n        this.setImage(this.icon, _itemId);\n\n    },\n\n    setImage(_node, _itemId) {\n        let ELS_PRODUCT_CONFIG = {\n            // TODO:\n            //res/raw-assets/resources/\n            1301: {\n                url: \"image/prop_icons/daoju01\",\n                scale: .35,\n                y: 5.65\n            },\n            1302: {\n                url: \"image/prop_icons/daoju04\",\n                scale: .39,\n                y: 5.65\n            },\n            1303: {\n                url: \"image/prop_icons/daoju03\",\n                scale: .3,\n                y: 14.2\n            },\n            1304: {\n                url: \"image/prop_icons/daoju02\",\n                scale: .39,\n                y: 7\n            },\n            1305: {\n                url: \"image/prop_icons/daoju05\",\n                scale: .4,\n                y: 2.3\n            },\n            1306: {\n                url: \"image/prop_icons/daoju06\",\n                scale: .34,\n                y: 1.95\n            },\n            1307: {\n                url: \"image/prop_icons/daoju001\",\n                scale: 1,\n                y: 5.9\n            },\n            1017: { // 导弹\n                url: \"image/prop_icons/FangKuai_daodan\",\n                scale: 1,\n                rotation: 0\n            },\n            1018: { // 锤子\n                url: \"image/prop_icons/FangKuai_chueizi\",\n                scale: 0.9,\n                rotation: 0\n            },\n            1019: { // 魔法棒\n                url: \"image/prop_icons/FangKuai_mobang\",\n                scale: 0.6,\n                rotation: -25\n            },\n            1020: { // 冰弹\n                url: \"image/prop_icons/FangKuai_bingdan\",\n                scale: 0.9,\n                rotation: 0\n            },\n            1201: { // 乐高积木皮肤\n                url: \"image/prop_icons/pifu00\",\n                scale: 1,\n                rotation: 0\n            },\n            1202: { // 七彩水晶皮肤\n                url: \"image/prop_icons/pifu02\",\n                scale: 1,\n                rotation: 0\n            },\n            1203: { // 瑰丽宝石皮肤\n                url: \"image/prop_icons/pifu03\",\n                scale: 1,\n                rotation: 0\n            },\n            1204: { // 心心相印\n                url: \"image/prop_icons/pifu04\",\n                scale: 1,\n                rotation: 0\n            },\n\n        };\n\n        let _item = ELS_PRODUCT_CONFIG[_itemId + ''];\n        if (!_item) {\n            console.log(\"local config not exist!!\");\n            return;\n        }\n\n        let purl = _item[\"url\"];\n        _node.node.rotation = _item[\"rotation\"] || 0;\n        _node.node.scale = _item[\"scale\"];\n        cc.loader.loadRes(purl, cc.SpriteFrame, function(err, spriteFrame) {\n            if (!err) {\n                _node.getComponent('cc.Sprite').spriteFrame = spriteFrame;\n            }\n        });\n    },\n\n    update_select() {\n        let _itemId = this.item_data[\"kindID\"] || \"\";\n        if (ElsUtils.checkPF(_itemId)) { // 当前是皮肤\n            this.count_label.active = false;\n            this.count_label.string = \"\";\n            if (ElsUtils.selectPF(_itemId)) {\n                this.bgs[0].active = true;\n                this.bgs[1].active = false;\n            } else {\n                this.bgs[0].active = false;\n                this.bgs[1].active = true;\n            }\n        }\n    },\n\n    item_cell_click() {\n        if (ElsUtils.checkPF(this.item_data[\"kindID\"])) { // 当前是皮肤\n            if (!ElsUtils.selectPF(this.item_data[\"kindID\"])) { // 当前非选中皮肤\n                ElsUtils.savePF(this.item_data[\"kindID\"]);\n                // TODO: 刷新界面\n                let _i = this.item_data[\"kindID\"] + \"\";\n                let pf_tag = parseInt(_i.substr(_i.length - 1, 1));\n                tywx.NotificationCenter.trigger(ELSEvent.ELS_EVENT_REFRESH_LOCAL_SKIN, {\n                    \"idx\": pf_tag - 1\n                });\n                tywx.NotificationCenter.trigger(ELSEvent.ELS_EVENT_UPDATE_ITEMS);\n\n            }\n        }\n        if (ElsUtils.checkGift(this.item_data[\"kindID\"])) { // 虚拟礼物\n            tywx.NotificationCenter.trigger(ELSEvent.ELS_EVENT_SHOW_GIFT_PROP_ANIMATION, {\n                type: 0,\n                prop_id: parseInt(this.item_data[\"kindID\"])\n            });\n        }\n    },\n\n    // update (dt) {},\n});"]}