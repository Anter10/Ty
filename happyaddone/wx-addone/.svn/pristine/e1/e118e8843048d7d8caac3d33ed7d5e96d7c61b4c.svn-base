{"version":3,"sources":["Bilog.js"],"names":["tywx","clickStatEventType","clickStatEventTypeUserFrom","clickStatEventTypeUserShare","clickStatEventTypeShowAdBtn","clickStatEventTypeClickShowQRCode","clickStatEventTypeClickAdBtn","clickStatEventTypeClickDirectToMiniGameSuccess","clickStatEventTypeClickDirectToMiniGameFail","clickStatEventTypeOnShowTimeStampSubmit","clickStatEventTypeOnHideTimeStampSubmit","clickStatEventTypeSubmitVersionInfo","clickStatEventTypeWxLoginStart","clickStatEventTypeWxLoginSuccess","clickStatEventTypeWxLoginFailed","clickStatEventTypeAuthorizationStart","clickStatEventTypeAuthorizationSuccess","clickStatEventTypeAuthorizationFailed","clickStatEventTypeLoginSDKStart","clickStatEventTypeLoginSDKSuccess","clickStatEventTypeLoginSDKFailed","clickStatEventTypeTCPStart","clickStatEventTypeTCPSuccess","clickStatEventTypeTCPFailed","BiLog","uploadLogTimely","logtxt","StateInfo","networkConnected","LOGD","header","configObj","SystemInfo","errorLogServer","cloudId","intClientId","HttpUtil","httpPost","getSystemInfo","cloud_id","rec_type","rec_id","receive_time","user_id","UserInfo","userId","game_id","gameId","client_id","clientId","device_id","Util","getLocalUUID","ip_addr","nettype","phone_maker","phone_model","model","phone_carrier","reserved","uploadClickStatLogTimely","callbackObj","undefined","biLogServer","ado","logWithColor","clickStat","eventId","paramsList","dyeparams","length","i","push","JSON","stringify","bilog","assemblelog","eventid","paramsarr","time","Date","getTime","_timetag","paramstr","join","logStr","str","trimTab0","txt","replace"],"mappings":"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","file":"Bilog.js","sourceRoot":"../../../../../assets/Script/CommonFrame","sourcesContent":["/**\n * Created by xiaochuntian on 2018/5/2.\n */\n\n\ntywx.clickStatEventType = {\n    /**\n     * tywx.SystemInfo.errorLogServer = \"https://clienterr.touch4.me/api/bilog5/clientlog\"\n     * tywx.SystemInfo.biLogServer = \"https://cbi.touch4.me/api/bilog5/text\"\n     * 使用方法:\n     * 将bilog.js加入工程后,在需要打点的地方调用tywx.BiLog.clickStat(事件id,[参数列表]);\n     * 以下是由BI组规定的必须进行上报的打点,请各个项目组不要修改\n     */\n    clickStatEventTypeUserFrom : 99990001,//用户来源\n    clickStatEventTypeUserShare : 99990002,//用户分享\n\n    clickStatEventTypeShowAdBtn : 99990003,  //分流icon显示\n    clickStatEventTypeClickShowQRCode : 99990004, //展示分流倒量的二维码\n\n    clickStatEventTypeClickAdBtn : 99990007,//点击分流icon\n\n    clickStatEventTypeClickDirectToMiniGameSuccess : 99990005, //点击icon,直接拉进小游戏成功（点击确认）\n    clickStatEventTypeClickDirectToMiniGameFail : 99990006, //点击icon,直接拉进小游戏失败（点击取消）\n\n    clickStatEventTypeOnShowTimeStampSubmit: 99990010,//onshow时上报时间戳\n    clickStatEventTypeOnHideTimeStampSubmit: 99990011,//onhide时上报时间戳\n\n    clickStatEventTypeSubmitVersionInfo : 9999, //上报微信版本及基础库信息\n    clickStatEventTypeWxLoginStart : 10001,//微信登录开始\n    clickStatEventTypeWxLoginSuccess : 10002,//微信登录成功\n    clickStatEventTypeWxLoginFailed : 10003,//微信登录失败\n\n    clickStatEventTypeAuthorizationStart : 10004,//授权开始\n    clickStatEventTypeAuthorizationSuccess : 10005,//授权成功\n    clickStatEventTypeAuthorizationFailed : 10006,//授权失败\n\n    clickStatEventTypeLoginSDKStart : 10007,//登录SDK开始\n    clickStatEventTypeLoginSDKSuccess : 10008,//登录SDK成功\n    clickStatEventTypeLoginSDKFailed : 10009,//登录SDK时失败\n\n    clickStatEventTypeTCPStart : 10010,//TCP连接开始\n    clickStatEventTypeTCPSuccess : 10011,//TCP连接成功\n    clickStatEventTypeTCPFailed : 10012,//TCP连接失败\n\n    /**\n     * 请在下方添加游戏相关的具体打点,另起声明放在业务层也可以\n     */\n\n};\n\ntywx.BiLog = {\n\n    /**\n     * 上传实时log,富豪斗地主用此接口上传错误情况下的日志\n     * @param logtxt:log内容\n     */\n    uploadLogTimely:function (logtxt) {\n        if(!tywx.StateInfo.networkConnected) {\n            tywx.LOGD('tywx.BiLog', 'net error!');\n            return;\n        }\n        if(logtxt) {\n            var header = ['Content-Type:text/plain'];\n            var configObj = {\n                'url': tywx.SystemInfo.errorLogServer + '?cloudname=' + tywx.SystemInfo.cloudId + '.' + tywx.SystemInfo.intClientId,\n                'header': header,\n                'postData': logtxt,\n                'callback': null\n            };\n            tywx.HttpUtil.httpPost(configObj,'POST');\n        }\n    },\n\n    getSystemInfo : function(){\n        this.cloud_id = tywx.SystemInfo.cloudId;   //独立服务id\n        this.rec_type = '1';   //日志类型\n        this.rec_id     = '0'; //日志记录id\n        this.receive_time  ='0'; // 日志接收时间  输出日志时统一填0，BI服务会在接收时添加\n        this.user_id = tywx.UserInfo.userId || '0';      //用户id\n        this.game_id = tywx.SystemInfo.gameId;      //游戏id\n        this.client_id = tywx.SystemInfo.clientId;\n        this.device_id = this.device_id || tywx.Util.getLocalUUID();\t//device id\n        this.ip_addr='#IP';// ip地址\t占位--服务器处理\n        this.nettype= \"0\"; //网络状况\n        this.phone_maker= \"0\"; //手机制造商\n        this.phone_model= tywx.UserInfo.model; //手机型号\n        this.phone_carrier= \"0\";//手机运营商\n        this.reserved ='0';\n    },\n    /*BI组打点\n     参数1是事件id，参数2是[],内含扩展参数\n     60001事件id\n     在查询工具，cloud id+game id+事件id即可找到,GDSS有前端日志查询工具\n     ty.BiLog.clickStat(ddz.StatEventInfo.DdzButtonClickInPlugin,\n     [ddz.PluginHall.Model.statInfoType[scope.index],ddz.GameId]);\n\n     // ty.BiLog.clickStat(hall5.BILogEvents.BILOG_EVENT_PLUGIN_UPDATE_SUCCESS,[hall5.BilogStatEvent.Plugin_Update_Success,gameid]);\n     */\n    uploadClickStatLogTimely:function (logtxt) {\n        var callbackObj = this;\n        if(logtxt!=undefined && logtxt!='') {\n            var header = ['Content-Type:text/plain'];\n            var configObj = {\n                'url': tywx.SystemInfo.biLogServer,\n                'headers': header,\n                'postData': logtxt,\n                'obj': callbackObj,\n                'tag': null,\n                'callback': null\n            };\n        }\n        tywx.ado.logWithColor(logtxt);\n        tywx.HttpUtil.httpPost(configObj,'POST');\n    },\n\n    /**\n     * 打点接口\n     * @param eventId      打点事件\n     * @param ParamsList   额外参数,最多10位,参见bi组文档说明\n     */\n    clickStat: function (eventId, paramsList) {\n        paramsList = paramsList || [];\n        var dyeparams = [];\n        if (paramsList.length < 10) {\n            for (var i = 0; i < 9; i++) {\n                if (i < paramsList.length) {\n                    dyeparams.push(paramsList[i]);}\n                else {\n                    dyeparams.push(0);\n                }\n            }\n        }\n        else {\n            dyeparams = paramsList;\n        }\n        tywx.LOGD('BI打点', \"eventid= \" + eventId + \" 描述 = \" + JSON.stringify(dyeparams));\n        var bilog = this.assemblelog(eventId, dyeparams);\n        this.uploadClickStatLogTimely(bilog+ '\\n');\n    },\n\n    /**\n     * BIlog拼接\n     * @param eventid\n     * @param paramsarr\n     * @returns {*}\n     */\n    assemblelog:function (eventid, paramsarr) {\n        var time = new Date().getTime();\n        if(time-this._timetag>60000) {\n            this._timetag = time;\n            this.nettype=0;\n        }\n        var paramstr = paramsarr.join('\\t');\n\n        this.getSystemInfo();\n        var logStr =this.cloud_id+'\\t'+this.rec_type+'\\t'+time+'\\t'+this.rec_id+'\\t'+this.receive_time+\n            '\\t'+eventid+'\\t'+this.user_id+'\\t'+this.game_id+'\\t'+this.client_id+'\\t'+this.device_id+'\\t'+\n            this.ip_addr +'\\t'+this.nettype+'\\t'+this.phone_maker +'\\t'+this.phone_model +'\\t'+this.phone_carrier+'\\t'+paramstr+'\\t'+ this.reserved ;\n\n        var str = this.trimTab0(logStr);\n        return str;\n    },\n\n    /**\n     * 精简上报字符串,结尾都是默认值的部分可以去掉,由BI接收端进行补齐\n     * @param str\n     * @returns {*}\n     */\n    trimTab0:function (str) {\n        if(str==null || str==undefined)\n            return '';\n        var txt = str.replace(/(\\t0)*$/,'');\n        return txt;\n    },\n};\n"]}