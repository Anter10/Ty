{"version":3,"sources":["../../../../../assets/Script/models/assets/Script/models/GeZi.js"],"names":["config","require","block","module","exports","id","parent","color","cc","num","posx","tywx","ado","Constants","GameCenterConfig","swidth","gezi_pitch","posy","parseInt","setnum","hasout","id_keep","id_dest","gamecenter","hasShowxhgNum","allpngs","getComponent","showThanTenIcon","addxhgNumber","hideThanTenIcon","hasShowxhgId","removexhgId","colorindex","color_list","length","colors","setColor","getAllgz","getAllmask","settoblock","setinfo","setpos","settoblockAndNumber","settoblockvalue","draw","cell","tilescript","pngnum","celltilenumColors","visByNum","cindex","setCurNum","Sprite","node","x","gezi_size","y"],"mappings":"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","file":"GeZi.js","sourceRoot":"../../../../../assets/Script/models","sourcesContent":["/*\n    游戏的基本单元：格子（真实的格子）\n    定义他的数字和颜色，色块的所有者\n    created by gyc on 2018-08-01.\n*/\n\nvar config = require(\"AddOneConfig\")\nvar block = require(\"GeZiData\")\n\n\nmodule.exports = function (id, parent) {\n    // 格子的ID\n    this.id = id;\n    // 格子的颜色\n    this.color = cc.color(0, 0, 0, 0);\n    // 格子现实的的数字\n    this.num = 0;\n    // 格子的容器\n    this.parent = parent;\n    // 格子的x坐标\n    this.posx = 25 + (tywx.ado.Constants.GameCenterConfig.swidth - (5 * tywx.ado.Constants.GameCenterConfig.gezi_pitch)) / 2 + (id % 5) * (tywx.ado.Constants.GameCenterConfig.gezi_pitch) + 2;\n    // 格子的Y坐标\n    this.posy = 304 + parseInt(id / 5) * (tywx.ado.Constants.GameCenterConfig.gezi_pitch);\n    // 格子的数据层\n    this.block = new block(this);\n\n    /*\n        调用: 更新Num的时候调用\n        功能: 更新当前的num 并根据num来更新显示的颜色\n        参数: [\n            num: 格子显示的数字\n        ]\n        返回值:[\n            无\n        ]\n        思路: 逻辑需要\n    */\n    this.setnum = function (num) {\n        if (num) {\n            if (num % 2 == 0 && num > 7 && !this.hasout) {\n                if (this.block) {\n                    // this.block.printMSG();\n                    //   console.log(this.id + \" cell gz num  = \" + num + \" \" + tywx.gamecenter.hasShowxhgNum(num));\n                    if (this.block.id_keep == -1 && this.block.id_dest == -1) {\n                        if (tywx.gamecenter.hasShowxhgNum(num) == false) {\n                            tywx.gamecenter.allpngs[this.id] && tywx.gamecenter.allpngs[this.id].getComponent(\"celltile\").showThanTenIcon();\n                            tywx.gamecenter.addxhgNumber(num, this.id);\n                        } else {\n                            tywx.gamecenter.allpngs[this.id] && tywx.gamecenter.allpngs[this.id].getComponent(\"celltile\").hideThanTenIcon();\n                            //  tywx.gamecenter.removexhgNumber(num);\n                        }\n                    } else if (this.block.id_keep != -1 && this.block.id_dest != -1) {\n                        // console.log(JSON.stringify(tywx.gamecenter.curshowxhgs) + \"keep ahd = \" + tywx.gamecenter.hasShowxhgId(this.block.id_keep));\n                        if (tywx.gamecenter.hasShowxhgId(this.block.id_keep) == true) {\n                            tywx.gamecenter.allpngs[this.block.id_dest] && tywx.gamecenter.allpngs[this.block.id_dest].getComponent(\"celltile\").showThanTenIcon();\n                            tywx.gamecenter.addxhgNumber(num, this.block.id_dest);\n                        }\n                        tywx.gamecenter.removexhgId(this.block.id_keep);\n                        tywx.gamecenter.allpngs[this.block.id_keep] && tywx.gamecenter.allpngs[this.block.id_keep].getComponent(\"celltile\").hideThanTenIcon();\n                    } else if (this.block.id_keep != -1 && this.block.id_dest == -1) {\n                        if (tywx.gamecenter.hasShowxhgNum(num) == false) {\n                            tywx.gamecenter.addxhgNumber(num, this.block.id_keep);\n                            tywx.gamecenter.allpngs[this.block.id_keep] && tywx.gamecenter.allpngs[this.block.id_keep].getComponent(\"celltile\").showThanTenIcon();\n                        }\n                    }\n                }\n            } else {\n                if (this.block) {\n                    if (num > 8) {\n                        if (tywx.gamecenter.hasShowxhgId(this.block.id_keep) == true) {\n                            tywx.gamecenter.removexhgId(this.block.id_keep);\n                            tywx.gamecenter.allpngs[this.block.id_keep] && tywx.gamecenter.allpngs[this.block.id_keep].getComponent(\"celltile\").hideThanTenIcon();\n                        }\n                    }\n                    tywx.gamecenter.allpngs[this.id] && tywx.gamecenter.allpngs[this.id].getComponent(\"celltile\").hideThanTenIcon();\n                }\n            }\n            config = tywx.config != null ? tywx.config : config;\n            this.num = num;\n            var colorindex = num - 1;\n            if (this.num > tywx.ado.Constants.GameCenterConfig.color_list.length) {\n                colorindex = colorindex % tywx.ado.Constants.GameCenterConfig.color_list.length;\n            }\n            let colors = tywx.ado.Constants.GameCenterConfig.color_list[colorindex];\n            var color = cc.color(colors[0], colors[1], colors[2]);\n            this.setColor(color);\n        }\n    }\n\n    /*\n        调用: 更新颜色的时候调用\n        功能: 更新当前的颜色值\n        参数: [\n            color:格子需要显示的颜色\n        ]\n        返回值:[\n            无\n        ]\n        思路: 逻辑需要\n    */\n    this.setColor = function (color) {\n        this.color = color;\n    }\n\n    /*\n        调用: GeZiData,GeZi中都有调用\n        功能: 得到游戏的格子容器\n        参数: [\n            无\n        ]\n        返回值:[\n            array:存储格子的数组\n        ]\n        思路: 逻辑需要\n    */\n    this.getAllgz = function () {\n        return this.parent.getAllgz();\n    }\n\n    /*\n        调用: GeZiData,GeZi中都有调用\n        功能: 得到游戏的mask容器\n        参数: [\n            无\n        ]\n        返回值:[\n            array:存储mask的数组\n        ]\n        思路: 逻辑需要\n    */\n    this.getAllmask = function () {\n        return this.parent.getAllmask();\n    }\n\n    /*\n         调用: gamemain中调用\n         功能: 更新自身block的数据\n         参数: [\n             无\n         ]\n         返回值:[\n             无\n         ]\n         思路: 逻辑需要\n     */\n    this.settoblock = function () {\n        this.block.setinfo(this.color, this.num);\n        this.block.setpos(this.posx, this.posy);\n    }\n\n\n    /*\n               调用: gamemain中调用\n               功能: 更新自身block的数据\n               参数: [\n                   无\n               ]\n               返回值:[\n                   无\n               ]\n               思路: 逻辑需要\n       */\n    this.settoblockAndNumber = function (num) {\n        if (this.block.posx != this.posx && this.block.posy != this.block.posy) {\n            this.block.setinfo(this.color, num);\n        }\n        this.block.setpos(this.posx, this.posy);\n    }\n\n\n\n    /*\n         调用: gamemain中调用\n         功能: 更新自身block的数据\n         参数: [\n             无\n         ]\n         返回值:[\n             无\n         ]\n         思路: 逻辑需要\n     */\n    this.settoblockvalue = function () {\n            this.block.setinfo(this.color, this.num);\n        },\n\n\n\n        /*\n             调用: gamemain中调用\n             功能: 绘制当前的节点\n             参数: [\n                 ctx: 绘制节点的句柄\n                 label:显示的label\n             ]\n             返回值:[\n                 无\n             ]\n             思路: 逻辑需要\n         */\n        this.draw = function (cell) {\n            config = tywx.config != null ? tywx.config : config;\n            // ctx.fillColor = this.block.color;\n            // ctx.roundRect(this.block.posx,this.block.posy,tywx.ado.Constants.GameCenterConfig.gezi_size,tywx.ado.Constants.GameCenterConfig.gezi_size,8);\n            // ctx.fill();\n            // lable.string = this.block.num;\n            // lable.node.x = this.block.posx-360+tywx.ado.Constants.GameCenterConfig.gezi_size/2;\n            // lable.node.y = this.block.posy-640+tywx.ado.Constants.GameCenterConfig.gezi_size/2;\n\n            var tilescript = cell.getComponent(\"celltile\");\n            var pngnum = this.block.num;\n            if (pngnum > tywx.ado.Constants.GameCenterConfig.celltilenumColors.length) {\n                pngnum = pngnum % tywx.ado.Constants.GameCenterConfig.celltilenumColors.length;\n            }\n\n\n            tilescript.visByNum(pngnum, this.block.num);\n            var cindex = pngnum - 1;\n            if (cindex < 0) {\n                cindex = 0;\n            }\n            tilescript.setCurNum(this.getAllmask()[this.id].num);\n            let colors = tywx.ado.Constants.GameCenterConfig.celltilenumColors[cindex];\n            tilescript.setColor(new cc.color(colors[0], colors[1], colors[2], 255));\n            cell.getComponent(cc.Sprite).node.x = this.block.posx - 360 + tywx.ado.Constants.GameCenterConfig.gezi_size / 2;\n            cell.getComponent(cc.Sprite).node.y = this.block.posy - 640 + tywx.ado.Constants.GameCenterConfig.gezi_size / 2;\n        }\n}"]}