{"version":3,"sources":["GeZi.js"],"names":["config","require","block","module","exports","id","parent","label_id","color","cc","num","tmp_pitchw","tywx","ado","Constants","GameCenterConfig","gezi_h_s","gezi_gap","tmp_pitchh","gezi_size","posx","gezi_offx","posy","gezi_offy","parseInt","console","log","setnum","colorindex","color_list","length","colors","setColor","getAllgz","getAllmask","settoblock","setinfo","setpos","settoblockAndNumber","settoblockvalue","draw","cell","tilescript","getComponent","pngnum","celltilenumColors","visByNum","cindex","setCurNum","Sprite","node","x","y"],"mappings":"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","file":"GeZi.js","sourceRoot":"../../../../../assets/Script/models","sourcesContent":["/*\n    游戏的基本单元：格子（真实的格子）\n    定义他的数字和颜色，色块的所有者\n    created by gyc on 2018-08-01.\n*/\n\nvar config = require(\"AddOneConfig\")\nvar block = require(\"GeZiData\")\n\n\nmodule.exports = function (id, parent, label_id) {\n    // console.log(\"当前的格子初始化信息 = \" + label_id);\n    // 格子的ID\n    this.id = id;\n    this.label_id = label_id;\n    // 格子的颜色\n    this.color = cc.color(0, 0, 0, 0);\n    // 格子现实的的数字\n    this.num = 0;\n    // 格子的容器\n\n    var tmp_pitchw = tywx.ado.Constants.GameCenterConfig.gezi_h_s + tywx.ado.Constants.GameCenterConfig.gezi_gap / 2;\n    var tmp_pitchh = tywx.ado.Constants.GameCenterConfig.gezi_size * 3 / 2 + tywx.ado.Constants.GameCenterConfig.gezi_gap;\n\n\n    this.parent = parent;\n    // 格子的x坐标\n    this.posx = tywx.ado.Constants.GameCenterConfig.gezi_offx + (id % 14) * tmp_pitchw + tywx.ado.Constants.GameCenterConfig.gezi_h_s;\n    // 格子的Y坐标\n    this.posy = tywx.ado.Constants.GameCenterConfig.gezi_offy + parseInt(id / 14) * tmp_pitchh;\n    console.log(id + \"当前格子的位置 = \" + \"x = \" + this.posx + \" y = \" + this.posy)\n\n    // 格子的数据层\n    if (this.label_id >= 0)\n        this.block = new block(this);\n    else\n        this.block = null;\n\n\n    /*\n        调用: 更新Num的时候调用\n        功能: 更新当前的num 并根据num来更新显示的颜色\n        参数: [\n            num: 格子显示的数字\n        ]\n        返回值:[\n            无\n        ]\n        思路: 逻辑需要\n    */\n    this.setnum = function (num) {\n        if (num) {\n            config = tywx.config != null ? tywx.config : config;\n            this.num = num;\n            var colorindex = num - 1;\n            // if (this.num > tywx.ado.Constants.GameCenterConfig.color_list.length) {\n            colorindex = colorindex % tywx.ado.Constants.GameCenterConfig.color_list.length;\n            // }\n            let colors = tywx.ado.Constants.GameCenterConfig.color_list[colorindex];\n            if (!colors) {\n                console.log(\"当前什么情况 = \" + colorindex + \" \" + num);\n            }\n            var color = cc.color(colors[0], colors[1], colors[2]);\n            this.setColor(color);\n        }\n\n    }\n\n\n    /*\n        调用: 更新颜色的时候调用\n        功能: 更新当前的颜色值\n        参数: [\n            color:格子需要显示的颜色\n        ]\n        返回值:[\n            无\n        ]\n        思路: 逻辑需要\n    */\n    this.setColor = function (color) {\n        this.color = color;\n    }\n\n    /*\n        调用: GeZiData,GeZi中都有调用\n        功能: 得到游戏的格子容器\n        参数: [\n            无\n        ]\n        返回值:[\n            array:存储格子的数组\n        ]\n        思路: 逻辑需要\n    */\n    this.getAllgz = function () {\n        return this.parent.getAllgz();\n    }\n\n    /*\n        调用: GeZiData,GeZi中都有调用\n        功能: 得到游戏的mask容器\n        参数: [\n            无\n        ]\n        返回值:[\n            array:存储mask的数组\n        ]\n        思路: 逻辑需要\n    */\n    this.getAllmask = function () {\n        return this.parent.getAllmask();\n    }\n\n    /*\n         调用: gamemain中调用\n         功能: 更新自身block的数据\n         参数: [\n             无\n         ]\n         返回值:[\n             无\n         ]\n         思路: 逻辑需要\n     */\n    this.settoblock = function () {\n        this.block && (this.block.setinfo(this.color, this.num));\n        this.block && (this.block.setpos(this.posx, this.posy));\n    }\n\n\n    /*\n               调用: gamemain中调用\n               功能: 更新自身block的数据\n               参数: [\n                   无\n               ]\n               返回值:[\n                   无\n               ]\n               思路: 逻辑需要\n       */\n    this.settoblockAndNumber = function (num) {\n        if (this.block && this.block.posx != this.posx && this.block.posy != this.block.posy) {\n            this.block.setinfo(this.color, num);\n        }\n\n        this.block && (this.block.setpos(this.posx, this.posy));\n    }\n\n\n\n    /*\n         调用: gamemain中调用\n         功能: 更新自身block的数据\n         参数: [\n             无\n         ]\n         返回值:[\n             无\n         ]\n         思路: 逻辑需要\n     */\n    this.settoblockvalue = function () {\n            this.block && (this.block.setinfo(this.color, this.num));\n        },\n\n\n\n        /*\n             调用: gamemain中调用\n             功能: 绘制当前的节点\n             参数: [\n                 ctx: 绘制节点的句柄\n                 label:显示的label\n             ]\n             返回值:[\n                 无\n             ]\n             思路: 逻辑需要\n         */\n        this.draw = function (cell) {\n            if (this.label_id == -1 || !this.block)\n                return;\n            config = tywx.config != null ? tywx.config : config;\n            // ctx.fillColor = this.block.color;\n            // ctx.roundRect(this.block.posx,this.block.posy,tywx.ado.Constants.GameCenterConfig.gezi_size,tywx.ado.Constants.GameCenterConfig.gezi_size,8);\n            // ctx.fill();\n            // lable.string = this.block.num;\n            // lable.node.x = this.block.posx-360+tywx.ado.Constants.GameCenterConfig.gezi_size/2;\n            // lable.node.y = this.block.posy-640+tywx.ado.Constants.GameCenterConfig.gezi_size/2;\n\n            var tilescript = cell.getComponent(\"celltile\");\n            var pngnum = this.block.num % tywx.ado.Constants.GameCenterConfig.celltilenumColors.length;\n            \n\n\n            tilescript.visByNum(pngnum, this.block.num);\n            var cindex = pngnum - 1;\n            if (cindex < 0) {\n                cindex = 0;\n            }\n            tilescript.setCurNum(this.getAllmask()[this.id].num);\n            let colors = tywx.ado.Constants.GameCenterConfig.celltilenumColors[cindex];\n            tilescript.setColor(new cc.color(colors[0], colors[1], colors[2], 255));\n            cell.getComponent(cc.Sprite).node.x = this.block.posx - 360;\n            cell.getComponent(cc.Sprite).node.y = this.block.posy - 640;\n        }\n}"]}