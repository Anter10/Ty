{"version":3,"sources":["../../../../../assets/Script/models/assets/Script/models/Utils.js"],"names":["crypto","require","GameClubBtn","WXBannerAD","IsHideBanner","WXVedioAD","WXVedioCallback","success","fail","Utils","params","canvas","toTempFilePath","x","y","width","w","height","h","destWidth","destHeight","res","console","log","saveImage2PhoneByUrl","tempFilePath","url","cb_success","cb_fail","saveImg2Phone","wx","saveImageToPhotosAlbum","filePath","getSetting","authSetting","authorize","scope","openSetting","complete","key","cc","sys","localStorage","removeItem","tywx","isInWXChat","removeUserCloudStorage","keyList","msg","time","Date","err_obj","SystemInfo","cloudId","toDateString","clientId","UserInfo","userId","system","model","wechatType","version","StateInfo","networkType","ip","header","configObj","errorTxtServer","HttpUtil","httpPost","value","only_local","setItem","setUserCloudStorage","KVDataList","default_value","v","getItem","i","tmp_v","tag","result","success_cb","fail_cb","shareTickets","call_succ","call_fail","ff","getShareInfo","shareTicket","iv","encryptedData","resultStr","decrypt","wxgame_session_key","resultObj","JSON","parse","id","openGId","t0","parseInt","loadItem","tc","getTime","saveItem","e","share_tag","config","tmp_arr","PropagateInterface","ShareConfig","hasOwnProperty","rand_idx","Math","random","length","crypted","decoded","Buffer","decipher","createDecipheriv","setAutoPadding","update","final","err","duration","showToast","title","icon","error","content","show_cancel","sure_cb","cancle_cb","showModal","showCancel","confirm","cancel","createGameClubButton","style","left","top","show","hide","window","createBannerAd","ado","destroyWXBanner","sys_info","getSystemInfoSync","s_w","screenWidth","s_h","screenHeight","is_ipx","isIpx","adUnitId","Constants","WXAdConfig","bannerId","onResize","destroy","createRewardedVideoAd","vedioId","onClose","toast_str","isEnded","undefined","showWXModal","showWXBanner","load","then","catch","hideWXBanner","node","runAction","sequence","scaleTo","easing","easeIn","ret","indexOf","windowHeight","windowWidth","module","exports"],"mappings":";;;;;;;;;;;;AACA,IAAIA,SAASC,QAAQ,QAAR,CAAb;AACA,IAAIC,cAAc,IAAlB,EAAwB;AACxB,IAAIC,aAAa,IAAjB,EAAuB;AACvB,IAAIC,eAAe,KAAnB,EAA0B;AAC1B,IAAIC,YAAY,IAAhB,EAAsB;AACtB,IAAIC,kBAAkB;AAClBC,aAAS,IADS;AAElBC,UAAM;AAFY,CAAtB,EAGG;AACH,IAAIC;AAAA;AAAA;AAAA;;AAAA;AAAA;;AACA;;;;;;;;;;;;;;;;;;;;AADA,iDAqB+BC,MArB/B,EAqBsC;AAClCC,mBAAOC,cAAP,CAAsB;AAClBC,mBAAGH,OAAOG,CADQ;AAElBC,mBAAGJ,OAAOI,CAFQ;AAGlBC,uBAAML,OAAOM,CAHK;AAIlBC,wBAAQP,OAAOQ,CAJG;AAKlBC,2BAAWT,OAAOM,CALA;AAMlBI,4BAAYV,OAAOQ,CAND;AAOlBX,yBAAS,SAASA,OAAT,CAAiBc,GAAjB,EAAsB;AAC3BC,4BAAQC,GAAR,CAAYF,GAAZ;;AAEAZ,0BAAMe,oBAAN,CAA2BH,IAAII,YAA/B,EAA6Cf,OAAOH,OAApD,EAA6DG,OAAOF,IAApE;AACH,iBAXiB;AAYlBA,sBAAM,SAASA,IAAT,CAAca,GAAd,EAAmB;AACrB;AACAX,2BAAOF,IAAP,IAAeE,OAAOF,IAAP,EAAf;AACH;AAfiB,aAAtB;AAiBJ;AAvCA;AAAA;AAAA,6CAyC2BkB,GAzC3B,EAyCgCC,UAzChC,EAyC4CC,OAzC5C,EAyCoD;AACjD,gBAAIC,gBAAgB,SAAhBA,aAAgB,GAAI;AACpB,oBAAG,CAACC,GAAGC,sBAAP,EAA8B;AAC1BH;AACA;AACH;;AAEDE,mBAAGC,sBAAH,CAA0B;AACtBC,8BAAUN,GADY;AAEtBnB,6BAAS,iBAACc,GAAD,EAAO;AACZM;AACH,qBAJqB;AAKtBnB,0BAAM,cAACa,GAAD,EAAO;AACTO;AACH;AAPqB,iBAA1B;AASH,aAfD;AAgBAE,eAAGG,UAAH,CAAc;AACV1B,yBAAS,iBAACc,GAAD,EAAO;AACZ,wBAAI,CAACA,IAAIa,WAAJ,CAAgB,wBAAhB,CAAL,EAAgD;AAC5CJ,2BAAGK,SAAH,CAAa;AACTC,mCAAQ,wBADC;AAET7B,qCAAU,mBAAY;AAClBsB;AACH,6BAJQ;AAKTrB,kCAAK,gBAAY;AACb,oCAAGsB,GAAGO,WAAN,EAAkB;AACdP,uCAAGO,WAAH,CAAe;AACX9B,iDAAS,iBAACc,GAAD,EAAO;AACZC,oDAAQC,GAAR,CAAY,SAAZ,EAAsBF,GAAtB;AACA,gDAAGA,IAAIa,WAAJ,CAAgB,wBAAhB,CAAH,EAA6C;AACzCL;AACH,6CAFD,MAGI;AACAD;AACH;AACJ,yCATU;AAUXpB,8CAAM,cAACa,GAAD,EAAO;AACTC,oDAAQC,GAAR,CAAY,MAAZ,EAAmBF,GAAnB;AACAO;AACH;AAbU,qCAAf;AAeH,iCAhBD,MAiBI;AACAA;AACH;AACJ,6BA1BQ;AA2BTU,sCAAS,oBAAY,CACpB;AA5BQ,yBAAb;AA8BH,qBA/BD,MAgCI;AACAT;AACH;AACJ,iBArCS;AAsCVrB,sBAAM,cAACa,GAAD,EAAO;AACTO;AACH;AAxCS,aAAd;AA0CH;AACA;;;;;;;;AArGA;AAAA;AAAA,gCA4GeW,GA5Gf,EA4GoB;AAChBC,eAAGC,GAAH,CAAOC,YAAP,CAAoBC,UAApB,CAA+BJ,GAA/B;AACA;AACA,gBAAI,CAACK,KAAKC,UAAV,EACI;AACJf,eAAGgB,sBAAH,CAA0B;AACtBC,yBAAS,CAACR,GAAD,CADa;AAEtBhC,yBAAS,iBAACyC,GAAD,EAAS;AACd1B,4BAAQC,GAAR,CAAY,wBAAwBgB,GAAxB,GAA8B,WAA1C,EAAuDS,GAAvD;AACH,iBAJqB;AAKtBxC,sBAAM,cAACwC,GAAD,EAAS;AACX1B,4BAAQC,GAAR,CAAY,wBAAwBgB,GAAxB,GAA8B,QAA1C,EAAoDS,GAApD;AACH;AAPqB,aAA1B;AASH;AA1HD;AAAA;AAAA,uCA4HsBA,GA5HtB,EA4H2B;AACvB,gBAAIC,OAAO,IAAIC,IAAJ,EAAX;AACA,gBAAIC,UAAU;AACV,4BAAiBP,KAAKQ,UAAL,CAAgBC,OADvB;AAEV,wBAAiBJ,KAAKK,YAAL,EAFP;AAGV,6BAAiBV,KAAKQ,UAAL,CAAgBG,QAHvB;AAIV,2BAAiBX,KAAKY,QAAL,CAAcC,MAJrB;AAKV,+BAAiBb,KAAKY,QAAL,CAAcE,MALrB;AAMV,iCAAiBd,KAAKY,QAAL,CAAcG,KANrB;AAOV,+BAAiB,GAPP;AAQV,6BAAiBf,KAAKY,QAAL,CAAcI,UARrB;AASV,iCAAiBhB,KAAKQ,UAAL,CAAgBS,OATvB;AAUV,2BAAiBjB,KAAKkB,SAAL,CAAeC,WAVtB;AAWV,sBAAiBnB,KAAKY,QAAL,CAAcQ,EAXrB;AAYV,0BAAiBhB;AAZP,aAAd;AAcA;AACA,gBAAGG,OAAH,EAAY;AACR,oBAAIc,SAAS,EAAC,gBAAe,YAAhB,EAAb;AACA,oBAAIC,YAAY;AACZ,2BAAYtB,KAAKQ,UAAL,CAAgBe,cADhB;AAEZ,8BAAYF,MAFA;AAGZ,gCAAYd,OAHA;AAIZ,gCAAY,kBAACzC,MAAD,EAAU;AAClBY,gCAAQC,GAAR,CAAY,oBAAZ,EAAiCb,MAAjC;AACH;AANW,iBAAhB;AAQAkC,qBAAKwB,QAAL,CAAcC,QAAd,CAAuBH,SAAvB,EAAiC,MAAjC;AACH;AACJ;;AAED;;;;;;;;;;AA3JA;AAAA;AAAA,iCAoKgB3B,GApKhB,EAoKqB+B,KApKrB,EAoK4BC,UApK5B,EAoKwC;AACpCD,oBAAQA,QAAQ,EAAhB;AACA9B,eAAGC,GAAH,CAAOC,YAAP,CAAoB8B,OAApB,CAA4BjC,GAA5B,EAAiC+B,KAAjC;AACA;AACA,gBAAI,CAAC1B,KAAKC,UAAV,EACI;AACJ,gBAAI,CAAC0B,UAAL,EAAiB;AACb;AACA,oBAAIzC,GAAG2C,mBAAP,EAA4B;AACxB3C,uBAAG2C,mBAAH,CAAuB;AACnBC,oCAAY,CAAC;AACTnC,iCAAKA,GADI;AAET+B,mCAAOA;AAFE,yBAAD,CADO;AAKnB/D,iCAAS,iBAACyC,GAAD,EAAS;AACd1B,oCAAQC,GAAR,CAAY,wBAAwBgB,GAAxB,GAA8B,WAA1C,EAAuDS,GAAvD;AACH,yBAPkB;AAQnBxC,8BAAM,cAACwC,GAAD,EAAS;AACX1B,oCAAQC,GAAR,CAAY,wBAAwBgB,GAAxB,GAA8B,QAA1C,EAAoDS,GAApD;AACH;AAVkB,qBAAvB;AAYH;AACJ;AACJ;AACD;;;;;;;;;AA5LA;AAAA;AAAA,iCAoMeT,GApMf,EAoMoBoC,aApMpB,EAoMmC;AAChC;AACA,gBAAIC,IAAIpC,GAAGC,GAAH,CAAOC,YAAP,CAAoBmC,OAApB,CAA4BtC,GAA5B,CAAR;AACA,gBAAI,CAACqC,CAAL,EAAQ;AACJA,oBAAID,aAAJ;AACA,qBAAK,IAAIG,IAAI,CAAb,EAAgBA,IAAI,CAApB,EAAuBA,GAAvB,EAA4B;AACxB,wBAAIC,QAAQvC,GAAGC,GAAH,CAAOC,YAAP,CAAoBmC,OAApB,CAA4BtC,GAA5B,CAAZ;AACA,wBAAI,CAACwC,KAAL,EAAY;AACZH,wBAAIG,KAAJ;AACA;AACH;AACJ;AACD,mBAAOH,CAAP;AACH;;AAEA;;;;;;;;;;;;AAnNA;AAAA;AAAA,4CA8N2BI,GA9N3B,EA8NgCC,MA9NhC,EA8NwCC,UA9NxC,EA8NoDC,OA9NpD,EA8N4D;AACxD,gBAAI,CAACF,OAAOG,YAAR,IAAwB,CAACH,OAAOG,YAAP,CAAoB,CAApB,CAA7B,EAAqD,OAAO,KAAP;AACrD,gBAAIC,YAAY,SAAZA,SAAY,GAAM;AAClB,oBAAIH,UAAJ,EAAgBA;AACnB,aAFD;AAGA,gBAAII,YAAY,SAAZA,SAAY,GAAM;AAClB,oBAAIH,OAAJ,EAAaA;AAChB,aAFD;AAGA,gBAAII,KAAK9E,KAAT;;AAEAqB,eAAG0D,YAAH,CAAgB;AACZC,6BAAaR,OAAOG,YAAP,CAAoB,CAApB,CADD;AAEZ7E,yBAAS,iBAACc,GAAD,EAAS;AACdC,4BAAQC,GAAR,CAAY,6BAAZ,EAA2CF,GAA3C;AACA,wBAAI;AACA,4BAAIqE,KAAKrE,IAAIqE,EAAb;AACA,4BAAIC,gBAAgBtE,IAAIsE,aAAxB;AACA,4BAAIC,YAAYL,GAAGM,OAAH,CAAWjD,KAAKY,QAAL,CAAcsC,kBAAzB,EAA6CJ,EAA7C,EAAiDC,aAAjD,CAAhB;AACArE,gCAAQC,GAAR,CAAY,cAAZ,EAA4BqE,SAA5B;AACA,4BAAIA,aAAaA,cAAc,CAA/B,EAAkC;AAC9B,gCAAIG,YAAYC,KAAKC,KAAL,CAAWL,SAAX,CAAhB;AACA,gCAAIM,KAAQlB,GAAR,SAAee,UAAUI,OAA7B;AACA,gCAAIC,KAAKC,SAASd,GAAGe,QAAH,CAAYJ,EAAZ,EAAgB,CAAhB,CAAT,CAAT;AACA,gCAAIK,KAAK,IAAIrD,IAAJ,GAAWsD,OAAX,EAAT;AACAlF,oCAAQC,GAAR,CAAY,oCAAZ,EAAkD2E,EAAlD,SAA6DA,EAA7D,yCAA6DA,EAA7D;AACA,gCAAIK,KAAKH,EAAL,IAAW,IAAI,EAAJ,GAAS,EAAT,GAAc,IAA7B,EAAmC;AAC/Bb,mCAAGkB,QAAH,CAAYP,EAAZ,EAAgBK,EAAhB,EAAoB,IAApB;AACAlB;AACH,6BAHD,MAGO;AACHC;AACH;AACJ,yBAZD,MAYM;AACFA;AACH;AAEJ,qBArBD,CAqBE,OAAOoB,CAAP,EAAU;AACRpF,gCAAQC,GAAR,CAAY,SAAZ,EAAwBmF,CAAxB;AACApB;AACH;AACJ,iBA7BW;AA8BZ9E,sBAAM,gBAAM;AACR8E;AACH;AAhCW,aAAhB;AAkCH;;AAED;;;;;;;;AA5QA;AAAA;AAAA,uDAmRsCqB,SAnRtC,EAmRgD;AAC5C,gBAAIC,SAAS,IAAb;AACA,gBAAIC,UAAU,EAAd;AACA,gBAAGjE,KAAKkE,kBAAL,CAAwBC,WAAxB,CAAoCC,cAApC,CAAmDL,SAAnD,CAAH,EAAiE;AAC7DE,0BAAUjE,KAAKkE,kBAAL,CAAwBC,WAAxB,CAAoCJ,SAApC,CAAV;AACA,oBAAIM,WAAWZ,SAASa,KAAKC,MAAL,KAAgBN,QAAQO,MAAjC,CAAf;AACAR,yBAASC,QAAQI,QAAR,CAAT;AACH;AACD,mBAAOL,MAAP;AACH;AA5RD;AAAA;AAAA,gCA8RerE,GA9Rf,EA8RoBmD,EA9RpB,EA8RwB2B,OA9RxB,EA8RiC;AAC7B,gBAAIC,UAAU,CAAd;AACA,gBAAI;AACAD,0BAAU,IAAIE,MAAJ,CAAWF,OAAX,EAAoB,QAApB,CAAV;AACA3B,qBAAK,IAAI6B,MAAJ,CAAW7B,EAAX,EAAe,QAAf,CAAL;AACAnD,sBAAM,IAAIgF,MAAJ,CAAWhF,GAAX,EAAgB,QAAhB,CAAN;;AAEA,oBAAIiF,WAAWxH,OAAOyH,gBAAP,CAAwB,aAAxB,EAAuClF,GAAvC,EAA4CmD,EAA5C,CAAf;AACA8B,yBAASE,cAAT,CAAwB,IAAxB;;AAEAJ,0BAAUE,SAASG,MAAT,CAAgBN,OAAhB,EAAyB,QAAzB,EAAmC,MAAnC,CAAV;AACAC,2BAAWE,SAASI,KAAT,CAAe,MAAf,CAAX;AACH,aAVD,CAUE,OAAOC,GAAP,EAAY;AACVvG,wBAAQC,GAAR,CAAY,SAAZ,EAAuB,mBAAmBsG,GAA1C;AACH;AACD,mBAAOP,OAAP;AACH;;AAED;;;;;;;;;AAhTA;AAAA;AAAA,oCAwTmBtE,GAxTnB,EAwTwC;AAAA,gBAAhB8E,QAAgB,uEAAL,IAAK;;AACpC,gBAAGhG,GAAGiG,SAAN,EAAgB;AACZjG,mBAAGiG,SAAH,CAAa;AACTC,2BAAOhF,GADE;AAETiF,0BAAM,EAFG;AAGTH,8BAAUA;AAHD,iBAAb;AAKH,aAND,MAOI;AACAtF,mBAAG0F,KAAH,CAAS,sDAAT;AACH;AACJ;AACD;;;;;;;;;;;;AApUA;AAAA;AAAA,oCA+UmBC,OA/UnB,EA+UgG;AAAA,gBAApEH,KAAoE,uEAA5D,IAA4D;AAAA,gBAAtDI,WAAsD,uEAAxC,KAAwC;AAAA,gBAAjCC,OAAiC,uEAAvB,IAAuB;AAAA,gBAAjBC,SAAiB,uEAAL,IAAK;;AAC5FxG,eAAGyG,SAAH,CAAa;AACTP,uBAAOA,KADE;AAETG,yBAASA,OAFA;AAGTK,4BAAYJ,WAHH;AAIT7H,yBAAS,iBAASc,GAAT,EAAc;AACrB,wBAAIA,IAAIoH,OAAR,EAAiB;AACfnH,gCAAQC,GAAR,CAAY,QAAZ;AACA8G,mCAAWA,SAAX;AACD,qBAHD,MAGO,IAAIhH,IAAIqH,MAAR,EAAgB;AACrBpH,gCAAQC,GAAR,CAAY,QAAZ;AACA+G,qCAAaA,WAAb;AACD;AACF;AAZQ,aAAb;AAcH;AACD;;;;;;;AA/VA;AAAA;AAAA,uCAqWqB;AACjB,gBAAG,CAACpI,WAAD,IAAgB4B,GAAG6G,oBAAtB,EAA2C;AACvCzI,8BAAc4B,GAAG6G,oBAAH,CAAwB;AAClCV,0BAAM,OAD4B;AAElCW,2BAAO;AACHC,8BAAM,EADH;AAEHC,6BAAK,EAFF;AAGH/H,+BAAO,EAHJ;AAIHE,gCAAQ;AAJL;AAF2B,iBAAxB,CAAd;AASH;AACDf,wBAAY6I,IAAZ;AACH;AACD;;;;;;;AAnXA;AAAA;AAAA,uCAyXqB;AACjB,gBAAG7I,WAAH,EAAe;AACXA,4BAAY8I,IAAZ;AACH;AACJ;;AAED;;;;;;;;AA/XA;AAAA;AAAA,yDAsYuC;AACnC,gBAAG,CAACC,OAAOnH,EAAX,EAAe,OADoB,CACX;AACxB,gBAAG,CAACA,GAAGoH,cAAP,EAAuB,OAFY,CAEJ;AAC/BtG,iBAAKuG,GAAL,CAAS1I,KAAT,CAAe2I,eAAf;AACA,gBAAIC,WAAWvH,GAAGwH,iBAAH,EAAf;AACA,gBAAIC,MAAWF,SAASG,WAAxB;AACA,gBAAIC,MAAWJ,SAASK,YAAxB,CANmC,CAMG;AACtC;AACA,gBAAIC,SAAS/G,KAAKuG,GAAL,CAAS1I,KAAT,CAAemJ,KAAf,EAAb;AACAzJ,yBAAa2B,GAAGoH,cAAH,CAAkB;AAC3BW,0BAAUjH,KAAKuG,GAAL,CAASW,SAAT,CAAmBC,UAAnB,CAA8BC,QADb;AAE3BpB,uBAAO;AACHC,0BAAO,CADJ;AAEHC,yBAAO,CAFJ;AAGH/H,2BAAO4I,SAASJ,MAAM,GAAf,GAAqBA,MAAM;AAH/B;AAFoB,aAAlB,CAAb;;AASA,gBAAI;AACApJ,2BAAW8J,QAAX,CAAoB,UAAS5I,GAAT,EAAc;AAC9BC,4BAAQC,GAAR,CAAY,cAAZ,EAA4B,oBAAoBF,IAAIN,KAAxB,GAAgC,WAAhC,GAA8CM,IAAIJ,MAA9E;AACA,wBAAId,UAAJ,EAAgB;AACZ,4BAAI2I,MAAMW,MAAMpI,IAAIJ,MAAV,GAAmB,CAA7B,CADY,CACmB;AAC/Bd,mCAAWyI,KAAX,CAAiBC,IAAjB,GAAwB,CAACU,MAAMlI,IAAIN,KAAX,IAAoB,CAA5C;AACAZ,mCAAWyI,KAAX,CAAiBE,GAAjB,GAAwBA,GAAxB;AACA;AACA;AACH;AACJ,iBATD;AAUH,aAXD,CAWE,OAAOpC,CAAP,EAAU;AACRpF,wBAAQC,GAAR,CAAYmF,CAAZ;AACH;AACD;AACA,gBAAGvG,cAAc,CAACC,YAAlB,EAAgCD,WAAW4I,IAAX;AACnC;AACD;;;;;;;AAzaA;AAAA;AAAA,uCA+aqB;AACjB,gBAAG5I,UAAH,EAAc;AACVA,2BAAW6I,IAAX;AACH;AACD5I,2BAAe,IAAf;AACH;AACD;;;;;;;AArbA;AAAA;AAAA,uCA2bqB;AACjB,gBAAGD,UAAH,EAAc;AACVA,2BAAW4I,IAAX;AACH;AACD3I,2BAAe,KAAf;AACH;AACD;;;;;;;AAjcA;AAAA;AAAA,0CAucwB;AACpB,gBAAGD,UAAH,EAAc;AACVA,2BAAW6I,IAAX;AACA7I,2BAAW+J,OAAX;AACA/J,6BAAa,IAAb;AACH;AACJ;AACD;;;;;;;;;;AA9cA;AAAA;AAAA,oCAudmBO,MAvdnB,EAud0B;AACtB,gBAAG,CAACuI,OAAOnH,EAAX,EAAe,OADO,CACE;AACxB,gBAAG,CAACA,GAAGqI,qBAAP,EAA8B,OAFR,CAEgB;AACtC,gBAAG,CAAC9J,SAAJ,EAAc;AACVA,4BAAYyB,GAAGqI,qBAAH,CAAyB;AACjCN,8BAAUjH,KAAKuG,GAAL,CAASW,SAAT,CAAmBC,UAAnB,CAA8BK;AADP,iBAAzB,CAAZ;AAGA/J,0BAAUgK,OAAV,CAAkB,eAAK;AACnB,wBAAIC,YAAY,EAAhB;AACA,wBAAGjJ,OAAOA,IAAIkJ,OAAX,IAAsBlJ,QAAQmJ,SAAjC,EAA2C;AACvCF,oCAAY,QAAZ;AACAhK,wCAAgBC,OAAhB,IAA2BD,gBAAgBC,OAAhB,EAA3B;AACH,qBAHD,MAII;AACA+J,oCAAY,QAAZ;AACAhK,wCAAgBE,IAAhB,IAAwBF,gBAAgBE,IAAhB,EAAxB;AACH;AACDoC,yBAAKuG,GAAL,CAAS1I,KAAT,CAAegK,WAAf,MAA8BH,SAA9B;AACA1H,yBAAKuG,GAAL,CAAS1I,KAAT,CAAeiK,YAAf;AACH,iBAZD;AAaH;AACD;AACApK,4BAAgBC,OAAhB,GAA0BG,OAAOH,OAAjC;AACAD,4BAAgBE,IAAhB,GAAuBE,OAAOF,IAA9B;;AAEAH,sBAAUsK,IAAV,GAAiBC,IAAjB,CAAsB;AAAA,uBAAIvK,UAAU0I,IAAV,EAAJ;AAAA,aAAtB,EAA4C8B,KAA5C,CAAkD;AAAA,uBAAGvJ,QAAQC,GAAR,CAAYmF,CAAZ,CAAH;AAAA,aAAlD;AACA9D,iBAAKuG,GAAL,CAAS1I,KAAT,CAAeqK,YAAf;AACH;AACD;;;;;;;;AAnfA;AAAA;AAAA,sCA0fqBC,IA1frB,EA0f0B;AACtB,gBAAI,CAACA,IAAL,EAAW;AACXA,iBAAKC,SAAL,CACIxI,GAAGyI,QAAH,CACIzI,GAAG0I,OAAH,CAAW,IAAX,EAAiB,IAAjB,EAAuBC,MAAvB,CAA8B3I,GAAG4I,MAAH,CAAU,GAAV,CAA9B,CADJ,EAEI5I,GAAG0I,OAAH,CAAW,IAAX,EAAiB,GAAjB,EAAsBC,MAAtB,CAA6B3I,GAAG4I,MAAH,CAAU,GAAV,CAA7B,CAFJ,EAGI5I,GAAG0I,OAAH,CAAW,IAAX,EAAiB,CAAjB,EAAoBC,MAApB,CAA2B3I,GAAG4I,MAAH,CAAU,GAAV,CAA3B,CAHJ,CADJ;AAOH;AACD;;;;;;;;AApgBA;AAAA;AAAA,gCA2gBc;AACV,gBAAIC,MAAM,KAAV;AACA,gBAAIhC,WAAWvH,GAAGwH,iBAAH,EAAf;AACA,gBAAGD,SAAS1F,KAAT,KAAmB,UAAnB,IAAiC0F,SAAS3F,MAAT,CAAgB4H,OAAhB,CAAwB,KAAxB,IAAiC,CAAjC,IAAsCjC,SAASkC,YAAT,GAAwBlC,SAASmC,WAAjC,GAA+C,GAAzH,EAA6H;AACzH,uBAAO,IAAP;AACH;AACD,mBAAOH,GAAP;AACH;AAlhBD;;AAAA;AAAA,GAAJ;;AAqhBAI,OAAOC,OAAP,GAAiBjL,KAAjB","file":"Utils.js","sourceRoot":"../../../../../assets/Script/models","sourcesContent":["\nlet crypto = require('crypto');\nlet GameClubBtn = null; // * 游戏圈按钮\nlet WXBannerAD = null; // * 微信banner广告\nlet IsHideBanner = false; // * 是否显示Banner\nlet WXVedioAD = null; // * 微信Vedio广告\nlet WXVedioCallback = {\n    success: null,\n    fail: null\n}; // * 微信vedio回调\nlet Utils = class{\n    /**\n    * @param params Object\n    *        params.wisper_ming string 悄悄话 明文\n    *        params.wisper_an string 悄悄话 暗文\n    *        params.heard_url string 玩家头像\n    *        params.size cc.size 尺寸\n    *        params.bg string 背景图片\n    *        params.success function 成功回调\n    *        params.fail function 失败回调\n    * 流程:\n    * 1. 创建离屏canvas\n    * 2. 绘制背景\n    * 3. 绘制头像\n    * 4. 绘制文本\n    * 5. 截屏保存到本地\n    * 6. 将本地图片保存到相册\n    * @author lu ning\n    * @date 11:31 2018/7/5\n    * @return {Object} 返回值描述\n    */\n   static createAndSaveImg2WXAlbum(params){\n        canvas.toTempFilePath({\n            x: params.x,\n            y: params.y,\n            width:params.w, \n            height: params.h,\n            destWidth: params.w,\n            destHeight: params.h,\n            success: function success(res) {\n                console.log(res);\n            \n                Utils.saveImage2PhoneByUrl(res.tempFilePath, params.success, params.fail);\n            },\n            fail: function fail(res) {\n                // self.title.active = true;\n                params.fail && params.fail();\n            }\n    });\n   }\n\n   static saveImage2PhoneByUrl(url, cb_success, cb_fail){\n       let saveImg2Phone = ()=>{\n           if(!wx.saveImageToPhotosAlbum){\n               cb_fail();\n               return;\n           }\n\n           wx.saveImageToPhotosAlbum({\n               filePath: url,\n               success: (res)=>{\n                   cb_success();\n               },\n               fail: (res)=>{\n                   cb_fail();\n               }\n           });\n       };\n       wx.getSetting({\n           success: (res)=>{\n               if (!res.authSetting['scope.writePhotosAlbum']) {\n                   wx.authorize({\n                       scope : \"scope.writePhotosAlbum\",\n                       success : function () {\n                           saveImg2Phone();\n                       },\n                       fail:function () {\n                           if(wx.openSetting){\n                               wx.openSetting({\n                                   success: (res)=>{\n                                       console.log('success',res);\n                                       if(res.authSetting['scope.writePhotosAlbum']){\n                                           saveImg2Phone();\n                                       }\n                                       else{\n                                           cb_fail();\n                                       }\n                                   },\n                                   fail: (res)=>{\n                                       console.log('fail',res);\n                                       cb_fail();\n                                   }\n                               });\n                           }\n                           else{\n                               cb_fail();\n                           }\n                       },\n                       complete:function () {\n                       }\n                   });\n               }\n               else{\n                   saveImg2Phone();\n               }\n           },\n           fail: (res)=>{\n               cb_fail();\n           }\n       });\n   }\n    /**\n     * * 删除存储在本地的指定数据\n     *\n     * @static\n     * @param {String} key 标识\n     * @returns\n     */\n    static delItem(key) {\n        cc.sys.localStorage.removeItem(key);\n        //localValues.delete(key);\n        if (!tywx.isInWXChat)\n            return;\n        wx.removeUserCloudStorage({\n            keyList: [key],\n            success: (msg) => {\n                console.log('removeObjectCloud  ' + key + ' succeeds', msg);\n            },\n            fail: (msg) => {\n                console.log('removeObjectCloud  ' + key + ' fails', msg);\n            },\n        });\n    }\n\n    static uploadErrorMsg(msg) {\n        let time = new Date();\n        let err_obj = {\n            \"cloud_id\"     : tywx.SystemInfo.cloudId,\n            \"time\"         : time.toDateString(),\n            \"client_id\"    : tywx.SystemInfo.clientId,\n            \"user_id\"      : tywx.UserInfo.userId,\n            \"sys_version\"  : tywx.UserInfo.system,\n            \"mobile_models\": tywx.UserInfo.model,\n            \"baseVersion\"  : \"0\",\n            \"wxVersion\"    : tywx.UserInfo.wechatType,\n            \"clientVersion\": tywx.SystemInfo.version,\n            \"Nettype\"      : tywx.StateInfo.networkType,\n            \"ip\"           : tywx.UserInfo.ip,\n            \"errMsg\"       : msg\n        };\n        //let err_str = String(err_obj);\n        if(err_obj) {\n            var header = {'Content-Type':'text/plain'};\n            var configObj = {\n                'url'     : tywx.SystemInfo.errorTxtServer,\n                'header'  : header,\n                'postData': err_obj,\n                'callback': (params)=>{\n                    console.log('uploadErrorMsg===>',params);\n                }\n            };\n            tywx.HttpUtil.httpPost(configObj,'POST');\n        }\n    }\n\n    /**\n     * * 保存数据到本地\n     *\n     * @static\n     * @param {String} key 标识\n     * @param {any} value\n     * @param {boolean} only_local 是否只保存在本地,false的情况，上传到腾讯云\n     * @returns\n     */\n    static saveItem(key, value, only_local) {\n        value = value + '';\n        cc.sys.localStorage.setItem(key, value);\n        //localValues.set(key, value);\n        if (!tywx.isInWXChat)\n            return;\n        if (!only_local) {\n            //FIXED: 做版本检测，版本低的会有黑屏\n            if (wx.setUserCloudStorage) {\n                wx.setUserCloudStorage({\n                    KVDataList: [{\n                        key: key,\n                        value: value\n                    }],\n                    success: (msg) => {\n                        console.log('saveObjectToCloud  ' + key + ' succeeds', msg);\n                    },\n                    fail: (msg) => {\n                        console.log('saveObjectToCloud  ' + key + ' fails', msg);\n                    },\n                });\n            }\n        }\n    }\n    /**\n     * * 加载保存在本地的数据\n     *\n     * @static\n     * @param {String} key 标识\n     * @param {any} default_value 默认值\n     * @returns\n     */\n   static loadItem(key, default_value) {\n       //if(localValues.has(key)) return localValues.get(key);\n       var v = cc.sys.localStorage.getItem(key);\n       if (!v) {\n           v = default_value;\n           for (let i = 0; i < 3; i++) {\n               let tmp_v = cc.sys.localStorage.getItem(key);\n               if (!tmp_v) continue;\n               v = tmp_v;\n               break;\n           }\n       }\n       return v;\n   }\n\n    /**\n     * @description 分享到不同群限制\n     * @author lu ning\n     * @date 2018-08-22\n     * @static\n     * @param {String} tag 分享tag\n     * @param {Object} result 分享返回值\n     * @param {Function} success_cb 成功回调\n     * @param {Function} fail_cb 失败回调\n     * @returns\n     */\n    static share2GroupByTicket(tag, result, success_cb, fail_cb){\n        if (!result.shareTickets || !result.shareTickets[0]) return false;\n        let call_succ = () => {\n            if (success_cb) success_cb();\n        };\n        let call_fail = () => {\n            if (fail_cb) fail_cb();\n        };\n        let ff = Utils;\n\n        wx.getShareInfo({\n            shareTicket: result.shareTickets[0],\n            success: (res) => {\n                console.log('isCanShare2GroupByTicket==>', res);\n                try {\n                    let iv = res.iv;\n                    let encryptedData = res.encryptedData;\n                    let resultStr = ff.decrypt(tywx.UserInfo.wxgame_session_key, iv, encryptedData);\n                    console.log('resultStr==>', resultStr);\n                    if (resultStr && resultStr !== 0) {\n                        let resultObj = JSON.parse(resultStr);\n                        let id = `${tag}_${resultObj.openGId}`;\n                        let t0 = parseInt(ff.loadItem(id, 0));\n                        let tc = new Date().getTime();\n                        console.log('isCanShare2GroupByTicket==>openGId', id, typeof id);\n                        if (tc - t0 >= 8 * 60 * 60 * 1000) {\n                            ff.saveItem(id, tc, true);\n                            call_succ();\n                        } else {\n                            call_fail();\n                        }\n                    }else {\n                        call_fail();\n                    }\n\n                } catch (e) {\n                    console.log(\"share::\" , e);\n                    call_fail();\n                }\n            },\n            fail: () => {\n                call_fail();\n            }\n        });\n    }\n\n    /**\n     * @description 获取随机分享数据\n     * @author lu ning\n     * @date 2018-08-23\n     * @static\n     * @param {String} share_tag\n     */\n    static getRandomShareConfigByShareTag(share_tag){\n        let config = null;\n        let tmp_arr = [];\n        if(tywx.PropagateInterface.ShareConfig.hasOwnProperty(share_tag)){\n            tmp_arr = tywx.PropagateInterface.ShareConfig[share_tag];\n            let rand_idx = parseInt(Math.random() * tmp_arr.length);\n            config = tmp_arr[rand_idx];\n        }\n        return config;\n    }\n\n    static decrypt(key, iv, crypted) {\n        var decoded = 0;\n        try {\n            crypted = new Buffer(crypted, 'base64');\n            iv = new Buffer(iv, 'base64');\n            key = new Buffer(key, 'base64');\n\n            var decipher = crypto.createDecipheriv('aes-128-cbc', key, iv);\n            decipher.setAutoPadding(true);\n\n            decoded = decipher.update(crypted, 'binary', 'utf8');\n            decoded += decipher.final('utf8');\n        } catch (err) {\n            console.log(\"decrypt\", \" catch error: \" + err);\n        }\n        return decoded;\n    }\n\n    /**\n     * @description \n     * @author lu ning\n     * @date 2018-08-24\n     * @static\n     * @param {String} msg\n     * @param {number} [duration=1000]\n     */\n    static showWXToast(msg, duration = 1000){\n        if(wx.showToast){\n            wx.showToast({\n                title: msg,\n                icon: '',\n                duration: duration\n            });\n        }\n        else{\n            cc.error('showWXToast error can not find function wx.showToast');\n        }\n    }\n    /**\n     * @description 显示模态窗\n     * @author lu ning\n     * @date 2018-08-24\n     * @static\n     * @param {String} content 显示内容\n     * @param {String} [title='提示'] title\n     * @param {boolean} [show_cancle=false]  是否显示取消\n     * @param {Function} [sure_cb=null] 确定按钮回调\n     * @param {Function} [cancle_cb=null] 取消按钮回调\n     */\n    static showWXModal(content, title = '提示', show_cancel = false, sure_cb = null, cancle_cb = null){\n        wx.showModal({\n            title: title,\n            content: content,\n            showCancel: show_cancel,\n            success: function(res) {\n              if (res.confirm) {\n                console.log('用户点击确定');\n                sure_cb && sure_cb();\n              } else if (res.cancel) {\n                console.log('用户点击取消');\n                cancle_cb && cancle_cb();\n              }\n            }\n        });\n    }\n    /**\n     * @description 显示游戏圈\n     * @author lu ning\n     * @date 2018-09-05\n     * @static\n     */\n    static showGameClub(){\n        if(!GameClubBtn && wx.createGameClubButton){\n            GameClubBtn = wx.createGameClubButton({\n                icon: 'green',\n                style: {\n                    left: 10,\n                    top: 30,\n                    width: 40,\n                    height: 40\n                }\n            });\n        }\n        GameClubBtn.show();\n    }\n    /**\n     * @description 隐藏游戏圈\n     * @author lu ning\n     * @date 2018-09-05\n     * @static\n     */\n    static hideGameClub(){\n        if(GameClubBtn){\n            GameClubBtn.hide();\n        }\n    }\n\n    /**\n     * @description 创建并显示微信Banner广告, IsHideBanner=false到时候创建成功也不会显示\n     * @author lu ning\n     * @date 2018-09-06\n     * @static\n     * @returns\n     */\n    static createAndcreateAndShowWXBanner(){\n        if(!window.wx) return;  //! 防止浏览器中报错\n        if(!wx.createBannerAd) return; //! 玩家基础库不支持\n        tywx.ado.Utils.destroyWXBanner();\n        let sys_info = wx.getSystemInfoSync();\n        let s_w      = sys_info.screenWidth;\n        let s_h      = sys_info.screenHeight; // 220\n        // ! 强制适配,主要是ipx有问题\n        let is_ipx = tywx.ado.Utils.isIpx();\n        WXBannerAD = wx.createBannerAd({\n            adUnitId: tywx.ado.Constants.WXAdConfig.bannerId,\n            style: {\n                left : 0,\n                top  : 0,\n                width: is_ipx ? s_w * 0.8 : s_w * 0.95\n            }\n        });\n        \n        try {\n            WXBannerAD.onResize(function(res) {\n                console.log('showBannerAd', '当前banner,width:' + res.width + \"; height:\" + res.height);\n                if (WXBannerAD) {\n                    let top = s_h - res.height - 5;//is_ipx ? s_h - res.height + 50 : s_h - res.height - 5;\n                    WXBannerAD.style.left = (s_w - res.width) / 2;\n                    WXBannerAD.style.top  = top;    \n                    //res.width             = is_ipx ? s_w * 0.8 : s_w * 0.9;\n                    //res.height            = s_h * 0.13;\n                }\n            });\n        } catch (e) {\n            console.log(e);\n        }\n        // * 隐藏状态不显示banner\n        if(WXBannerAD && !IsHideBanner) WXBannerAD.show();\n    }\n    /**\n     * @description 隐藏Banner广告,隐藏后，若需要显示，必须调用showWXBanner()\n     * @author lu ning\n     * @date 2018-09-06\n     * @static\n     */\n    static hideWXBanner(){\n        if(WXBannerAD){\n            WXBannerAD.hide();\n        }\n        IsHideBanner = true;\n    }\n    /**\n     * @description 显示Banner广告\n     * @author lu ning\n     * @date 2018-09-06\n     * @static\n     */\n    static showWXBanner(){\n        if(WXBannerAD){\n            WXBannerAD.show();\n        }\n        IsHideBanner = false;\n    }\n    /**\n     * @description 销毁Banner\n     * @author lu ning\n     * @date 2018-09-06\n     * @static\n     */\n    static destroyWXBanner(){\n        if(WXBannerAD){\n            WXBannerAD.hide();\n            WXBannerAD.destroy();\n            WXBannerAD = null;\n        }\n    }\n    /**\n     * @description 显示视频广告\n     * @author lu ning\n     * @date 2018-09-06\n     * @static\n     * @param {Object} params\n     * @param {Function} params.success\n     * @param {Function} params.fail\n     */\n    static showWXVideo(params){\n        if(!window.wx) return;  //! 防止浏览器中报错\n        if(!wx.createRewardedVideoAd) return; //! 玩家基础库不支持\n        if(!WXVedioAD){\n            WXVedioAD = wx.createRewardedVideoAd({\n                adUnitId: tywx.ado.Constants.WXAdConfig.vedioId\n            });\n            WXVedioAD.onClose(res=>{\n                let toast_str = '';\n                if(res && res.isEnded || res === undefined){\n                    toast_str = '视频观看成功';\n                    WXVedioCallback.success && WXVedioCallback.success();\n                }\n                else{\n                    toast_str = '视频观看失败';\n                    WXVedioCallback.fail && WXVedioCallback.fail();\n                }\n                tywx.ado.Utils.showWXModal(`${toast_str}`);\n                tywx.ado.Utils.showWXBanner();\n            });\n        }\n        // * 成功和失败回调是变化的\n        WXVedioCallback.success = params.success;\n        WXVedioCallback.fail = params.fail;\n\n        WXVedioAD.load().then(()=>WXVedioAD.show()).catch(e=>console.log(e));\n        tywx.ado.Utils.hideWXBanner();\n    }\n    /**\n     * @description 通用缩放动画\n     * @author lu ning\n     * @date 2018-09-06\n     * @static\n     * @param {cc.Node} node\n     */\n    static commonScaleIn(node){\n        if (!node) return;\n        node.runAction(\n            cc.sequence(\n                cc.scaleTo(0.08, 0.95).easing(cc.easeIn(3.0)),\n                cc.scaleTo(0.12, 1.1).easing(cc.easeIn(3.0)),\n                cc.scaleTo(0.08, 1).easing(cc.easeIn(3.0))\n            )\n        );\n    }\n    /**\n     * @description 是否是iphoneX\n     * @author lu ning\n     * @date 2018-09-07\n     * @static\n     * @returns\n     */\n    static isIpx(){\n        let ret = false;\n        let sys_info = wx.getSystemInfoSync();\n        if(sys_info.model === 'iPhone X' || sys_info.system.indexOf('iOS') > 0 && sys_info.windowHeight / sys_info.windowWidth > 1.9){\n            return true;\n        }\n        return ret;\n    }\n};\n\nmodule.exports = Utils;"]}