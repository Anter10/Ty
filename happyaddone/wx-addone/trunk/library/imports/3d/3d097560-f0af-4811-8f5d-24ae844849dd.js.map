{"version":3,"sources":["../../../../../assets/Script/models/assets/Script/models/GeZiData.js"],"names":["config","require","module","exports","parent","color","num","posx","posy","destx","desty","actiontime_keep","speed_keep","id_keep","id_dest","speedx","speedy","actiontime","effectid","effecttime","setinfo","c","n","setpos","x","y","setspeed","spx","spy","t","setdest","adjustmove","alp","getAllgz","adjustdrop","tywx","move_time","tickmove","dt","getAllmask","from","tickeffect","spr0","spr1"],"mappings":"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","file":"GeZiData.js","sourceRoot":"../../../../../assets/Script/models","sourcesContent":["/*\n    每个格子的单元数据:\n    created by gyc on 2018-08-01.\n*/\nvar config = require(\"AddOneConfig\")\n\nmodule.exports = (function(parent){\n    // 格子显示的颜色\n    this.color = null;\n    // 格子显示的数字\n    this.num  = 0;\n    // 格子的X位置\n    this.posx = 0;\n    // 格子的Y位置\n    this.posy = 0;\n    // 格子的目标位置X\n    this.destx=0;\n    // 格子的目标位置Y\n    this.desty=0;\n    // 格子动作持续时间\n    this.actiontime_keep=0;\n    // 各自的移动速度\n    this.speed_keep=0;\n    this.id_keep=-1;\n    this.id_dest=-1;\n    this.parent= parent;\n    this.speedx=0;\n    this.speedy=0;\n    this.actiontime=0;\n\n    this.effectid=-1;\n    this.effecttime=0;\n    \n    /*\n        调用: GeZi中调用\n        功能: 更新格子的颜色和显示数字\n        参数: [\n            c: 格子显示的颜色\n            n: 显示的数字\n        ]\n        返回值:[\n            无\n        ]\n        思路: 逻辑需要\n    */\n    this.setinfo=function(c,n){\n        this.color=c;\n        this.num=n;\n    }\n\n    /*\n        调用: GeZi中调用\n        功能: 更新格子x,y坐标\n        参数: [\n            x: 格子的x坐标\n            y: 格子的y坐标\n        ]\n        返回值:[\n            无\n        ]\n        思路: 逻辑需要\n    */\n    this.setpos=function(x,y){\n        this.posx=x;\n        this.posy=y;\n    }\n\n    /*\n        调用: GeZi中调用\n        功能: 更新格子的颜色和显示数字\n        参数: [\n            spx: x方向的速度\n            spy: y方向的速度\n            t: 持续时间\n        ]\n        返回值:[\n            无\n        ]\n        思路: 逻辑需要\n    */\n    this.setspeed=function(spx,spy,t){\n        this.speedx=spx;\n        this.speedy=spy;\n        this.actiontime=t;\n    }\n    \n    /*\n        调用: GeZi中调用\n        功能: 更新格子的目标坐标\n        参数: [\n            x: 格子的x目标坐标\n            y: 格子的y目标坐标\n        ]\n        返回值:[\n            无\n        ]\n        思路: 逻辑需要\n    */\n    this.setdest=function(x,y){\n        this.destx=x;\n        this.desty=y;\n    }\n    \n      /*\n        调用: GeZiData, gamemain中调用\n        功能: 调整格子移动\n        参数: [\n            无\n        ]\n        返回值:[\n            无\n        ]\n        思路: 逻辑需要\n    */\n    this.adjustmove=function(){\n        if(this.id_dest==-1)\n            return;\n\n        this.actiontime = this.actiontime_keep;\n        var alp = this.id_dest - this.id_keep;\n        if(alp==1){\n            this.speedx = this.speed_keep;\n            this.speedy = 0;\n        }else if(alp==5){\n            this.speedx = 0;\n            this.speedy = this.speed_keep;\n        }else if(alp==-1){\n            this.speedx = -this.speed_keep;\n            this.speedy = 0;\n        }else if(alp==-5){\n            this.speedx = 0;\n            this.speedy = -this.speed_keep;\n        }\n\n        this.destx=this.parent.getAllgz()[this.id_dest].posx;\n        this.desty=this.parent.getAllgz()[this.id_dest].posy;\n    }\n   \n    /*\n        调用: gamemain中调用\n        功能: 调整格子掉落\n        参数: [\n            无\n        ]\n        返回值:[\n            无\n        ]\n        思路: 逻辑需要\n    */\n    this.adjustdrop=function(){\n        if(this.id_dest==-1)\n            return;\n        config = tywx.config != null?tywx.config : config;\n        this.actiontime=config.move_time;\n        this.speedx = 0;\n        this.speedy = -this.speed_keep;\n        this.destx=this.parent.getAllgz()[this.id_dest].posx;\n        this.desty=this.parent.getAllgz()[this.id_dest].posy;\n    }\n   \n   /*\n        调用: gamemain中调用\n        功能: 格子移动\n        参数: [\n            无\n        ]\n        返回值:[\n            无\n        ]\n        思路: 逻辑需要\n    */\n    this.tickmove=function(dt){\n        if(this.actiontime>0){\n            this.actiontime -= dt;\n\n            this.posx += this.speedx*dt;\n            this.posy += this.speedy*dt;\n\n            if(this.actiontime<=0){\n                this.posx = this.destx;\n                this.posy = this.desty;\n                this.speedx = 0;\n                this.speedy = 0;\n                this.id_keep = this.id_dest;\n                this.id_dest = this.parent.getAllmask()[this.id_dest].from;\n                this.adjustmove();\n            }\n        }\n    }\n    \n     /*\n        调用: gamemain中调用\n        功能: 格子移动\n        参数: [\n            dt: update传进来的值\n            spr0:星星1的节点\n            spr1:星星2的节点\n        ]\n        返回值:[\n            无\n        ]\n        思路: 逻辑需要\n    */\n    this.tickeffect = function(dt,spr0,spr1){\n        // if(this.effectid >= 0 && this.effecttime > 0){\n        //    if(this.effectid==1){\n        //         spr1.node.x = this.posx + config.gezi_size / 2;\n        //         spr1.node.y = this.posy + config.gezi_size / 2;\n\n        //         spr1.node.setScale(1 - this.effecttime);\n        //         if(spr1.node.active == false){\n        //            spr1.node.active = true;\n        //         }\n        //     }\n\n        //     this.effecttime -= dt;\n\n        //     if(this.effecttime <= 0){\n        //         this.effecttime = 0;\n        //         if(spr0.node.active == true && this.effectid==0){\n        //             spr0.node.active = false;\n        //         }\n        //         if(spr1.node.active == true && this.effectid==1){\n        //             spr1.node.active = false;\n        //         }\n        //         this.effectid = -1;\n        //     }\n        // }\n    }\n});\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"]}