{"version":3,"sources":["ShareButton.js"],"names":["cc","Class","extends","Component","properties","onLoad","data","start","setShareData","setShareConfig","config","shareConfig","setSuccessCall","successCall","successCallBack","setReactCall","reactcall","setErrorCall","errorCall","errorCallBack","setShareGroupCall","sgroupCall","shareGroupCallBack","shareMiniApp","self","tywx","IsWechatPlatform","window","wx","showShareMenu","withShareTicket","msg","ado","Utils","getRandomShareConfigByShareTag","LOGE","JSON","stringify","ShareInterface","share","shareContent","sharePicUrl","sharePointId","shareSchemeId","res","shareTickets","undefined","length","Constants","ShareConfig","RANK_SHARE","share2GroupByTicket","showWXModal"],"mappings":"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","file":"ShareButton.js","sourceRoot":"../../../../../assets/Script/models","sourcesContent":[" /*\n     游戏分享prefab\n     游戏的分享操作的主要逻辑在这个module里面编写\n     created by gyc on 2018-08-08.\n */\n cc.Class({\n     extends: cc.Component,\n\n     properties: {\n\n     },\n\n     /*\n        调用: 场景加载完成后的回调\n        功能: 场景加载完成后的一些UI逻辑处理\n        参数: [\n            无\n        ]\n        返回值:[\n            无\n        ]\n        思路: 系统自带\n    */\n     onLoad() {\n         this.data = {};\n     },\n     /*\n         调用: 组件开始调用的时候调用\n         功能: 组件开始调用的时候的逻辑处理\n         参数: [\n             无\n         ]\n         返回值:[\n             无\n         ]\n         思路: 系统自带\n     */\n     start() {\n\n     },\n\n     /*\n         调用: 使用此model分享功能的时候 手动调用刷新分享的数据\n         功能: 设置即将要分享的数据\n         参数: [\n             data: 分享的数据\n         ]\n         返回值:[\n             无\n         ]\n         思路: 系统自带\n     */\n     setShareData: function (data) {\n         this.data = data;\n     },\n     /**\n      * @description 设置分享配置\n      * @author lu ning\n      * @date 2018-08-23\n      * @param {Array<any>} config config[0]=tag;config[1]=是否强制分享到群,boolean\n      */\n     setShareConfig(config) {\n         this.shareConfig = config;\n     },\n\n     /*\n        调用: 使用此model分享功能的时候 \n        功能: 手动设置分享成功后的回调函数\n        参数: [\n            successCall: 分享成功后的回调方法 类型Function\n        ]\n        返回值:[\n            无\n        ]\n        思路: 逻辑需要\n    */\n     setSuccessCall: function (successCall) {\n         this.successCallBack = successCall;\n     },\n\n\n     /*\n         调用: 使用此model分享功能的时候 \n         功能: 手动设置分享成功后的回调函数\n         参数: [\n             successCall: 分享成功后的回调方法 类型Function\n         ]\n         返回值:[\n             无\n         ]\n         思路: 逻辑需要\n     */\n     setReactCall: function (reactcall) {\n         this.reactcall = reactcall;\n     },\n\n     /*\n        调用: 使用此model分享功能的时候 \n        功能: 手动设置分享失败后的回调函数\n        参数: [\n            errorCall: 分享失败后的回调方法 类型Function\n        ]\n        返回值:[\n            无\n        ]\n        思路: 逻辑需要\n    */\n     setErrorCall: function (errorCall) {\n         this.errorCallBack = errorCall;\n     },\n\n     /*\n         调用: 使用此model分享功能的时候 \n         功能: 手动设置分享失败后的回调函数\n         参数: [\n             errorCall: 分享失败后的回调方法 类型Function\n         ]\n         返回值:[\n             无\n         ]\n         思路: 逻辑需要\n     */\n     setShareGroupCall: function (sgroupCall) {\n         this.shareGroupCallBack = sgroupCall;\n     },\n\n\n\n     /*\n         调用: 使用此model分享功能的时候 \n         功能: 给好友或者群分享小程序的相关信息\n         参数: [\n             无\n         ]\n         返回值:[\n             无\n         ]\n         思路: 逻辑需要\n     */\n     shareMiniApp: function () {\n         var self = this;\n         if (this.reactcall) {\n             self.successCallBack(this);\n         } else {\n             if (tywx.IsWechatPlatform()) {\n                 window.wx.showShareMenu({\n                     withShareTicket: true\n                 });\n                 let msg = tywx.ado.Utils.getRandomShareConfigByShareTag(this.shareConfig[0]);\n                 tywx.LOGE(\"msg = \" + JSON.stringify(msg));\n                 if (msg) {\n                     tywx.ShareInterface.share(\n                         msg.shareContent,\n                         msg.sharePicUrl,\n                         msg.sharePointId,\n                         msg.shareSchemeId,\n                         (res) => {\n                             tywx.LOGE(\"分享成功后的数据\" + JSON.stringify(res));\n                             // * is share to group\n                             if (self.shareConfig && self.shareConfig[1]) {\n                                 // * froce share to group\n                                 if (res.shareTickets !== undefined && res.shareTickets.length > 0) {\n                                     if (self.shareConfig[0] === tywx.ado.Constants.ShareConfig.RANK_SHARE[0]) {\n                                         self.shareGroupCallBack && self.shareGroupCallBack(res);\n                                     } else {\n                                         tywx.ado.Utils.share2GroupByTicket(\n                                             self.shareConfig[0],\n                                             res,\n                                             () => { // * success callback\n                                                 self.shareGroupCallBack && self.shareGroupCallBack(res);\n                                             },\n                                             () => { // * failed callback\n                                                 tywx.ado.Utils.showWXModal('请分享到不同群');\n                                                 self.errorCallBack && self.errorCallBack(null);\n                                             }\n                                         );\n                                     }\n                                 } else {\n                                     // * failed\n                                     tywx.ado.Utils.showWXModal('请分享到群');\n                                     self.errorCallBack && self.errorCallBack(null);\n                                 }\n                             } else {\n                                 // * success\n                                 self.successCallBack && self.successCallBack(res);\n                             }\n\n                         },\n                         function (data) {\n                             tywx.LOGE(\"分享成功后的数2据\" + JSON.stringify(data));\n                             self.errorCallBack && self.errorCallBack(data);\n                         }\n                     );\n                 }\n             }\n         }\n     }\n     // update (dt) {},\n });"]}