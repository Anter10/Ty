{"version":3,"sources":["../../../../assets/Script/assets/Script/gamestart.js"],"names":["config","require","tywx","publicwx","curscene","gamestart","cc","Class","extends","Component","properties","startButton","default","type","Button","backButton","audioCtr","Prefab","userItem","gameScore","Label","historyLabel","phbNameLabel","phb","phbback","Sprite","helpback","giftback","Node","method","phbSprite","phbShareBtn","shareBtn","groupBtn","phbView","helpview","giftview","helpViewPre","contentView","icon","requestTimes","start","tex","Texture2D","window","sharedCanvas","width","height","showPhb","_updateSubDomainCanvas","openDataContext","wx","getOpenDataContext","canvas","initWithElement","handleLoadedTexture","spriteFrame","SpriteFrame","ctor","update","delayTime","onLoad","postMessage","MAIN_MENU_NUM","getComponent","setShareConfig","ado","Constants","ShareConfig","RANK_SHARE","console","log","JSON","stringify","view","getDevicePixelRatio","getVisibleSize","PropagateInterface","getShareConfigInfo","msg","ShareInterface","getRandomOnShareAppMessageInfo","setOnShareAppMessageInfo","title","imageUrl","sharePointId","shareSchemeId","shareComponent","setErrorCall","data","setSuccessCall","FIRST_PAGE_SHARE","groupBtnComponent","self","setShareGroupCall","active","shareTicket","shareTickets","string","Timer","setTimer","score","Util","getItemFromLocalStorage","length","node","x","tx","on","event","hideBack","givePlayerItems","firstShowHelpView","requestConfigInfo","showPlayMethod","helpviewpre","destroy","instantiate","parent","y","helpviewscript","setCloseCall","showBack","showGiftView","showFriendPhbView","hidePhbView","loadFinishCallBack","setScore","Math","abs","startGame","director","loadScene","shareApp","IsWechatPlatform","shareAppMessage","_configUrl","SystemInfo","cdnPath","that","successcb","ret","v","version","uid","parseInt","UserInfo","userId","c","cb","d","tconfig","k","undefined","move_time","partLJTime","Configs","failcb","HttpUtil","httpGet","opacity","setItemToLocalStorage","giveitems","djIndex","GameCenterConfig","allitem","titem","id","num","initGivePlayerItemNumber","push"],"mappings":"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","file":"gamestart.js","sourceRoot":"../../../../assets/Script","sourcesContent":["/*\n   游戏开始界面\n   created by gyc on 2018-08-02.\n   final changed time by gyc on  2018-08-03\n*/\nvar config = require(\"AddOneConfig\")\ntywx.publicwx = true;\n\nvar curscene = null;\nvar gamestart = cc.Class({\n    extends: cc.Component,\n    properties: {\n        startButton: {\n            default: null,\n            type: cc.Button,\n        },\n        backButton: {\n            default: null,\n            type: cc.Button,\n        },\n        audioCtr: {\n            default: null,\n            type: cc.Prefab,\n        },\n        userItem: {\n            default: null,\n            type: cc.Prefab,\n        },\n        gameScore: {\n            default: null,\n            type: cc.Label,\n        },\n        historyLabel: {\n            default: null,\n            type: cc.Label,\n        },\n\n        phbNameLabel: {\n             default: null,\n             type: cc.Label,\n        },\n        phb: {\n            default: null,\n            type: cc.Button,\n        },\n        phbback: {\n            default: null,\n            type: cc.Sprite,\n        },\n        helpback: {\n            default: null,\n            type: cc.Sprite,\n        },\n        giftback: {\n            default: null,\n            type: cc.Node,\n        },\n        method: {\n            default: null,\n            type: cc.Button,\n        },\n        phbSprite: {\n            default: null,\n            type: cc.Sprite,\n        },\n        phbShareBtn: {\n            default: null,\n            type: cc.Node,\n        },\n        shareBtn: {\n            default: null,\n            type: cc.Node,\n        },\n        groupBtn: {\n            default: null,\n            type: cc.Node,\n        },\n        phbView: {\n            default: null,\n            type: cc.Node,\n        },\n\n        helpview: {\n            default: null,\n            type: cc.Node,\n        },\n\n        giftview: {\n            default: null,\n            type: cc.Node,\n        },\n\n        helpViewPre: {\n            default: null,\n            type: cc.Prefab,\n        },\n        contentView: {\n            default: null,\n            type: cc.Node,\n        },\n\n        icon: cc.Sprite,\n        //! 请求次数上线\n        requestTimes: 3,\n    },\n\n    start() {\n        //是否发布微信版本\n        if (tywx.publicwx) {\n            this.tex = new cc.Texture2D();\n            window.sharedCanvas.width = 635;\n            window.sharedCanvas.height = 60 * 30;\n        }\n        this.showPhb = false;\n    },\n\n    // 刷新子域的纹理\n    _updateSubDomainCanvas: function () {\n        if (!this.tex) {\n            return;\n        }\n        var openDataContext = wx.getOpenDataContext();\n        var sharedCanvas = openDataContext.canvas;\n        this.tex.initWithElement(sharedCanvas);\n        this.tex.handleLoadedTexture();\n        this.phbSprite.spriteFrame = new cc.SpriteFrame(this.tex);\n    },\n\n    /*\n        调用: 系统new 的时候调用。\n        功能: 该类的构造函数 可用于自身变量的初始化\n        参数: [\n            无\n        ]\n        返回值:[\n            无\n        ]\n        思路: 系统自带\n    */\n    ctor: function () {\n\n    },\n\n    update: function (delayTime) {\n        if (tywx.publicwx) {\n            //    this._updateSubDomainCanvas();   \n        }\n    },\n\n\n\n\n    /*\n        调用: 界面加载完成后的回调。\n        功能: 该类的构造函数 可用于自身变量的初始化\n        参数: [\n            无\n        ]\n        返回值:[\n            无\n        ]\n        思路: 系统自带\n    */\n    onLoad: function () {\n        wx.postMessage({\n            method: \"load_data\",\n            MAIN_MENU_NUM: \"x1\",\n        });\n        // this.contentView.height = 60 * 30; \n        this.phbShareBtn.getComponent(\"ShareButton\").setShareConfig(tywx.ado.Constants.ShareConfig.RANK_SHARE);\n        console.log(\"当前屏幕尺寸  \" + JSON.stringify(cc.view.getDevicePixelRatio()) + JSON.stringify(cc.view.getVisibleSize()));\n        tywx.PropagateInterface.getShareConfigInfo(); //! 获取所有分享点信息\n        if (tywx.publicwx) {\n            var msg = tywx.ShareInterface.getRandomOnShareAppMessageInfo();\n            if (msg) {\n                tywx.ShareInterface.setOnShareAppMessageInfo(msg.title, msg.imageUrl, msg.sharePointId, msg.shareSchemeId);\n                console.log(\"当前获得的分享信息 = \" + JSON.stringify(msg))\n            }\n            // 设置分享组件的回调和数据\n            var shareComponent = this.shareBtn.getComponent(\"ShareButton\");\n\n            if (shareComponent) {\n                shareComponent.setErrorCall(function (data) {\n                    console.log(\"分享失败后处理的回调函数 \", data);\n                })\n\n                shareComponent.setSuccessCall(function (data) {\n                    console.log(\"分享成功后处理的回调函数 \", data);\n                })\n\n                shareComponent.setShareConfig(tywx.ado.Constants.ShareConfig.FIRST_PAGE_SHARE);\n            }\n\n            // 设置群组排行榜组件的回调和数据\n            var groupBtnComponent = this.groupBtn.getComponent(\"ShareButton\");\n            var self = this;\n\n            if (groupBtnComponent) {\n                groupBtnComponent.setShareConfig(tywx.ado.Constants.ShareConfig.RANK_SHARE);\n                groupBtnComponent.setShareGroupCall(function (data) {\n                    console.log(\"群分享当前的文档\")\n                    if (self.showPhb) {\n                        self.phbView.active = false;\n                        self.showPhb = false;\n                    } else {\n                        self.phbView.active = true;\n                        self.showPhb = true;\n                        window.wx.postMessage({\n                            method: 2,\n                            MAIN_MENU_NUM: \"x1\",\n                            shareTicket: data.shareTickets[0]\n                        });\n                        // 开一个线程监听次时间段用户是否有点击\n                        self.phbNameLabel.string = \"群排行榜\";\n                        tywx.Timer.setTimer(self, function () {\n                            self._updateSubDomainCanvas();\n                        }, 2, 5, 0);\n                    }\n\n\n                })\n\n                groupBtnComponent.setErrorCall(function (data) {\n                    console.log(\"分享失败后处理的回调函数 \", data);\n                })\n\n            }\n\n        }\n        var score = tywx.Util.getItemFromLocalStorage(\"maxscore\", 0);\n        if (score != null) {\n            this.gameScore.string = score;\n            let length = (score + \"\").length;\n            // 根据当前的分数来调整显示\n            if (length < 2) {\n                this.historyLabel.node.x = this.historyLabel.node.x + 50;\n                this.gameScore.node.x = this.gameScore.node.x + 50;\n            } else if (length > 5) {\n                var tx = 25 + (length - 6) * 25;\n                this.historyLabel.node.x = this.historyLabel.node.x - tx;\n                this.gameScore.node.x = this.gameScore.node.x - tx;\n            }\n        } else {\n            console.log(\"当前分数不存在\")\n        }\n\n        // cc.loader.downloader.loadSubpackage(\"subone\",function(error){\n        //     if(error){\n        //         console.log(\"下载分包失败\");\n        //         return;\n        //     }\n        //     console.log(\"下载分包成功\");\n        // });\n\n\n        //  游戏的点击逻辑\n        this.phbback.node.on('touchstart', function (event) {\n            return true;\n        }, this);\n\n        var self = this;\n\n        curscene = this;\n\n        curscene.hideBack()\n        this.givePlayerItems();\n        this.firstShowHelpView();\n        // this.backButton.node.on(\"click\",this.returnView, this);\n        console.log(\"当前的项目配置 = \" + JSON.stringify(config))\n        this.requestConfigInfo();\n        // 开一个线程监听次时间段用户是否有点击\n\n        tywx.Timer.setTimer(self, function () {\n            self._updateSubDomainCanvas();\n        }, 1, 5, 0);\n\n    },\n\n    /*\n        调用: 点击游戏帮助的时候调用\n        功能: 展示游戏玩法\n        参数: [\n            无\n        ]\n        返回值:[\n            无\n        ]\n        思路: 游戏需要\n    */\n\n    showPlayMethod: function () {\n        if (this.helpviewpre != null) {\n            this.helpviewpre.destroy();\n            this.helpviewpre = null;\n        }\n        // 添加帮助\n        this.helpviewpre = cc.instantiate(this.helpViewPre);\n\n        this.helpview.active = !this.helpview.active ? true : false;\n        if (this.helpview.active == true) {\n            this.helpviewpre.parent = this.helpview;\n            this.helpviewpre.x = -360;\n            this.helpviewpre.y = 0;\n            this.helpviewscript = this.helpviewpre.getComponent(\"helpview\");\n            console.log(\"this.helpviewscript.setCloseCall\" + this.helpviewscript.setCloseCall);\n            this.helpviewscript.setCloseCall(function () {\n                curscene.showPlayMethod();\n            });\n            curscene.showBack()\n        } else {\n            curscene.hideBack()\n        }\n    },\n\n    /*\n        调用: 点击游戏帮助的时候调用\n        功能: 展示游戏玩法\n        参数: [\n            无\n        ]\n        返回值:[\n            无\n        ]\n        思路: 游戏需要\n    */\n\n    showGiftView: function () {\n        this.giftview.active = !this.giftview.active ? true : false;\n        if (this.giftview.active == true) {\n            curscene.showBack()\n        } else {\n            curscene.hideBack()\n        }\n    },\n\n    /*\n        调用: 点击排行榜的时候调用\n        功能: 展示玩家微信好友在游戏中的排名\n        参数: [\n            无\n        ]\n        返回值:[\n            无\n        ]\n        思路: 游戏需要\n    */\n    showFriendPhbView: function () {\n        console.log(\"Hellocd\")\n        var self = this;\n        if (this.showPhb) {\n            this.phbView.active = false;\n            curscene.hideBack()\n            this.showPhb = false;\n        } else {\n            curscene.showBack()\n            this.phbView.active = true;\n            this.showPhb = true;\n            if (tywx.publicwx) {\n                console.log(\"Hellocd\")\n                wx.postMessage({\n                    method: 1,\n                    MAIN_MENU_NUM: \"x1\",\n                });\n            }\n            // 开一个线程监听次时间段用户是否有点击\n            self.phbNameLabel.string = \"好友排行榜\";\n            tywx.Timer.setTimer(self, function () {\n                self._updateSubDomainCanvas();\n            }, 1, 5, 0);\n        }\n\n    },\n\n    /*\n        调用: 点击返回按钮\n        功能: 隐藏排行榜\n        参数: [\n            无\n        ]\n        返回值:[\n            无\n        ]\n        思路: 游戏需要\n    */\n    hidePhbView: function () {\n        console.log(\"çç.showPhb = \" + typeof (curscene.phbView))\n        if (curscene.showPhb) {\n            curscene.phbView.active = false;\n            curscene.showPhb = false;\n            curscene.hideBack()\n        } else {\n            curscene.phbView.active = true;\n            curscene.showBack()\n            curscene.showPhb = true;\n        }\n\n    },\n\n    /*\n        调用: 进入游戏的时候调用\n        功能: 清除当前界面占用的内存\n        参数: [\n            无\n        ]\n        返回值:[\n            无\n        ]\n        思路: 游戏需要\n    */\n    loadFinishCallBack: function () {\n        if (this.node) {\n            // this.node.destroy();\n        }\n    },\n\n    /*\n        调用: 进入小游戏的时候开始调用\n        功能: 显示玩家的最高得分\n        参数: [\n            score: 玩家当前的最高得分\n        ]\n        返回值:[\n            无\n        ]\n        思路: 游戏需要\n    */\n    setScore: function (score) {\n        if (score != null) {\n            this.gameScore.string = Math.abs(score);\n        }\n    },\n\n    /*\n        调用: 点击开始游戏的时候调用\n        功能: 进入游戏界面\n        参数: [\n            无\n        ]\n        返回值:[\n            无\n        ]\n        思路: 游戏需要\n    */\n    startGame: function () {\n        console.log(\"Hellocd\")\n        cc.director.loadScene(\"gamemain\"); //, this.loadFinishCallBack\n    },\n\n    /*\n\n    */\n    shareApp: function () {\n        if (tywx.IsWechatPlatform()) {\n            wx.shareAppMessage({\n                title: \"赶紧加入我们，一起愉快的玩耍吧...\",\n                imageUrl: \"https://gss0.bdstatic.com/7Ls0a8Sm1A5BphGlnYG/sys/portrait/item/d68bced2b5c4b7dcb6b73838383d02.jpg?20180808115403\",\n            });\n        }\n    },\n\n    /**\n     * 请求获取配置信息\n     */\n    requestConfigInfo: function () {\n        this.requestTimes--;\n        var _configUrl = tywx.SystemInfo.cdnPath + 'config/addone2.json';\n        var that = this;\n        console.log('请求的CDN地址 = ' + _configUrl);\n        var successcb = function (ret) {\n            that.requestTimes = 3;\n            var v = tywx.SystemInfo.version;\n            var uid = parseInt(tywx.UserInfo.userId);\n            var c, cb, d;\n            c = ret['v' + v];\n            cb = ret['' + v + '_ABTEST'];\n            d = ret;\n            var tconfig = config;\n            if (!d) {\n                //没找到缺省服务器配置...\n                console.log('No default server config, use local config...');\n                d = config;\n            }\n            config = d;\n\n            for (var k in tconfig) {\n                if (config[k] === undefined) {\n                    config[k] = tconfig[k];\n                }\n            }\n\n            config.move_time = 1;\n            config.partLJTime = 0.5;\n            tywx.ado.Configs = config;\n            tywx.config = tywx.ado.Configs;\n            console.log('请求后的数据 ' + JSON.stringify(tywx.config));\n        };\n\n        var failcb = function (ret) {\n            if (that.requestTimes > 0) {\n                that.requestConfigInfo();\n            } else {\n                config = config;\n            }\n        };\n\n        tywx.HttpUtil.httpGet({\n            'url': _configUrl\n        }, successcb, failcb);\n    },\n\n\n    showBack: function () {\n        this.phbback.node.active = true;\n        this.phbback.node.opacity = 165;\n    },\n\n    hideBack: function () {\n        this.phbback.node.active = false;\n        this.phbback.node.opacity = 0;\n    },\n\n    // 初始化的时候给玩家道具个三个\n    givePlayerItems: function () {\n        console.log(\"当前玩家的1 = \" + parseInt(tywx.Util.getItemFromLocalStorage(\"hadgiveitem\", 0)))\n        if (parseInt(tywx.Util.getItemFromLocalStorage(\"hadgiveitem\", 0)) === 0) {\n            console.log(\"当前玩家的2 = \" + parseInt(tywx.Util.getItemFromLocalStorage(\"hadgiveitem\", 0)))\n            tywx.Util.setItemToLocalStorage(\"hadgiveitem\", 1);\n            var giveitems = [];\n            for (var djIndex = 0; djIndex < tywx.ado.Constants.GameCenterConfig.allitem.length; djIndex++) {\n                var titem = {};\n                titem.id = tywx.ado.Constants.GameCenterConfig.allitem[djIndex].id;\n                titem.num = tywx.ado.Constants.GameCenterConfig.initGivePlayerItemNumber;\n                giveitems.push(titem);\n            }\n            tywx.Util.setItemToLocalStorage(\"allitems\", JSON.stringify(giveitems));\n        }\n    },\n\n    // 首次弹出帮助界面\n    firstShowHelpView: function () {\n        // if(parseInt(tywx.Util.getItemFromLocalStorage(\"hadshowhelpview\",0)) === 0){\n        //    tywx.Util.setItemToLocalStorage(\"hadshowhelpview\",1); \n        //    this.showPlayMethod();\n        // }\n    }\n\n\n});"]}