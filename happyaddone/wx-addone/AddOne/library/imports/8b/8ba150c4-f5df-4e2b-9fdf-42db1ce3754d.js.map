{"version":3,"sources":["../../../../assets/Script/assets/Script/gamestart.js"],"names":["config","require","tywx","publicwx","curscene","gamestart","cc","Class","extends","Component","properties","startButton","default","type","Button","backButton","audioCtr","Prefab","userItem","gameScore","Label","historyLabel","phb","phbback","Sprite","helpback","giftback","Node","method","phbSprite","shareBtn","groupBtn","phbView","helpview","giftview","helpViewPre","icon","requestTimes","_updateSubDomainCanvas","start","tex","Texture2D","showPhb","openDataContext","wx","getOpenDataContext","sharedCanvas","canvas","initWithElement","handleLoadedTexture","spriteFrame","SpriteFrame","delayTime","console","log","JSON","stringify","view","getDevicePixelRatio","getVisibleSize","PropagateInterface","getShareConfigInfo","msg","ShareInterface","getRandomOnShareAppMessageInfo","setOnShareAppMessageInfo","title","imageUrl","sharePointId","shareSchemeId","shareComponent","getComponent","setErrorCall","data","setSuccessCall","setShareConfig","ado","Constants","ShareConfig","FIRST_PAGE_SHARE","groupBtnComponent","self","RANK_SHARE","setShareGroupCall","active","window","postMessage","MAIN_MENU_NUM","shareTicket","shareTickets","score","Util","getItemFromLocalStorage","string","length","node","x","tx","on","event","hideBack","givePlayerItems","firstShowHelpView","requestConfigInfo","AudioManager","playMusic","Configs","MUSICS","BG_MUSIC","helpviewpre","destroy","instantiate","parent","y","helpviewscript","setCloseCall","showPlayMethod","showBack","Math","abs","director","loadScene","IsWechatPlatform","shareAppMessage","_configUrl","SystemInfo","cdnPath","that","successcb","ret","v","version","uid","parseInt","UserInfo","userId","c","cb","d","tconfig","CONFIG","k","undefined","failcb","HttpUtil","httpGet","opacity","setItemToLocalStorage","giveitems","djIndex","allitem","titem","id","num","initGivePlayerItemNumber","push"],"mappings":"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","file":"gamestart.js","sourceRoot":"../../../../assets/Script","sourcesContent":["/*\n   游戏开始界面\n   created by gyc on 2018-08-02.\n   final changed time by gyc on  2018-08-03\n*/\nvar config = require(\"AddOneConfig\")\ntywx.publicwx = true;\n\nvar curscene = null;\nvar gamestart = cc.Class({\n    extends: cc.Component,\n    properties:{\n        startButton:{\n            default:null,\n            type: cc.Button,\n        },\n        backButton:{\n            default:null,\n            type: cc.Button,\n        },\n        audioCtr:{\n            default:null,\n            type: cc.Prefab,\n        },\n        userItem:{\n            default:null,\n            type: cc.Prefab,\n        },\n        gameScore:{\n            default: null,\n            type: cc.Label,\n        },\n        historyLabel:{\n            default: null,\n            type: cc.Label,\n        },\n        phb:{\n            default: null,\n            type: cc.Button,\n        },\n        phbback:{\n            default: null,\n            type:cc.Sprite,\n        },\n        helpback:{\n            default: null,\n            type:cc.Sprite,\n        },\n        giftback:{\n            default: null,\n            type:cc.Node,\n        },\n        method:{\n            default: null,\n            type: cc.Button,\n        },\n        phbSprite:{\n            default: null,\n            type:cc.Sprite,\n        },\n        shareBtn:{\n            default: null,\n            type:cc.Node,\n        },\n        groupBtn:{\n            default: null,\n            type:cc.Node,\n        },\n        phbView:{\n            default: null,\n            type:cc.Node,\n        },\n\n        helpview:{\n            default: null,\n            type:cc.Node,\n        },\n\n        giftview:{\n            default: null,\n            type:cc.Node,\n        },\n\n        helpViewPre:{\n            default: null,\n            type:cc.Prefab,\n        },\n\n        icon:cc.Sprite,\n        //! 请求次数上线\n        requestTimes: 3,      \n    },\n    _updateSubDomainCanvas () {\n        // let self = this;\n        // if (!self.tex) {\n        //     return;\n        // }\n        // openDataContext.postMessage({\n        //     method:1,\n\n        // });\n         \n    },\n    start () {\n        //是否发布微信版本\n        if(tywx.publicwx){\n            this.tex = new cc.Texture2D();\n            // window.sharedCanvas.width = 635;\n            // window.sharedCanvas.height = 796;\n        }\n        this.showPhb = false;\n    },\n\n    // 刷新子域的纹理\n    _updateSubDomainCanvas: function() {\n        if (!this.tex) {\n            return;\n        }\n        var openDataContext = wx.getOpenDataContext();\n        var sharedCanvas = openDataContext.canvas;\n        this.tex.initWithElement(sharedCanvas);\n        this.tex.handleLoadedTexture();\n        this.phbSprite.spriteFrame = new cc.SpriteFrame(this.tex);\n    },\n    \n    /*\n        调用: 系统new 的时候调用。\n        功能: 该类的构造函数 可用于自身变量的初始化\n        参数: [\n            无\n        ]\n        返回值:[\n            无\n        ]\n        思路: 系统自带\n    */\n    ctor: function(){\n        \n    },\n    \n    update: function(delayTime){\n        if(tywx.publicwx){\n           this._updateSubDomainCanvas();   \n        }\n    },\n   \n\n\n    \n    /*\n        调用: 界面加载完成后的回调。\n        功能: 该类的构造函数 可用于自身变量的初始化\n        参数: [\n            无\n        ]\n        返回值:[\n            无\n        ]\n        思路: 系统自带\n    */\n    onLoad:function(){\n        \n        console.log(\"当前屏幕尺寸  \"+JSON.stringify(cc.view.getDevicePixelRatio())+JSON.stringify(cc.view.getVisibleSize()));\n        tywx.PropagateInterface.getShareConfigInfo();//! 获取所有分享点信息\n        if(tywx.publicwx){\n            var msg = tywx.ShareInterface.getRandomOnShareAppMessageInfo();\n            if(msg){\n                tywx.ShareInterface.setOnShareAppMessageInfo(msg.title, msg.imageUrl, msg.sharePointId, msg.shareSchemeId);\n                console.log(\"当前获得的分享信息 = \"+JSON.stringify(msg))\n            }\n            // 设置分享组件的回调和数据\n            var shareComponent = this.shareBtn.getComponent(\"ShareButton\");\n            \n            if(shareComponent){\n                shareComponent.setErrorCall(function(data){\n                    console.log(\"分享失败后处理的回调函数 \",data);\n                })\n\n                shareComponent.setSuccessCall(function(data){\n                     console.log(\"分享成功后处理的回调函数 \",data);\n                })\n\n                shareComponent.setShareConfig(tywx.ado.Constants.ShareConfig.FIRST_PAGE_SHARE);\n            }\n\n             // 设置群组排行榜组件的回调和数据\n             var groupBtnComponent = this.groupBtn.getComponent(\"ShareButton\");\n             var self = this;\n             \n             if(groupBtnComponent){\n                groupBtnComponent.setShareConfig(tywx.ado.Constants.ShareConfig.RANK_SHARE);\n                groupBtnComponent.setShareGroupCall(function(data){\n                    console.log(\"群分享当前的文档\")\n                     if(self.showPhb){\n                        self.phbView.active = false;\n                        self.showPhb = false;\n                    }else{\n                        self.phbView.active = true;\n                        self.showPhb = true;\n                    }\n                     window.wx.postMessage({\n                            method: 2,\n                            MAIN_MENU_NUM: \"x1\",\n                            shareTicket: data.shareTickets[0]\n                     });\n\n                 })\n\n                 groupBtnComponent.setErrorCall(function(data){\n                    console.log(\"分享失败后处理的回调函数 \",data);\n                })\n  \n             }\n\n       }\n       var score = tywx.Util.getItemFromLocalStorage(\"maxscore\",0); \n       if(score != null){\n            this.gameScore.string = score;\n            let length = (score+\"\").length;\n            // 根据当前的分数来调整显示\n            if(length < 2){\n               this.historyLabel.node.x = this.historyLabel.node.x + 50;\n               this.gameScore.node.x    = this.gameScore.node.x + 50;\n            }else if(length > 5){\n               var tx = 25 + (length - 6) * 25;\n               this.historyLabel.node.x = this.historyLabel.node.x - tx;\n               this.gameScore.node.x    = this.gameScore.node.x - tx;\n            }\n        }else{\n            console.log(\"当前分数不存在\")\n        }\n        \n        // cc.loader.downloader.loadSubpackage(\"subone\",function(error){\n        //     if(error){\n        //         console.log(\"下载分包失败\");\n        //         return;\n        //     }\n        //     console.log(\"下载分包成功\");\n        // });\n        \n        \n        //  游戏的点击逻辑\n        this.phbback.node.on('touchstart', function ( event ) {\n           return true;\n        }, this);\n        \n        var self = this;\n \n        curscene = this;\n\n        curscene.hideBack()\n        this.givePlayerItems();\n        this.firstShowHelpView();\n        // this.backButton.node.on(\"click\",this.returnView, this);\n        console.log(\"当前的项目配置 = \"+JSON.stringify(config))\n        this.requestConfigInfo();\n       \n        //tywx.playMusic();\n        tywx.ado.AudioManager.playMusic(tywx.ado.Configs.MUSICS.BG_MUSIC);\n        \n    },\n\n    /*\n        调用: 点击游戏帮助的时候调用\n        功能: 展示游戏玩法\n        参数: [\n            无\n        ]\n        返回值:[\n            无\n        ]\n        思路: 游戏需要\n    */\n\n     showPlayMethod:function(){\n         if(this.helpviewpre != null){\n            this.helpviewpre.destroy();\n            this.helpviewpre = null;\n         }\n          // 添加帮助\n         this.helpviewpre = cc.instantiate(this.helpViewPre);\n   \n         this.helpview.active = !this.helpview.active ? true : false;\n         if(this.helpview.active == true){\n            this.helpviewpre.parent = this.helpview;\n            this.helpviewpre.x = -360;\n            this.helpviewpre.y = 0;\n            this.helpviewscript = this.helpviewpre.getComponent(\"helpview\");\n            console.log(\"this.helpviewscript.setCloseCall\"+this.helpviewscript.setCloseCall);\n            this.helpviewscript.setCloseCall(function(){\n               curscene.showPlayMethod();\n            });\n            curscene.showBack()\n         }else{\n            curscene.hideBack()\n         }\n     },\n\n    /*\n        调用: 点击游戏帮助的时候调用\n        功能: 展示游戏玩法\n        参数: [\n            无\n        ]\n        返回值:[\n            无\n        ]\n        思路: 游戏需要\n    */\n\n    showGiftView:function(){\n        this.giftview.active = !this.giftview.active ? true : false;\n        if(this.giftview.active == true){\n            curscene.showBack()\n        }else{\n            curscene.hideBack()\n        }\n    },\n\n    /*\n        调用: 点击排行榜的时候调用\n        功能: 展示玩家微信好友在游戏中的排名\n        参数: [\n            无\n        ]\n        返回值:[\n            无\n        ]\n        思路: 游戏需要\n    */\n    showFriendPhbView: function(){\n        console.log(\"Hellocd\")\n        if(this.showPhb){\n            this.phbView.active = false;\n            curscene.hideBack()\n            this.showPhb = false;\n        }else{\n            curscene.showBack()\n            this.phbView.active = true;\n            this.showPhb = true;\n        }\n        if(tywx.publicwx){\n            console.log(\"Hellocd\")\n            wx.postMessage({\n                method: 1,\n                MAIN_MENU_NUM: \"x1\",\n            });\n        }\n    },\n\n    /*\n        调用: 点击返回按钮\n        功能: 隐藏排行榜\n        参数: [\n            无\n        ]\n        返回值:[\n            无\n        ]\n        思路: 游戏需要\n    */\n   hidePhbView: function(){\n        console.log(\"çç.showPhb = \"+typeof(curscene.phbView))\n        if(curscene.showPhb){\n            curscene.phbView.active = false;\n            curscene.showPhb = false;\n            curscene.hideBack()\n        }else{\n            curscene.phbView.active = true;\n            curscene.showBack()\n            curscene.showPhb = true;\n        }\n       \n   },\n\n    /*\n        调用: 进入游戏的时候调用\n        功能: 清除当前界面占用的内存\n        参数: [\n            无\n        ]\n        返回值:[\n            无\n        ]\n        思路: 游戏需要\n    */\n    loadFinishCallBack:function(){\n         if(this.node){\n            // this.node.destroy();\n         }\n    },\n   \n     /*\n        调用: 进入小游戏的时候开始调用\n        功能: 显示玩家的最高得分\n        参数: [\n            score: 玩家当前的最高得分\n        ]\n        返回值:[\n            无\n        ]\n        思路: 游戏需要\n    */\n    setScore:function(score){\n        if(score != null){\n           this.gameScore.string = Math.abs(score);\n        }\n    },\n\n    /*\n        调用: 点击开始游戏的时候调用\n        功能: 进入游戏界面\n        参数: [\n            无\n        ]\n        返回值:[\n            无\n        ]\n        思路: 游戏需要\n    */\n    startGame:function(){\n        console.log(\"Hellocd\")\n        cc.director.loadScene(\"gamemain\");//, this.loadFinishCallBack\n    },\n\n    /*\n\n    */\n    shareApp: function(){\n       if(tywx.IsWechatPlatform()){\n            wx.shareAppMessage({\n                title:\"赶紧加入我们，一起愉快的玩耍吧...\",\n                imageUrl:\"https://gss0.bdstatic.com/7Ls0a8Sm1A5BphGlnYG/sys/portrait/item/d68bced2b5c4b7dcb6b73838383d02.jpg?20180808115403\",\n            });\n       }\n    },\n\n      /**\n     * 请求获取配置信息\n     */\n    requestConfigInfo: function () {\n        this.requestTimes--;\n        var _configUrl = tywx.SystemInfo.cdnPath + 'config/addone.json';\n        var that = this;\n        console.log('请求的CDN地址 = '+_configUrl);\n        var successcb = function (ret) {\n            that.requestTimes = 3;\n            var v = tywx.SystemInfo.version;\n            var uid = parseInt(tywx.UserInfo.userId);\n            var c, cb, d;\n            c = ret['v'+v];\n            cb = ret[''+v+'_ABTEST'];\n            d = ret;\n            var tconfig = config;\n            if(!d) {\n                //没找到缺省服务器配置...\n                console.log('No default server config, use local config...');\n                d = config;\n            }\n            if(!c) {\n                //没找到版本对应配置，使用缺省配置...\n                config = d;\n            } else {\n                //AB测试...\n                if(cb) {\n                    if(uid % 2 == 0) {\n                        config = c;\n                    } else {\n                        config.CONFIG = cb;\n                    }\n                } else {\n                    config = c;\n                }\n                //把缺省配置中的配置项复制到当前配置...\n            }\n            // for(var k in d) {\n            //     if(config[k] === undefined){\n            //        config[k] = d[k];\n            //     }\n            // }\n     \n            for(var k in tconfig) {\n                if(config[k] === undefined){\n                   config[k] = tconfig[k];\n                }\n            }\n            \n            tywx.ado.Configs = config;\n            tywx.config = tywx.ado.Configs;\n             console.log('请求后的数据 '+JSON.stringify(tywx.config));\n        };\n\n        var failcb = function (ret) {\n            if (that.requestTimes > 0) {\n                that.requestConfigInfo();\n            } else {\n                config = config;\n            }\n        };\n        \n        tywx.HttpUtil.httpGet({ 'url': _configUrl }, successcb, failcb);\n    },\n    \n\n    showBack:function(){\n        this.phbback.node.active = true;\n        this.phbback.node.opacity = 165;\n    },\n\n    hideBack:function(){\n        this.phbback.node.active = false;\n        this.phbback.node.opacity = 0;\n    },\n\n    // 初始化的时候给玩家道具个三个\n    givePlayerItems:function(){\n         console.log(\"当前玩家的1 = \"+ parseInt(tywx.Util.getItemFromLocalStorage(\"hadgiveitem\",0)))\n         if(parseInt(tywx.Util.getItemFromLocalStorage(\"hadgiveitem\",0)) === 0){\n            console.log(\"当前玩家的2 = \"+ parseInt(tywx.Util.getItemFromLocalStorage(\"hadgiveitem\",0)))\n            tywx.Util.setItemToLocalStorage(\"hadgiveitem\",1); \n            var giveitems = [];\n            for(var djIndex = 0; djIndex < config.allitem.length; djIndex ++){\n                var titem = {};\n                titem.id = config.allitem[djIndex].id;\n                titem.num = config.initGivePlayerItemNumber;\n                giveitems.push(titem);\n            }\n            tywx.Util.setItemToLocalStorage(\"allitems\",JSON.stringify(giveitems));\n         }\n     },\n\n     // 首次弹出帮助界面\n     firstShowHelpView:function(){\n        // if(parseInt(tywx.Util.getItemFromLocalStorage(\"hadshowhelpview\",0)) === 0){\n        //    tywx.Util.setItemToLocalStorage(\"hadshowhelpview\",1); \n        //    this.showPlayMethod();\n        // }\n     }\n\n\n});"]}