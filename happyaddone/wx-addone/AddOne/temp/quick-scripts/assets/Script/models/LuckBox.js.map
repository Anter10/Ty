{"version":3,"sources":["LuckBox.js"],"names":["cc","Class","extends","Component","properties","luckboard","default","type","Node","luckitem","Prefab","luckitems","allframe","SpriteFrame","mflqBtn","close","getComponent","selected","tywx","ado","Utils","showWXBanner","node","active","lqCall","onLoad","allitem","Constants","GameCenterConfig","items","ti","length","item","instantiate","itemsceipt","setParent","setItem","selectitem","parent","push","row","column","bottom","padingleft","margin","width","self","mflq","config","auditing","setReactCall","setSuccessCall","gamecenter","lingQuItem","produceItem","setShareGroupCall","setShareConfig","ShareConfig","GIFT_GIFT_BOX_SHARE","hideOtherSelected","selectItem","itemindex","tdata","getData","id","unselected","data","produceitem","name","num"],"mappings":"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","file":"LuckBox.js","sourceRoot":"../../../../../assets/Script/models","sourcesContent":["// Learn cc.Class:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/class.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/class.html\n// Learn Attribute:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/life-cycle-callbacks.html\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        luckboard: {\n            default: null,\n            type: cc.Node,\n        },\n        luckitem: {\n            default: null,\n            type: cc.Prefab,\n        },\n        luckitems: {\n            default: [],\n            type: cc.Node,\n        },\n        allframe:{\n            default: [],\n            type: cc.SpriteFrame,\n        },\n        mflqBtn:{\n            default: null,\n            type: cc.Node,\n        }\n\n    },\n\n\n    close: function () {\n        this.luckitems[0].getComponent(\"luckitem\").selected();\n        tywx.ado.Utils.showWXBanner();\n        this.node.active = false;\n    },\n\n    lqCall: function () {\n          \n    },\n\n    onLoad() {\n\n        // 显示当前的所有道具\n        var allitem = tywx.ado.Constants.GameCenterConfig.allitem;\n        var items = [];\n        for (var ti = 0; ti < allitem.length; ti ++){\n            var item = cc.instantiate(this.luckitem);\n             let itemsceipt = item.getComponent(\"luckitem\");\n             itemsceipt.setParent(this);\n             itemsceipt.setItem(allitem[ti], this.allframe[ti]);\n             if (ti == 0) {\n                 this.selectitem = itemsceipt;\n             }\n            item.parent = this.luckitems[ti];\n            items.push(item);\n        }\n\n        this.luckitems = items;\n\n        var [row, column, bottom, padingleft, margin, width] = [0, 0, 120, 60, 80, 162];\n     \n        this.selectitem.selected();\n        \n        var self = this;\n         // 设置免费领取的回调\n         let mflq = this.mflqBtn.getComponent(\"ShareButton\");\n         if (tywx.config.auditing == true) {\n             mflq.setReactCall(true);\n         } else {\n             mflq.setReactCall(false);\n         }\n         mflq.setSuccessCall(function () {\n            tywx.gamecenter.lingQuItem(false,self.produceItem());\n            self.close();\n         });\n         mflq.setShareGroupCall(function () {\n            tywx.gamecenter.lingQuItem(false, self.produceItem());\n            self.close();\n         });\n         mflq.setShareConfig(tywx.ado.Constants.ShareConfig.GIFT_GIFT_BOX_SHARE);\n    },\n\n    hideOtherSelected: function(selectItem){\n        for (var itemindex = 0; itemindex < this.luckitems.length; itemindex++) {\n            var item = this.luckitems[itemindex];\n            let itemsceipt = item.getComponent(\"luckitem\");\n            var tdata = itemsceipt.getData();\n            // console.log(\"tdata = \"+JSON.stringify(tdata));\n            if(tdata != \"undefined\" && tdata.id != selectItem.getData().id){\n                itemsceipt.unselected();\n            }\n        }\n        this.selectitem = selectItem;\n    },\n    produceItem:function(){\n        var data = this.selectitem.getData();\n        var produceitem = {};\n        produceitem.id = data.id;\n        produceitem.name = data.name;\n        produceitem.num = 1;\n        return produceitem;\n    }\n\n});\n"]}