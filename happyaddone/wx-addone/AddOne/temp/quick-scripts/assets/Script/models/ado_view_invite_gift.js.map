{"version":3,"sources":["ado_view_invite_gift.js"],"names":["cc","Class","extends","Component","properties","onLoad","initRoot","director","getScene","_name","tywx","ado","Utils","hideGameClub","an","AdManager","getAdNodeByTag","hideAdNode","hideWXBanner","onDestroy","showGameClub","showAdNode","showWXBanner","start","root","commonScaleIn","btnInviteClick","console","log","shareConfig","Constants","ShareConfig","INVITE_FIREND_SHARE","msg","getRandomShareConfigByShareTag","DefaultShareConfig","ShareInterface","share","shareContent","sharePicUrl","sharePointId","shareSchemeId","res","JSON","stringify","data","motai","node","destroy","btnCloseClick","btnGetRewardClick","info","reward","showWXModal","requestInviteReward","init","InviteInfo","i","tmp_item_name","tmp_item","getChildByName","is_invited","invite_users","node_head","btn_invite","btn_invite2","node_nick_name","active","usr_info","sp_head","getComponent","Sprite","tmp_texture","Texture2D","setTimeout","window","sharedCanvas","width","height","wx","postMessage","method","openId","wxOpenId","openDataContext","getOpenDataContext","canvas","initWithElement","handleLoadedTexture","spriteFrame","SpriteFrame"],"mappings":"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","file":"ado_view_invite_gift.js","sourceRoot":"../../../../../assets/Script/models","sourcesContent":["\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad () {\n        this.initRoot();\n        if(cc.director.getScene()._name === 'gamestart'){\n            tywx.ado.Utils.hideGameClub();\n            let an = tywx.AdManager.getAdNodeByTag('GAME_START');\n            if(an) an.hideAdNode();\n        } else if (cc.director.getScene()._name === 'gamemain') {\n            tywx.ado.Utils.hideWXBanner();\n        }\n    },\n    onDestroy(){\n        if(cc.director.getScene()._name === 'gamestart'){\n            tywx.ado.Utils.showGameClub();\n            let an = tywx.AdManager.getAdNodeByTag('GAME_START');\n            if(an) an.showAdNode();\n            tywx.ado.Utils.hideWXBanner();\n        } else if (cc.director.getScene()._name === 'gamemain') {\n            tywx.ado.Utils.showWXBanner();\n        }\n    },\n\n    start () {\n        if(this.root){\n            tywx.ado.Utils.commonScaleIn(this.root);\n        }\n    },\n\n    //update (dt) {},\n    btnInviteClick(){\n        console.log('btnInviteClick');\n        let shareConfig = tywx.ado.Constants.ShareConfig.INVITE_FIREND_SHARE;\n        let msg = tywx.ado.Utils.getRandomShareConfigByShareTag(shareConfig[0]);\n        if(!msg){\n           msg = tywx.ado.Constants.DefaultShareConfig;\n        }\n        if(msg){\n            tywx.ShareInterface.share(\n                msg.shareContent,\n                msg.sharePicUrl,\n                msg.sharePointId,\n                msg.shareSchemeId,\n                (res) => {\n                    console.log(\"分享成功后的数据\"+JSON.stringify(res));\n                },\n                function(data){\n                    console.log(\"分享成功后的数2据\"+JSON.stringify(data));\n                }\n            );\n        }  \n    },\n    motai(){\n        this.node.destroy();\n    },\n    btnCloseClick(){\n        this.node.destroy();\n    },\n    btnGetRewardClick(){\n        console.log('btnGetRewardClick');\n        if(this.info.reward){\n            tywx.ado.Utils.showWXModal(\n                '已经领取过奖励',\n                '提示',\n                false);\n        }\n        else{\n            tywx.ado.Utils.requestInviteReward();\n        }\n    },\n    init(){\n        this.initRoot();\n        let info = tywx.ado.InviteInfo;\n        this.info = info;\n        for(let i = 0; i < 5; ++i){\n            let tmp_item_name = `node_invite_${i}`;\n            let tmp_item = this.root.getChildByName(tmp_item_name);\n            let is_invited = info.invite_users[i] ? true : false;\n            //is_invited = true;\n            if(tmp_item){\n                let node_head = tmp_item.getChildByName('head_icon');\n                let btn_invite = tmp_item.getChildByName('btn_invite');\n                let btn_invite2 = tmp_item.getChildByName('head_bg');\n                let node_nick_name = tmp_item.getChildByName('nick_name');\n                //let label_nick_name = node_nick_name.getComponent(cc.Label);\n                if(!is_invited){\n                    node_nick_name.active = false;\n                }\n                else{\n                    let usr_info = info.invite_users[i];\n                    let sp_head = node_head.getComponent(cc.Sprite);\n                    let tmp_texture = new cc.Texture2D();\n                    btn_invite.active = false;\n                    btn_invite2.active = false;\n                    setTimeout(()=>{\n                        window.sharedCanvas.width = 160;\n                        window.sharedCanvas.height = 200;\n                        wx.postMessage({\n                            method: 'render_invite_usr_info',\n                            openId: usr_info.wxOpenId\n                        });\n                    },i * 500);\n                    setTimeout(()=>{\n                        var openDataContext = wx.getOpenDataContext();\n                        var sharedCanvas = openDataContext.canvas;\n                        tmp_texture.initWithElement(sharedCanvas);\n                        tmp_texture.handleLoadedTexture();\n                        sp_head.spriteFrame = new cc.SpriteFrame(tmp_texture);\n                        console.log();\n                    },i * 500 + 400);\n                }\n            }\n        }\n    },\n    initRoot(){\n        if(!this.root) this.root = this.node.getChildByName('root');\n    },\n});\n"]}