{"version":3,"sources":["OpenRedPackView.js"],"names":["cc","Class","extends","Component","properties","redPackNumberLabel","default","type","Label","kaibottomNode","Node","bottomNode","background","Sprite","shareButtonNode","isOpening","close","notneedshow","tywx","ado","Utils","showWXBanner","node","destroy","onLoad","on","event","showUI","commonScaleIn","setData","data","console","log","JSON","stringify","string","formatCashFen2Yuan","nextAmount","initOpenLogic","open","self","param","success","gamecenter","flushMoneyNumber","flushRedPacketBtns","showRedPacketTransferPop","RedPacketInfo","fail","requestAddRedPacket","openRedPackBtn","getComponent","setSuccessCall","playRotate","needShare","setReactCall","setShareGroupCall","setShareConfig","Constants","ShareConfig","OPEN_RED_PACKET_SHARE","scale1","scaleTo","scale2","callFunc","active","scale3","scale4","runAction","sequence","tcall","seq"],"mappings":"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","file":"OpenRedPackView.js","sourceRoot":"../../../../../assets/Script/models","sourcesContent":[" cc.Class({\n     extends: cc.Component,\n\n     properties: {\n         redPackNumberLabel: {\n             default: null,\n             type: cc.Label,\n         },\n         kaibottomNode: {\n             default: null,\n             type: cc.Node,\n         },\n         bottomNode: {\n             default: null,\n             type: cc.Node,\n         },\n         background: {\n              default: null,\n              type: cc.Sprite,\n         },\n         shareButtonNode: {\n             default: null,\n             type: cc.Node,\n         },\n         isOpening: false,\n     },\n\n     /** \n      * @description \n      */\n     close: function (notneedshow) {\n        tywx.ado.Utils.showWXBanner();\n        this.node.destroy();\n     },\n\n     /**\n      * @description 加载完成后调用\n      */\n     onLoad() {\n            this.background.node.on('touchstart', function (event) {\n                return true;\n            });\n     },\n\n     /** \n      * @description 界面弹出的时候调用\n     */\n     showUI:function(){\n          tywx.ado.Utils.commonScaleIn(this.bottomNode);\n     },\n\n     /**\n      * @description 加载完成后调用\n      * @param {Number} moneyNum 红包金额\n      */\n     setData(data) {\n         this.data = data;\n         console.log(\"当前的设置数据 = \" + JSON.stringify(this.data));\n         this.redPackNumberLabel.string = tywx.ado.Utils.formatCashFen2Yuan(this.data.nextAmount) + \" 元\"\n         this.initOpenLogic();\n     },\n     \n     /**\n      * @description 点击开红包的时候调用\n      */\n     open:function(){\n         var self = this;\n         let param = {\n             success:function(){\n                  if (tywx.gamecenter && tywx.gamecenter.flushMoneyNumber) {\n                      tywx.gamecenter.flushMoneyNumber();\n                      tywx.gamecenter.flushRedPacketBtns(0);\n                  }\n                 //tywx.ado.Utils.showWXToast(\"领取红包成功\");\n                 self.close();\n                 tywx.ado.Utils.showRedPacketTransferPop(tywx.ado.Utils.formatCashFen2Yuan(tywx.ado.RedPacketInfo.nextAmount));\n             },\n             fail:function(){\n                //  self.close();\n             }\n         }\n         tywx.ado.Utils.requestAddRedPacket(param);\n     },\n\n     /** \n      * @description 初始化开红包逻辑\n      */\n     initOpenLogic: function () {\n         var self = this;\n         this.openRedPackBtn = this.shareButtonNode.getComponent(\"ShareButton\");\n         this.openRedPackBtn.setSuccessCall(function () {\n               self.playRotate();\n         });\n         if (this.data.needShare == false) {\n             this.openRedPackBtn.setReactCall(true);\n         } else {\n            //  if (tywx.config.auditing == true) {\n            //     this.openRedPackBtn.setReactCall(true);\n            //  } else {\n            //     this.openRedPackBtn.setReactCall(false);\n            //  }\n             this.openRedPackBtn.setShareGroupCall(function () {\n                 self.playRotate();\n             });\n             this.openRedPackBtn.setShareConfig(tywx.ado.Constants.ShareConfig.OPEN_RED_PACKET_SHARE);\n         }\n     },\n\n\n     /** \n      * @description 播放旋转动画\n      */\n     playRotate: function () {\n         if (this.isOpening) {\n             return;\n         }\n         this.isOpening = true;\n         var self = this;\n         let scale1 = cc.scaleTo(0.5, 0, 1);\n         let scale2 = cc.scaleTo(0.5, 1, 1);\n         var open = cc.callFunc(function () {\n             self.kaibottomNode.active = false;\n             self.redPackNumberLabel.node.active = true;\n             let scale3 = cc.scaleTo(0.2, 0.8);\n             let scale4 = cc.scaleTo(0.2, 1);\n             self.redPackNumberLabel.node.runAction(cc.sequence(scale3, scale4));\n             self.isOpening = false;\n         })\n         var tcall = cc.callFunc(function(){\n              self.open();\n         }) ;\n         var seq = cc.sequence(scale1, scale2, open, tcall);\n         this.kaibottomNode.runAction(seq);\n     },\n });"]}